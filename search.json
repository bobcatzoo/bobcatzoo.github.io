[{"categories":["Finance"],"content":"2008å¹´çš„1æ¬¡è€ƒè¯ç»å†ï¼Œç¬¬1æ¬¡çŸ¥é“äº†æœŸæƒå¹¶å­¦åˆ°äº†æœŸæƒå®šä»·çš„Black-Scholes-Mertonå…¬å¼ï¼Œè¢«å…¶æ·±æ·±è¿·ä½ï¼Œæ–­æ–­ç»­ç»­ç¿»é˜…äº†è®¸å¤šä¹¦ç±åŠæ–‡çŒ®èµ„æ–™ï¼ŒåŒ…æ‹¬Hullé‚£æœ¬åŠåŸºç¡€çš„æ•°å­¦åˆ†æã€å®åˆ†æåŠåŸºäºæµ‹åº¦è®ºçš„æ¦‚ç‡è®ºç­‰ç­‰ï¼Œä½†ç”±äºå¤§å­¦ä¸“ä¸šå’Œæ•°å­¦ä¸ç›¸å…³ï¼Œçœ‹èµ·æ¥å¾ˆåƒåŠ›ï¼Œè™½æœ‰æ”¶è·ä½†æ„Ÿè§‰å´ä¸â€‹Black-Scholes-Mertonå…¬å¼æ¸è¡Œæ¸è¿œï¼Œéœ€è¦è¡¥ä¹ çš„åŸºç¡€çŸ¥è¯†å¤ªå¤šã€‚ç›´åˆ°å·¥ä½œåäº2015å¹´å·¦å³å¼€å§‹è¯»ä¸–å›¾å½±å°å‡ºç‰ˆçš„Stochastic Calculus for Finance IIæ–¹æ‰æœ‰ç§é†é†çŒé¡¶çš„æ„Ÿè§‰ï¼Œä¼¼æ‡‚éæ‡‚ä¸­çœ‹åˆ°ç¬¬5ç« å¼€å¤´åå°±å› ç§ç§åŸå› æ”¾å¼ƒäº†ã€‚\næ—¶é—´ä¸€ç›´æ¥åˆ°äº†2021å¹´ï¼Œè¶COVID-19ç–«æƒ…æœŸé—´å·¥ä½œä¹‹ä½™ï¼Œä¸å¿˜åˆå¿ƒåˆé‡æ–°æ‹¾èµ·é‚£æ®µè®°å¿†ï¼Œä»å¤´å¼€å§‹åˆæ¥åˆ°äº†ç¬¬5ç« ï¼Œè¿‡å¾€çš„ç–‘æƒ‘åŠä¸è§£åœ¨æ­¤åˆ»æ­£é€æ­¥æ¶ˆæ•£ã€‚\nåœ¨æ­¤ç»“åˆStochastic Calculus for Finance IIå‰5ç« çš„å­¦ä¹ ï¼Œå¯¹é£é™©ä¸­æ€§æµ‹åº¦ä¸‹çš„Black-Scholes-Mertonç†è®ºæ¨å¯¼åšä¸ªæ€»ç»“ï¼Œå¹¶ç»“åˆC++å’ŒPythonå®ç°å…¶å®šä»·å…¬å¼ï¼Œä»¥ä¾¿å¯¹ç»™å®šçš„å‚æ•°ï¼Œè®¡ç®—å‡ºæœŸæƒä»·æ ¼ã€‚å¸Œæœ›è‹¥å¹²å¹´ä»¥åè¿˜èƒ½ä¸å¿˜åˆå¿ƒï¼Œç…§ç€ç¬”è®°é¡ºè—¤æ‘¸ç“œğŸ‰\n1. é£é™©ä¸­æ€§æµ‹åº¦ä¸‹çš„è‚¡ä»·è¿‡ç¨‹ 1.1 æ¦‚ç‡æµ‹åº¦$\\mathbb{P}$ä¸‹çš„è‚¡ä»·è¿‡ç¨‹ å‡è®¾ $W(t), 0 \\leq t \\leq T $æ˜¯æ¦‚ç‡ç©ºé—´$(\\Omega, \\mathcal{F}, \\mathbb{P})$ä¸Šçš„å¸ƒæœ—è¿åŠ¨ï¼Œ$\\mathcal{F}(t), 0\\leq t \\leq T$æ˜¯è¯¥å¸ƒæœ—è¿åŠ¨çš„åŸŸæµï¼Œè€ƒè™‘è‚¡ä»·$S(t)$ï¼Œå…¶å¾®åˆ†å¦‚ä¸‹ï¼š\n\\[ d S(t)=\\alpha(t) S(t) d t+\\sigma(t) S(t) d W(t), \\quad 0 \\leq t \\leq T. \\tag{1.1} \\]\nå…¶ä¸­å¹³å‡å›æŠ¥ç‡$\\alpha(t)$å’Œè‚¡ä»·æ³¢åŠ¨ç‡$\\sigma(t)$ä¸ºé€‚åº”æ€§è¿‡ç¨‹ï¼Œåˆ™$S(t)$æ»¡è¶³ä»¥ä¸‹ç­‰å¼ï¼š\n\\[ S(t)=S(0) \\exp \\left\\{\\int_{0}^{t} \\sigma(s) d W(s)+\\int_{0}^{t}\\left[\\alpha(s)-\\frac{1}{2} \\sigma^{2}(s)\\right] d s\\right\\} \\tag{1.2} \\]\nå‡è®¾æˆ‘ä»¬æœ‰é€‚åº”æ€§åˆ©ç‡è¿‡ç¨‹$R(t)$ï¼Œå®šä¹‰æŠ˜ç°è¿‡ç¨‹\n\\[ D(t)=e^{-\\int_{0}^{t} R(s) d s} \\tag{1.3} \\]\nåˆ™\n\\[ d D(t)=-R(t) D(t) d t \\tag{1.4} \\]\n$D(t)S(t)$åŠå…¶å¾®åˆ†$d (D(t)S(t))$åˆ†åˆ«ä¸ºï¼š\n\\[ D(t) S(t)=S(0) \\exp \\left\\{\\int_{0}^{t} \\sigma(s) d W(s)+\\int_{0}^{t}\\left[\\alpha(s)-R(s)-\\frac{1}{2} \\sigma^{2}(s)\\right] d s\\right\\} \\tag{1.5} \\]\n\\[ \\begin{aligned} d(D(t) S(t)) \u0026=[\\alpha(t)-R(t)] D(t) S(t) d t+\\sigma(t) D(t) S(t) d W(t) \\\\ \\\\ \u0026=\\sigma(t) D(t) S(t)[\\Theta(t) d t+d W(t)] \\end{aligned} \\tag{1.6} \\]\nå…¶ä¸­å®šä¹‰é£é™©çš„å¸‚åœºä»·æ ¼$\\Theta(t)=\\frac{\\alpha(t)-R(t)}{\\sigma(t)} $ã€‚\n1.2 Girsanov Theorem å‡è®¾$W(t), 0 \u003c t \u003c T$æ˜¯æ¦‚ç‡ç©ºé—´$(\\Omega, \\mathcal{F}, \\mathbb{P})$ä¸Šçš„å¸ƒæœ—è¿åŠ¨ï¼Œ$\\mathcal{F}(t)$ä¸ºè¯¥å¸ƒæœ—è¿åŠ¨çš„åŸŸæµï¼Œ$\\Theta(t), 0 \u003c t \u003c T$ä¸ºé€‚åº”æ€§è¿‡ç¨‹ã€‚æˆ‘ä»¬å®šä¹‰\n\\[ Z(t) =\\exp \\left\\{-\\int_{0}^{t} \\Theta(u) d W(u)-\\frac{1}{2} \\int_{0}^{t} \\Theta^{2}(u) d u\\right\\} \\tag{1.7} \\]\n\\[ \\widetilde{W}(t) =W(t)+\\int_{0}^{t} \\Theta(u) d u \\tag{1.8} \\]\nå¹¶å‡è®¾\n\\[ \\mathbb{E} \\int_{0}^{T} \\Theta^{2}(u) Z^{2}(u) d uè®©$Z = Z(T)$ã€‚é‚£ä¹ˆ$\\mathbb{E}Z = 1$ä¸”åœ¨ç”±\n\\[ \\widetilde{\\mathbb{P}}(A) = \\int_{A}Z(\\omega) d \\mathbb{P}(\\omega) \\quad \\text{å¯¹æ‰€æœ‰} A \\in \\mathcal{F}. \\tag{1.10} \\]\nå®šä¹‰çš„æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹ï¼Œ$\\widetilde{W}(t), 0 \u003c t \u003c T$æ˜¯å¸ƒæœ—è¿åŠ¨ã€‚$\\Box$\n1.3 æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹çš„è‚¡ä»·è¿‡ç¨‹ æ ¹æ®Girsanov Theoremï¼Œåœ¨æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹ï¼Œ$d \\widetilde W(t) = \\Theta(t) d t+d W(t) $ï¼Œå› æ­¤å…¬å¼$(1.6)$ä¹Ÿå¯ä»¥å†™ä¸º\n\\[ d (D(t)S(t)) = \\sigma(t) D(t) S(t) d \\widetilde W(t) \\tag{1.11} \\]\nä¸¤è¾¹åŒæ—¶ç§¯åˆ†\n\\[ D(t) S(t)=S(0)+\\int_{0}^{t} \\sigma(u) D(u) S(u) d \\widetilde{W}(u) \\tag{1.12} \\]\nç”±äºåœ¨æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹ï¼Œ$\\int_{0}^{t} \\sigma(u) D(u) S(u) d \\widetilde{W}(u)$æ˜¯ä¼Šè—¤è¿‡ç¨‹ï¼Œå› æ­¤æ˜¯ä¸€ä¸ªé…ã€‚\nå› æ­¤æˆ‘ä»¬ç§°Girsanov Theoremä¸‹çš„æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸ºé£é™©ä¸­æ€§æµ‹åº¦(risk-neutral measure)ã€‚\nå°†$d \\widetilde W(t) = \\Theta(t) d t+d W(t) $å¸¦å…¥å…¬å¼$(1.1)$ï¼Œå¯ä»¥å¾—åˆ°åœ¨æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹ï¼Œå…¬å¼$(1.1)$å’Œ$(1.2)$åˆ†åˆ«å¯ä»¥æ”¹å†™æˆå…¬å¼$(1.13)$å’Œå…¬å¼$(1.14)$çš„å½¢å¼\n\\[ d S(t)= R(t) S(t) d t+\\sigma(t) S(t) d \\widetilde {W}(t) \\tag{1.13} \\]\n\\[ S(t) = S(0) \\exp \\left\\{\\int_{0}^{t} \\sigma(s) d \\widetilde{W}(s)+\\int_{0}^{t}\\left[R(s)-\\frac{1}{2} \\sigma^{2}(s)\\right] d s\\right\\} \\tag{1.14} \\]\n2. é£é™©ä¸­æ€§æµ‹åº¦ä¸‹æŠ•èµ„ç»„åˆçš„ä»·å€¼è¿‡ç¨‹ å‡è®¾æŠ•èµ„è€…åˆå§‹èµ„æœ¬ä¸º$X(0)$ï¼Œåœ¨ä»»æ„æ—¶é—´$t, 0 \u003c t \u003c T $æŒæœ‰$\\Delta(t)$ä»½è‚¡ç¥¨ï¼ŒåŒæ—¶ä»¥åˆ©ç‡$R(t)$æŠ•èµ„æˆ–å€Ÿè´·äºè´§å¸å¸‚åœºï¼Œä»¥ç»´æŒè‡ªèèµ„çŠ¶æ€ï¼Œåˆ™æŠ•èµ„ç»„åˆä»·å€¼çš„å¾®åˆ†ä¸º\n\\[ \\begin{aligned} d X(t) \u0026=\\Delta(t) d S(t)+R(t) \\left[ X(t)-\\Delta(t) S(t) \\right] d t \\\\ \\\\ \u0026=\\Delta(t) [\\alpha(t) S(t) d t+\\sigma(t) S(t) d W(t)]+R(t)[X(t)-\\Delta(t) S(t)] d t \\\\ \\\\ \u0026=R(t) X(t) d t+\\Delta(t)[\\alpha(t)-R(t)] S(t) d t+\\Delta(t) \\sigma(t) S(t) d W(t) \\\\ \\\\ \u0026=R(t) X(t) d t+\\Delta(t) \\sigma(t) S(t)[\\Theta(t) d t+d W(t)] \\end{aligned} \\tag{2.1} \\]\næ ¹æ®$\\text{Ito}$ä¹˜æ³•æ³•åˆ™ï¼Œç”±å…¬å¼$(1.4)$å’Œ$(1.6)$å¯å¾—\n\\[ \\begin{aligned} d(D(t) X(t)) \u0026=\\Delta(t) \\sigma(t) D(t) S(t)[\\Theta(t) d t+d W(t)] \\\\ \\\\ \u0026=\\Delta(t) d(D(t) S(t)) \\\\ \\\\ \u0026=\\Delta(t) \\sigma(t) D(t) S(t) d \\widetilde W(t) \\end{aligned} \\tag{2.2} \\]\nç”±æ­¤æŠ•èµ„è€…æœ‰ä¸¤ç§é€‰æ‹©ï¼š\n ä»¥åˆ©ç‡$R(t)$æŠ•èµ„äºè´§å¸å¸‚åœºï¼›\n åœ¨é£é™©ä¸­æ€§æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹æŠ•èµ„äºå¹³å‡å›æŠ¥ç‡ä¸º$R(t)$çš„è‚¡ç¥¨ã€‚\n  ä½†ç”±äºåœ¨é£é™©ä¸­æ€§æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹ï¼ŒæŠ•èµ„ç»„åˆçš„æŠ˜ç°ä»·å€¼$D(t)X(t)$æ˜¯é…ï¼Œå› æ­¤ä¸ç®¡æŠ•èµ„è€…å¦‚ä½•é€‰æ‹©ï¼Œå…¶æŠ•èµ„ç»„åˆçš„å¹³å‡å›æŠ¥ç‡å‡ä¸ºä¸º$R(t)$ã€‚\n3. é£é™©ä¸­æ€§æµ‹åº¦ä¸‹çš„æœŸæƒå®šä»· æˆ‘ä»¬ä»¤$\\mathcal{F}(T)$å¯æµ‹çš„éšæœºå˜é‡$V(T)$è¡¨ç¤ºåœ¨æ—¶åˆ»$T$è¡ç”Ÿè¯åˆ¸ç©ºå¤´çš„æ½œåœ¨æ”¯ä»˜(payoff) $(S(T)-K)^+$ï¼ŒæŠ•èµ„è€…ä¸ºäº†å¯¹å†²çœ‹æ¶¨æœŸæƒç©ºå¤´å³æœªæ¥æ‰€é¢ä¸´çš„æ½œåœ¨æ”¯å‡º$V(T)$ï¼Œé‚£ä¹ˆå…¶æŒæœ‰çš„æŠ•èµ„ç»„åˆ$X(t)$éœ€è¦ä½¿ä»¥ä¸‹ç­‰å¼å‡ ä¹å¿…ç„¶æˆç«‹(almost surely)\n\\[ X(T) = V(T) \\tag{3.1} \\]\næˆ‘ä»¬å…ˆå‡è®¾å…¬å¼$(3.1)$æˆç«‹ï¼Œå¹¶ç”±æ­¤ç¡®å®šåˆå§‹èµ„æœ¬$X(0)$å’Œ$\\Delta t$è¿‡ç¨‹ã€‚ç”±$D(t)X(t)$åœ¨æµ‹åº¦$\\widetilde{\\mathbb{P}}$æ˜¯é…çš„äº‹å®æˆ‘ä»¬æœ‰\n\\[ D(t) X(t)=\\widetilde{\\mathbb{E}}[D(T) X(T) \\mid \\mathcal{F}(t)]=\\widetilde{\\mathbb{E}}[D(T) V(T) \\mid \\mathcal{F}(t)] \\tag{3.2} \\]\n$X(t)$è¡¨ç¤ºåœ¨æ—¶åˆ»$t$ä¸ºå®Œå…¨å¯¹å†²è¡ç”Ÿè¯åˆ¸æ”¯ä»˜$V(T)$æ‰€æŒæœ‰çš„æŠ•èµ„ç»„åˆä»·å€¼ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¹‹ä¸ºè¡ç”Ÿè¯åˆ¸åœ¨æ—¶åˆ» $t$ çš„ä»·æ ¼å¹¶ç”¨$V(t)$è¡¨ç¤ºï¼Œé‚£ä¹ˆå…¬å¼$(3.2)$å¯ä»¥å†™æˆ\n\\[ D(t) V(t)=\\widetilde{\\mathbb{E}}[D(T) V(T) \\mid \\mathcal{F}(t)], 0 \\leq t \\leq T \\tag{3.3} \\]\nç”±äº$D(t)$æ˜¯$\\mathcal{F}(t)$å¯æµ‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å…¶ç§»åˆ°å…¬å¼å³ä¾§ï¼Œå¾—åˆ°\n\\[ V(t)=\\widetilde{\\mathbb{E}}\\left[e^{-\\int_{t}^{T} R(u) d u} V(T) \\mid \\mathcal{F}(t)\\right], 0 \\leq t \\leq T \\tag{3.4} \\]\næˆ‘ä»¬å°†å…¬å¼$(3.3)$å’Œ$(3.4)$æˆä¸ºè¿ç»­æ—¶é—´ä¸‹é£é™©ä¸­æ€§å®šä»·å…¬å¼(risk-neutral pricing formula)ã€‚\n4. æ¨å¯¼$\\text{Black-Scholes-Merton}$å…¬å¼ ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾$\\sigma(t)$å’Œ$R(t)$åˆ†åˆ«ä¸ºå¸¸æ•° $\\sigma$ å’Œ $r$ï¼Œåˆ™å…¬å¼$(3.4)$ç®€åŒ–ä¸º\n\\[ \\widetilde{\\mathbb{E}}\\left[e^{-r(T-t)}(S(T)-K)^{+} \\mid \\mathcal{F}(t)\\right] \\tag{4.1} \\]\nå…¬å¼$(4.1)$ä»…ä¾èµ–äºæ—¶åˆ»$t$å’Œè‚¡ä»·$S(t)$ï¼Œç”±äºå‡ ä½•å¸ƒæœ—è¿åŠ¨æ˜¯é©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œå› æ­¤å­˜åœ¨$c(t, S(t))$æ»¡è¶³\n\\[ c(t, S(t)) = \\widetilde{\\mathbb{E}}\\left[e^{-r(T-t)}(S(T)-K)^{+} \\mid \\mathcal{F}(t)\\right] \\tag{4.2} \\]\nå…¬å¼$(1.10)$ç®€åŒ–ä¸º\n\\[ S(t) = S(0) \\exp \\left\\{\\sigma \\widetilde{W}(t)+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) t\\right\\} \\tag{4.3} \\]\nåˆ™$S(T)$ç­‰äº\n\\[ \\begin{aligned} S(T) \u0026=S(t) \\exp \\left\\{\\sigma(\\widetilde{W}(T)-\\widetilde{W}(t))+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\} \\\\ \\\\ \u0026=S(t) \\exp \\left\\{-\\sigma \\sqrt{\\tau} Y+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\} \\end{aligned} \\tag{4.4} \\]\nå…¶ä¸­$\\tau = T - t$ï¼Œ$Y$æ˜¯æ ‡å‡†æ­£æ€éšæœºå˜é‡\n\\[ Y = - \\frac{\\widetilde{W}(T) - \\widetilde{W}(t)} {\\sqrt{T-t}} \\tag{4.5} \\]\nå…¬å¼$(4.2)$å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼\n\\[ \\begin{aligned} c(t, x) \u0026= \\widetilde{\\mathbb{E}}\\left[e^{-r \\tau}\\left(x \\exp \\left\\{-\\sigma \\sqrt{\\tau} Y+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\}-K\\right)^{+}\\right] \\\\ \\\\ \u0026= \\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{\\infty} e^{-r \\tau}\\left[ x \\exp \\left\\{-\\sigma \\sqrt{\\tau} y+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\}-K\\right]^{+} e^{-\\frac{1}{2} y^{2}} d y \\end{aligned} \\tag{4.6} \\]\nå…¶ä¸­è¢«ç§¯å‡½æ•°\n\\[ \\left[ x \\exp \\left\\{-\\sigma \\sqrt{\\tau} y+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\}-K\\right]^{+} \\tag{4.7} \\]\nä¸ºæ­£ï¼Œå½“ä¸”ä»…å½“\n\\[ y ç”±æ­¤\n\\[ \\begin{aligned} c(t, x) \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{d_{-}(\\tau, x)} e^{-r \\tau}\\left(x \\exp \\left\\{-\\sigma \\sqrt{\\tau} y+\\left(r-\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right\\}-K\\right) e^{-\\frac{1}{2} y^{2}} d y \\\\ \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{d_{-}(\\tau, x)} x \\exp \\left\\{-\\frac{y^{2}}{2}-\\sigma \\sqrt{\\tau} y-\\frac{\\sigma^{2} \\tau}{2}\\right\\} d y \\\\ \\\\ \u0026- \\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{d_{-}(\\tau, x)} e^{-r \\tau} K e^{-\\frac{1}{2} y^{2}} d y \\\\ \\\\ \u0026=\\frac{x}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{d_{-}(\\tau, x)} \\exp \\left\\{-\\frac{1}{2}(y+\\sigma \\sqrt{\\tau})^{2}\\right\\} d y-e^{-r \\tau} K N\\left(d_{-}(\\tau, x)\\right) \\\\ \\\\ \u0026=\\frac{x}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{d_{-}(\\tau, x)+\\sigma \\sqrt{\\tau}} \\exp \\left\\{-\\frac{z^{2}}{2}\\right\\} d z-e^{-r \\tau} K N\\left(d_{-}(\\tau, x)\\right) \\\\ \\\\ \u0026=x N\\left(d_{+}(\\tau, x)\\right)-e^{-r \\tau} K N\\left(d_{-}(\\tau, x)\\right) \\end{aligned} \\tag{4.9} \\]\nå…¶ä¸­\n\\[ d_+(\\tau, x) = d_-(\\tau, x) + \\sigma \\sqrt{\\tau} = d_{-}(\\tau, x)=\\frac{1}{\\sigma \\sqrt{\\tau}}\\left[\\log \\frac{x}{K}+\\left(r+\\frac{1}{2} \\sigma^{2}\\right) \\tau\\right] \\tag{4.10} \\]\nç”±æ­¤æˆ‘ä»¬å¾—åˆ°äº†æ¬§å¼çœ‹æ¶¨æœŸæƒå®šä»·å…¬å¼\n\\[ \\text{BSM}(\\tau, x, K, r, \\sigma) = x N\\left(d_{+}(\\tau, x)\\right)-e^{-r \\tau} K N\\left(d_{-}(\\tau, x)\\right) \\tag{4.11} \\]\n5. æ¬§å¼æœŸæƒå®šä»·å…¬å¼ æ ¹æ®ä¸Šè¿°å¯¹$\\text{Black-Scholes-Merton}$æœŸæƒå®šä»·å…¬å¼çš„æ¨å¯¼ï¼Œå¯¹äºå½“å‰è‚¡ä»·ä¸º$S_0$ï¼Œè¡Œæƒä»·æ ¼ä¸º$K$ï¼Œè¡ŒæƒæœŸä¸º$T$ï¼Œæ— é£é™©åˆ©ç‡ä¸ºå¸¸æ•°$r$ï¼Œè‚¡ä»·æ³¢åŠ¨ç‡ä¸ºå¸¸æ•°$\\sigma$çš„çœ‹æ¶¨æœŸæƒï¼Œå…¶æœŸæƒè´¹$c(S_0, K, T, r, \\sigma)$ä¸ºï¼š\n\\[ c(S_0, K, T, r, \\sigma)=N\\left(d_{1}\\right) S_{0}-N\\left(d_{2}\\right) K \\exp (-r T) \\tag{5.1} \\]\nå…¶ä¸­\n\\[ d_{1} = \\frac{1}{\\sigma \\sqrt{T}}\\left(\\log \\left(\\frac{S_0}{K}\\right)+\\left(r+\\frac{\\sigma^{2}}{2}\\right) \\sqrt{T}\\right) \\tag{5.2} \\]\n\\[ d_{2} = \\frac{1}{\\sigma \\sqrt{T}}\\left(\\log \\left(\\frac{S_0}{K}\\right)+\\left(r-\\frac{\\sigma^{2}}{2}\\right) \\sqrt{T}\\right) \\tag{5.3} \\]\n$N(x)$ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼š\n\\[ N(x) = \\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{x} \\exp \\left(-\\frac{t^{2}}{2}\\right) d t \\tag{5.4} \\]\nå¯¹åº”çœ‹è·ŒæœŸæƒè´¹$p(S_0, K, T, r, \\sigma)$ä¸º:\n\\[ p(S_0, K, T, r, \\sigma)=N\\left(-d_{2}\\right) K \\exp (-r T)-N\\left(-d_{1}\\right) S_0 \\tag{5.5} \\]\n6. æœŸæƒå®šä»·çš„C++å®ç° 6.1 å®ç°$N(x)$å‡½æ•° - From Scratch to Boost Library å®šä»·å…¬å¼$(1)$-$(5)$ä¸­æ¶‰åŠ$N(x)$ã€$\\exp(x)$å’Œ$\\log(x)$ç­‰3ä¸ªå‡½æ•°ï¼Œå…¶ä¸­$\\exp(x)$å’Œ$\\log(x)$å·²åœ¨æ ‡å‡†åº“\u003ccmath\u003eä¸­å®ç°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å› æ­¤åªå‰©$N(x)$éœ€è¦æˆ‘ä»¬åœ¨æ ‡å‡†åº“å¤–è‡ªå·±å®ç°æˆ–å¯»æ±‚å…¶ä»–åº“çš„æ”¯æŒã€‚æˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹ä¸‰ç§æ–¹å¼åˆ†åˆ«è¿›è¡Œå®ç°ï¼š\n å¤šé¡¹å¼é€¼è¿‘æ³• æ•°å€¼ç§¯åˆ†æ³• è°ƒç”¨Booståº“  6.1.1 å¤šé¡¹å¼é€¼è¿‘æ³• å¦‚$x \u003e 0$ï¼Œå®šä¹‰$k = 1/(1 + 0.2316419x)$ï¼Œåˆ™$N(x)$å¯ç”¨å¦‚ä¸‹å…³äº$k$å¤šé¡¹å¼è¿›è¡Œé€¼è¿‘ \\( \\small 1 âˆ’ \\frac{1}{\\sqrt{2 \\pi}} \\exp(-\\frac{x^2} {2}) k(0.319381530 + k(âˆ’0.356563782 + k(1.781477937 + k(âˆ’1.821255978 + 1.330274429k)))) \\tag{6.1} \\)\nå€ŸåŠ©$N(x) + N(-x) = 1$å¯ä»¥æ±‚å¾—$N(-x)$å³$x \u003c 0$æ—¶$N(x)$çš„å€¼ã€‚\nC++å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  const double Pi = 3.141592653589793; const double root2Pi = sqrt(2.0 * Pi); double normcdf_poly(double x) { if (x \u003c 0) return 1 - normcdf_ploy(-x); double k = 1 / (1 + 0.2316419 * x); double poly = k * (0.319381530 + k * (-0.356563782 + k * (1.781477937 + k * (-1.821255978 + 1.330274429 * k)))); double approx = 1.0 - 1.0 / root2Pi * exp(-0.5 * x * x) * poly; return approx; }   6.1.2 æ•°å€¼ç§¯åˆ†æ³• å¯¹äºå®æ•°åŸŸä¸Š$\\mathbb R \\to \\mathbb R$çš„é»æ›¼ç§¯åˆ†\n\\[ F(b) - F(a) = \\int_{a}^{b} f(x) d x \\tag{6.2} \\]\nä»¤$\\Delta x = \\frac{(b-a)}{N}$ï¼Œæ ¹æ®é»æ›¼ç§¯åˆ†å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹çŸ©å½¢çš„é¢ç§¯å’Œé€¼è¿‘$\\int_{a}^{b} f(x) d x$ï¼š\n\\[ \\lim_{N \\to \\infty} \\sum_{i=0}^{N-1} f\\left(a+(i+\\frac{1}{2}) \\Delta x\\right) \\Delta x \\tag{6.3} \\]\nåªè¦$N$å–å€¼è¶³å¤Ÿå¤§å³å¯å¾ˆå¥½çš„é€¼è¿‘ç§¯åˆ†å€¼ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰$f(x) = x ^ 2 + 1$è¿›è¡Œç®€å•éªŒè¯ï¼ŒC++å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  #include \u003ciostream\u003e#include \u003ccmath\u003eusing namespace std; double f_x(double x) { return pow(x, 2) + 1; } double integrate_fx(double a, double b, int N) { double delta = (b - a) / N; double integrate = 0.0; int i = 0; while (i \u003c N) { double x = a + (i + 0.5) * delta; integrate += f_x(x) * delta; i++; } return integrate; } int main() { double a = 1; double b = 3; int N = 1000; double integrate_ = 0.0; integrate_ = integrate_fx(a, b, N); cout \u003c\u003c integrate_ \u003c\u003c endl; //è¿”å›10+2/3(çº¦ç­‰äº10.666667)  return 0; }   ä¸‹é¢æˆ‘ä»¬è€ƒè™‘å¦‚ä½•ç”¨æ•°å€¼ç§¯åˆ†æ³•é€¼è¿‘\n\\[ N(x)=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{x} \\exp \\left(-\\frac{t^{2}}{2}\\right) d t \\]\nç”±äºç§¯åˆ†ä¸‹é™ä¸º$- \\infty$ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘è¿›è¡Œå˜é‡æ›¿æ¢ï¼Œå®šä¹‰$t = x + 1 - \\frac{1} {s}$ï¼Œåˆ™$N(x)$ç­‰ä»·äºå¦‚ä¸‹ç§¯åˆ†ï¼š\n\\[ \\frac{1} {\\sqrt {2 \\pi}} \\int_{0}^{1} \\frac{1}{s^{2}} \\exp \\left(-\\frac{\\left(x+1-\\frac{1}{s}\\right)^{2}}{2}\\right) \\mathrm{d} s \\tag{6.4} \\]\nC++å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  double normcdf_integrate(double x) { int a = 0; int b = 1; double N = 1000; double delta = 1 / N; double integrate = 0.0; for (int i = 0; i \u003c N; i++) { double s = a + (i + 0.5) * delta; double t = x + 1 - pow(s, -1); double f = pow(2 * PI, -0.5) * pow(s, -2) * exp(-0.5 * t * t); integrate += f * delta; } return integrate; }   6.1.3 è°ƒç”¨booståº“ æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è°ƒç”¨booståº“ä¸­çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCumulative Distribution Functionï¼Œç®€ç§°$\\mathrm{cdf}$)çš„å®ç°\n1 2 3 4 5 6 7 8 9 10 11  #include \"boost\\math\\distributions\\normal.hpp\"#include \u003crandom\u003e double normcdf_boost(double x) { double cdf = 0.0; boost::math::normal_distribution\u003c\u003e norm(0, 1); //ç”Ÿæˆæ ‡å‡†æ­£æ€åˆ†å¸ƒ  cdf = boost::math::cdf(norm, x); //è®¡ç®—N(x)å€¼  return cdf; }   6.2 æœŸæƒè´¹è®¡ç®—çš„C++å®ç° å®ç°$N(x)$åï¼Œè®¡ç®—å…¬å¼$(1)$ä¸­æ¬§å¼çœ‹æ¶¨æœŸæƒ$c(S_0, K, T, r, \\sigma)$çš„éšœç¢å°±æ¸…é™¤äº†ã€‚ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å®šä¹‰blackScholesCallPriceå’ŒblackScholesPutPriceå‡½æ•°å®Œæˆè®¡ç®—$c(S_0, K, T, r, \\sigma)$å’Œ$p(S_0, K, T, r, \\sigma)$ã€‚\n1 2 3 4 5 6 7 8 9 10 11  double blackScholesCallPrice(double K, double T, double S_t, double vol, double r) { double d1 = pow((vol * sqrt(T)), -1) * (log(S_t / K) + (r + 0.5 * pow(vol, 2)) * sqrt(T)); double d2 = d1 - vol * sqrt(T); //ä»¥ä¸‹normcdf(x)å‡½æ•°3é€‰1ï¼Œé»˜è®¤é€‰normcdf_poly(x)ï¼Œä½¿ç”¨normcdf_boost(x)æ—¶è¯·è‡ªè¡Œé…ç½®booståº“  double callPrice = normcdf_poly(d1) * S_t - normcdf_poly(d2) * K * exp(-r * T); //double callPrice = normcdf_integrate(d1) * S_t - normcdf_integrate(d2) * K * exp(-r * T);  //double callPrice = normcdf_boost(d1) * S_t - normcdf_boost(d2) * K * exp(-r * T);  return callPrice; }  1 2 3 4 5 6 7 8 9 10 11  double blackScholesPutPrice(double K, double T, double S_t, double vol, double r) { double d1 = pow((vol * sqrt(T)), -1) * (log(S_t / K) + (r + 0.5 * vol * vol) * sqrt(T)); double d2 = d1 - vol * sqrt(T); //ä»¥ä¸‹normcdf(x)å‡½æ•°3é€‰1ï¼Œé»˜è®¤é€‰normcdf_poly(x)ï¼Œä½¿ç”¨normcdf_boost(x)æ—¶è¯·è‡ªè¡Œé…ç½®booståº“  double putPrice = normcdf_poly(-d2) * K * exp(-r * T) - normcdf_poly(-d1) * S_t; //double putPrice = normcdf_integrate(-d2) * K * exp(-r * T) - normcdf_integrate(-d1) * S_t;  //double putPrice = normcdf_boost(-d2) * K * exp(-r * T) - normcdf_boost(-d1) * S_t;  return putPrice; }   6.3 å®Œæ•´å·¥ç¨‹æ–‡ä»¶åŠæµ‹è¯• å¤´æ–‡ä»¶stdafx.h\n1 2 3 4 5 6  #pragma once #include \u003ciostream\u003e#include \u003ccmath\u003e//è¯·åœ¨Visual Studioä¸­è‡ªè¡Œé…ç½®å¥½booståº“åå–æ¶ˆæ³¨é‡Š //#include \"boost\\math\\distributions\\normal.hpp\" //#include \u003crandom\u003e    å¤´æ–‡ä»¶OptionPricing.h\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  #pragma once  static const double PI = 3.14159265358979; //å®šä¹‰Piå€¼  //S_t: spotPrice //T: maturity //K: strikePrice //vol: volatility //r: riskFreeInterestRate  //å£°æ˜çœ‹æ¶¨æœŸæƒå®šä»·å…¬å¼ double blackScholesCallPrice(double K, double T, double S_t, double vol, double r); //å£°æ˜çœ‹è·ŒæœŸæƒå®šä»·å…¬å¼ double blackScholesPutPrice(double K, double T, double S_t, double vol, double r);   æºæ–‡ä»¶OptionPricing.cpp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  #include \"OptionPricing.h\"#include \"stdafx.h\" static const double root2Pi = sqrt(2.0 * PI); static inline double normcdf_poly(double x) { if (x \u003c 0) return 1 - normcdf_poly(-x); double k = 1 / (1 + 0.2316419 * x); double poly = k * (0.319381530 + k * (-0.356563782 + k * (1.781477937 + k * (-1.821255978 + 1.330274429 * k)))); double approx = 1.0 - 1.0 / root2Pi * exp(-0.5 * x * x) * poly; return approx; } static inline double normcdf_integrate(double x) { int a = 0; int b = 1; double N = 1000; double delta = 1 / N; double integrate = 0.0; for (int i = 0; i \u003c N; i++) { double s = a + (i + 0.5) * delta; double t = x + 1 - pow(s, -1); double f = pow(2 * PI, -0.5) * pow(s, -2) * exp(-0.5 * t * t); integrate += f * delta; } return integrate; } //è¯·åœ¨Visual Studioä¸­è‡ªè¡Œé…ç½®å¥½booståº“åå–æ¶ˆæ³¨é‡Š /* static inline double normcdf_boost(double x) { double cdf = 0.0; boost::math::normal_distribution\u003c\u003e norm(0, 1); //ç”Ÿæˆæ ‡å‡†æ­£æ€åˆ†å¸ƒ cdf = boost::math::cdf(norm, x); //è®¡ç®—N(x)å€¼ return cdf; } */ //S_t: spotPrice //T: maturity //K: strikePrice //vol: volatility //r: riskFreeInterestRate  double blackScholesCallPrice(double K, double T, double S_t, double vol, double r) { double d1 = pow((vol * sqrt(T)), -1) * (log(S_t / K) + (r + 0.5 * pow(vol, 2)) * sqrt(T)); double d2 = d1 - vol * sqrt(T); //ä»¥ä¸‹normcdf(x)å‡½æ•°3é€‰1ï¼Œé»˜è®¤é€‰normcdf_poly(x)ï¼Œä½¿ç”¨normcdf_boost(x)æ—¶è¯·è‡ªè¡Œé…ç½®booståº“  double callPrice = normcdf_poly(d1) * S_t - normcdf_poly(d2) * K * exp(-r * T); //double callPrice = normcdf_integrate(d1) * S_t - normcdf_integrate(d2) * K * exp(-r * T);  //double callPrice = normcdf_boost(d1) * S_t - normcdf_boost(d2) * K * exp(-r * T);  return callPrice; } double blackScholesPutPrice(double K, double T, double S_t, double vol, double r) { double d1 = pow((vol * sqrt(T)), -1) * (log(S_t / K) + (r + 0.5 * vol * vol) * sqrt(T)); double d2 = d1 - vol * sqrt(T); //ä»¥ä¸‹normcdf(x)å‡½æ•°3é€‰1ï¼Œé»˜è®¤é€‰normcdf_poly(x)ï¼Œä½¿ç”¨normcdf_boost(x)æ—¶è¯·è‡ªè¡Œé…ç½®booståº“  double putPrice = normcdf_poly(-d2) * K * exp(-r * T) - normcdf_poly(-d1) * S_t; //double putPrice = normcdf_integrate(-d2) * K * exp(-r * T) - normcdf_integrate(-d1) * S_t;  //double putPrice = normcdf_boost(-d2) * K * exp(-r * T) - normcdf_boost(-d1) * S_t;  return putPrice; }   æµ‹è¯•æ–‡ä»¶main.cpp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  #include \u003ciostream\u003e#include \"OptionPricing.h\"using namespace std; int main() { double K = 100.0; double S_t = 110.0; double vol = 0.1; double r = 0.03; double T = 0.5; double call; double put; double putCallParity; call = blackScholesCallPrice(K, T, S_t, vol, r); cout \u003c\u003c \"The call option price is: \" \u003c\u003c call \u003c\u003c endl; //11.6725  put = blackScholesPutPrice(K, T, S_t, vol, r); cout \u003c\u003c \"The put option price is: \" \u003c\u003c put \u003c\u003c endl; //0.183688  cout \u003c\u003c endl; cout \u003c\u003c \"\u003cPut-Call-Parity = Call Price - Put Price\u003e Testing\" \u003c\u003c endl; cout \u003c\u003c \"\u003cCall Price - Put Price\u003e is: \" \u003c\u003c call - put \u003c\u003c endl; putCallParity = S_t - exp(-r * T) * K; cout \u003c\u003c \"\u003cPut-Call-Parity\u003e is: \" \u003c\u003c putCallParity \u003c\u003c endl; cout \u003c\u003c \"Wonderful! It's correct.\" \u003c\u003c endl; return 0; }   å…¶ä¸­çœ‹æ¶¨-çœ‹è·ŒæœŸæƒå¹³ä»·å…¬å¼ä¸º\n\\[ S_0 - \\exp(-rT)K = c(S_0, K, T, r, \\sigma) - p(S_0, K, T, r, \\sigma) \\tag{6.5} \\]\n7. æœŸæƒå®šä»·çš„Pythonå®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  import math import numpy as np from scipy.stats import norm //å®šä¹‰ä»¥ä¸‹ç®€å†™å˜é‡ //K: strikePrice //T: maturity //S_t: spotPrice //vol: volatility //r: riskFreeRate //å®šä¹‰d1å’Œd2 def d1f(K, T, S_t, vol, r) : return math.pow(vol * np.sqrt(T), -1) * \\ (np.log(S_t / K) + (r + 0.5 * math.pow(vol, 2) * np.sqrt(T))) def d2f(K, T, S_t, vol, r) : return d1f(K, T, S_t, vol, r) - vol * np.sqrt(T) //å®šä¹‰çœ‹æ¶¨-çœ‹è·ŒæœŸæƒè®¡ç®—å…¬å¼ def blackScholesCallPrice(K, T, S_t, vol, r) : d1 = d1f(K, T, S_t, vol, r) d2 = d2f(K, T, S_t, vol, r) callPrice = norm.cdf(d1) * S_t - norm.cdf(d2) * K * np.exp(-r * T) return callPrice def blackScholesPutPrice(K, T, S_t, vol, r) : d1 = d1f(K, T, S_t, vol, r) d2 = d2f(K, T, S_t, vol, r) putPrice = norm.cdf(-d2) * K * np.exp(-r * T) - norm.cdf(-d1) * S_t return putPrice //å®šä¹‰çœ‹æ¶¨-çœ‹è·ŒæœŸæƒå¹³ä»·æµ‹è¯•å…¬å¼ def callPutParity(K, T, S_t, r) : return S_t - np.exp(-r * T) * K //å¯¹ç»™å®šå˜é‡è¿›è¡Œæµ‹è¯• K = 100.0 S_t = 110.0 vol = 0.1 r = 0.03 T = 0.5 call = blackScholesCallPrice(K, T, S_t, vol, r) put = blackScholesPutPrice(K, T, S_t, vol, r) callPutParity_ = callPutParity(K, T, S_t, r) print(\"The call option price is: {0}\".format(call)) print(\"The put option price is: {0}\".format(put)) print(\"Call price - put price is: {0}\".format(call - put)) print(\"The Call-Put-Parity is: {0}\".format(callPutParity_))   è‡´è°¢ï¼š\nå¦ˆå’ªå”LaTeXåŠ©åŠ› åœ¨çº¿LaTeX\nå‚è€ƒ:\nStochastic Calculus for Finance II - Continuous-Time Models\nC++ for Financial Mathematics\n","description":"","tags":["é‡‘èæ•°å­¦"],"title":"Black-Scholes-Merton Model","uri":"/posts/black-scholes-model/"},{"categories":["Finance"],"content":"æœ¬æ–‡ä¸»è¦å¯¹é‡‘èéšæœºåˆ†æç¬¬2å†Œç¬¬1å¼ ç¬¬6èŠ‚æµ‹åº¦å˜æ¢è¿›è¡Œæ€»ç»“ï¼Œå­¦ä¹ LaTeXæ•°å­¦å…¬å¼çš„ç”¨æ³•ï¼ŒåŒæ—¶å€ŸåŠ©Plotlyï¼Œç»ƒä¹ å›¾åƒç»˜åˆ¶ï¼Œä¾¿äºæ›´ç›´è§‚ç†è§£è¿ç»­æ¦‚ç‡åˆ†å¸ƒä¸‹çš„æµ‹åº¦å˜æ¢æœ¬è´¨ã€‚\n1 Introduction 1.1 Chapter 1 section 6 assert the following conclusions: We pick up the thread of Section 3.1 of Volume I, in which we used a positive random variable $Z$ to change probability measures on a space $\\Omega$. We need to do this when we change from the actual probability measure $\\mathbb{P}$ to the risk-neutral probability measure $\\widetilde{\\mathbb{P}}$ in models of financial markets. When $\\Omega$ is uncountably infinite and $\\mathbb{P}(\\omega) = \\widetilde{\\mathbb{P}}(\\omega) = 0$ for every $\\omega \\subseteq \\Omega$, it no longer makes sense to write (3.1.1) of Chapter 3 of Volume I,\n\\[ Z(\\omega)=\\frac{\\widetilde{\\mathbb{P}}(\\omega)}{\\mathbb{P}(\\omega)} \\tag{1.6.1} \\]\nbecause division by zero is undefined. We could rewrite this equation as\n\\[ Z(\\omega) \\mathbb{P}(\\omega) = \\widetilde{\\mathbb{P}}(\\omega) \\tag{1.6.2} \\]\nand now we have a meaningful equation, with both sides equal to zero, but the equation tells us nothing about the relationship among $\\mathbb{P}$, $\\widetilde{\\mathbb{P}}$, and $Z$. Because $\\mathbb{P}(\\omega) = \\widetilde{\\mathbb{P}}(\\omega) = 0$, the value os $Z(\\omega)$ could be anything and (1.6.2) would still hold.\nHowever, (1.6.2) does capture the spirit of what we would like to accomplish. To change from $\\mathbb{P}$ to $\\widetilde{\\mathbb{P}}$, we need to reassign probabilities in $\\Omega$ using $Z$ to tell us where in $\\Omega$ we should revise the probability upward (where $Z \u003e 1$) and where we should revise the probability downward (where $Z \u003c 1$). However, we should do this set-by-set, rather than $\\omega$-by-$\\omega$. The process is described by the following theorem.\nTheorem 1.6.1. Let $(\\Omega, \\mathcal{F}, \\mathbb{P})$ be a probability space and let $Z$ be an almost surely nonnegative random variable with $\\mathbb{E}Z = 1$. For $ A \\subseteq \\mathcal{F}$, define\n\\[ \\widetilde{\\mathbb{P}}(A)=\\int_{A} Z(\\omega) d \\mathbb{P}(\\omega) \\tag{1.6.3} \\]\nThen $\\widetilde{\\mathbb{P}}$ is a probability measure. Furthermore, if $X$ is a nonnegative random variable, then\n\\[ \\widetilde{\\mathbb{E}} X=\\mathbb{E}[X Z] \\tag{1.6.4} \\]\nIf $Z$ is almost surely strictly positive, we also have\n\\[ \\mathbb{E} Y=\\widetilde{\\mathbb{E}}\\left[\\frac{Y}{Z}\\right] \\tag{1.6.5} \\]\nfor every nonnegative random variable $Y$.\nThe $\\widetilde{\\mathbb{E}}$ appearing in (1.6.4) is expectation under the probability measure $\\widetilde{\\mathbb{P}}$ (i.e., $\\widetilde{\\mathbb{E}}X = \\int_{\\Omega} X(\\omega) d \\mathbb{P}(\\omega)$).\nDefinition 1.6.3. Let $\\Omega$ be a nonemyty set and $\\mathcal{F}$ a a-algebra of subsets of $\\Omega$. Two probability measures $\\mathbb{P}$ and $\\widetilde{\\mathbb{P}}$ on $(\\Omega, \\mathcal{F})$ are said to be equivalent if they agree which sets in $\\Omega$ have probability zero.\nDefinition 1.6.5 Let $(\\Omega, \\mathcal{F}, \\mathbb{P})$ be a probability space, let $\\widetilde{\\mathbb{P}}$ be another probability measure on $(\\Omega, \\mathcal{F})$ that is equivalent to $\\mathbb{P}$, and let $Z$ be an almost surely positive random variable that relates $\\mathbb{P}$ and $\\widetilde{\\mathbb{P}}$ via {1.6.3}. Then $Z$ is called the Radon-Nikodym derivative of $\\widetilde{\\mathbb{P}}$ with respect to $\\mathbb{P}$, and we write\n\\[ Z=\\frac{d \\widetilde{\\mathbb{P}}}{d \\mathbb{P}} \\notag \\]\nTheorem 1.6.7 (Radon-Nikodym). Let $\\mathbb{P}$ and $\\widetilde{\\mathbb{P}}$ be equivalent probability measures defined on $(\\Omega, \\mathcal{F})$. Then there exists an almost surely positive random variable $Z$ such that $\\mathbb{E}Z = 1$ and\n\\[ \\widetilde{\\mathbb{P}}(A)=\\int_{A} Z(\\omega) d \\mathbb{P}(\\omega) \\text { for every } A \\in \\mathcal{F} \\notag \\]\n1.2 æ­£æ€åˆ†å¸ƒç®€ä»‹ æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯å‡å€¼ä¸º$\\mu$ æ–¹å·®ä¸º$\\sigma ^{2}$(æˆ–æ ‡å‡†å·®$\\sigma$)æ˜¯é«˜æ–¯å‡½æ•°çš„ä¸€ä¸ªå®ä¾‹ï¼š\n\\[ f(x ; \\mu, \\sigma)=\\frac{1}{\\sigma \\sqrt{2 \\pi}} \\exp \\left(-\\frac{(x-\\mu)^{2}}{2 \\sigma^{2}}\\right) \\notag \\]\nç´¯ç§¯åˆ†å¸ƒå‡½æ•°æ˜¯æŒ‡éšæœºå˜é‡$X$å°äºæˆ–ç­‰äº$x$çš„æ¦‚ç‡ï¼Œç”¨æ¦‚ç‡å¯†åº¦å‡½æ•°è¡¨ç¤ºä¸º\n\\[ F(x ; \\mu, \\sigma)=\\frac{1}{\\sigma \\sqrt{2 \\pi}} \\int_{-\\infty}^{x} \\exp \\left(-\\frac{(t-\\mu)^{2}}{2 \\sigma^{2}}\\right) d t \\notag \\]\nå¦‚æœä¸€ä¸ªéšæœºå˜é‡$X$æœä»è¿™ä¸ªåˆ†å¸ƒï¼Œæˆ‘ä»¬å†™ä½œ$X \\sim N(\\mu ,\\sigma ^{2})$. å¦‚æœ$\\mu = 0$å¹¶ä¸”$\\sigma = 1$ï¼Œè¿™ä¸ªåˆ†å¸ƒè¢«ç§°ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè¿™ä¸ªåˆ†å¸ƒèƒ½å¤Ÿç®€åŒ–ä¸º\n\\[ f(x)=\\frac{1}{\\sqrt{2 \\pi}} \\exp \\left(-\\frac{x^{2}}{2}\\right) \\notag \\]\n\\[ F(x)=\\int_{-\\infty}^{x} f(t) d t = \\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{x} \\exp \\left(-\\frac{t^{2}}{2}\\right) d t \\notag \\]\n1.3 æ­£æ€éšæœºå˜é‡çš„æµ‹åº¦å˜æ¢ ä»¤$X$ä¸ºæ ‡å‡†æ­£æ€éšæœºå˜é‡,å³\n\\[ \\mu_{X}(B)=\\mathbb{P}\\{X \\in B\\}=\\int_{B} \\varphi(x) d x \\text { for every Borel subset } B \\text { of } \\mathbb{R} \\tag{1.6.7} \\]\nå…¶ä¸­æ¦‚ç‡å¯†åº¦å‡½æ•°(Probability Density Function)å¦‚ä¸‹\n\\[ \\varphi(x)=\\frac{1}{\\sqrt{2 \\pi}} e^{-\\frac{x^{2}}{2}} \\notag \\]\næˆ‘ä»¬å–$B = \\left(-\\infty, b \\right]$, åˆ™å¾—åˆ°å¦‚ä¸‹ç†Ÿæ‚‰çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(Cumulative Distribution Function)\n\\[ \\mathbb{P}\\{X \\leq b\\}=\\int_{-\\infty}^{b} \\varphi(x) d x \\text { for every } b \\in \\mathbb{R} \\tag{1.6.8} \\]\nåŒæ—¶å®šä¹‰å¦‚ä¸‹éšæœºå˜é‡$Z(\\omega)$\n\\[ Z(\\omega)=\\exp \\left\\{-\\theta X(\\omega)-\\frac{1}{2} \\theta^{2}\\right\\} \\text { for all } \\omega \\in \\Omega \\notag \\]\næˆ‘ä»¬æœ‰\n\\[ \\begin{aligned} \\mathbb{E} Z \u0026=\\int_{-\\infty}^{\\infty} \\exp \\left\\{-\\theta x-\\frac{1}{2} \\theta^{2}\\right\\} \\varphi(x) d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{\\infty} \\exp \\left\\{-\\frac{1}{2}\\left(x^{2}+2 \\theta x+\\theta^{2}\\right)\\right\\} d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{\\infty} \\exp \\left\\{-\\frac{1}{2}(x+\\theta)^{2}\\right\\} d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{\\infty} \\exp \\left\\{-\\frac{1}{2} y^{2}\\right\\} d y \\end{aligned} \\notag \\]\nåŠ\n\\[ \\begin{aligned} \\widetilde{\\mathbb{P}}\\{Y \\leq b\\} \u0026=\\int_{\\{\\omega ; Y(\\omega) \\leq b\\}} Z(\\omega) d \\mathbb{P}(\\omega) \\\\ \u0026=\\int_{\\Omega} \\mathbb{I}_{\\{Y(\\omega) \\leq b\\}} Z(\\omega) d \\mathbb{P}(\\omega) \\\\ \u0026=\\int_{\\Omega} \\mathbb{I}_{\\{X(\\omega) \\leq b-\\theta\\}} \\exp \\left\\{-\\theta X(\\omega)-\\frac{1}{2} \\theta^{2}\\right\\} d \\mathbb{P}(\\omega) \\\\ \u0026=\\int_{-\\infty}^{\\infty} \\mathbb{I}_{\\{x \\leq b-\\theta\\}} e^{-\\theta x-\\frac{1}{2} \\theta^{2}} \\varphi(x) d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{b-\\theta} e^{-\\theta x-\\frac{1}{2} \\theta^{2}} e^{-\\frac{x^{2}}{2}} d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{b-\\theta} e^{-\\frac{1}{2}(x+\\theta)^{2}} d x \\\\ \u0026=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{b} e^{-\\frac{1}{2} y^{2}} d y \\end{aligned} \\notag \\]\nå³\n\\[ \\mathbb{E} Z =\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{\\infty} \\exp \\left\\{-\\frac{1}{2} y^{2}\\right\\} d y = 1 \\notag \\]\næ»¡è¶³Radon-Nikodymå®šç†(1.6.7)ä¸”\n\\[ \\widetilde{\\mathbb{P}}\\{Y \\leq b\\}=\\frac{1}{\\sqrt{2 \\pi}} \\int_{-\\infty}^{b} e^{-\\frac{1}{2} y^{2}} d y \\notag \\]\nå› æ­¤éšæœºå˜é‡$Y$åœ¨æ¦‚ç‡æµ‹åº¦$\\widetilde{\\mathbb{P}}$ä¸‹æ˜¯æ ‡å‡†æ­£æ€éšæœºå˜é‡ã€‚\n2 In Python's Perspective 2.1 å‡†å¤‡å·¥ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13  import numpy as np import pandas as pd from scipy import stats import cufflinks as cf from plotly.offline import iplot, init_notebook_mode # set up configuration (run it once) cf.set_config_file(world_readable=True, theme='pearl',offline=True) init_notebook_mode() from plotly.subplots import make_subplots # ç”»å›¾å·¥å…· import plotly.graph_objects as go   è¦ç”¨åˆ°çš„å‡½æ•°è¯´æ˜ï¼š\n$\\text{è¿”å›} X \\sim N (\\mu, \\sigma) \\text{çš„æ¦‚ç‡å¯†åº¦å‡½æ•°}$(pdf) $f(x, \\mu, \\sigma)$\n1  stats.norm.pdf(x, mu, sigma)   $\\text{è¿”å›} X \\sim N (\\mu, \\sigma) \\text{çš„æ¦‚ç‡åˆ†å¸ƒå‡½æ•°}$(cdf) $F(x, \\mu, \\sigma)$\n1  stats.norm.cdf(x, mu, sigma)   $\\text{è¿”å›} X \\sim N (\\mu, \\sigma) \\text{ç½®ä¿¡åº¦ä¸º}\\alpha\\text{çš„ä¸Šåˆ†ä½æ•°} Z(\\alpha , \\mu, \\sigma)$\n1  stats.norm.isf(alpha, mu, sigma)   åˆ›å»ºæ ‡å‡†æ­£æ€åˆ†å¸ƒåŠå…¶pdfå’Œcdf\n1 2 3 4 5 6 7 8  dx = 0.001 mu = 0 sigma = 1 sigma_N = 3 * sigma x = np.arange(-sigma_N, sigma_N, dx) # ç”±äºæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å€¼åœ¨3ÏƒåŸŸå¤–å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå› æ­¤é€‰å®šå®šä¹‰åŸŸä¸º[-3Ïƒ, 3Ïƒ) y_pdf = stats.norm.pdf(x, 0, 1) # æ ‡å‡†æ­£æ€åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°(Probability Density Function) y_cdf = stats.norm.cdf(x, 0, 1) # æ ‡å‡†æ­£æ€åˆ†å¸ƒç´¯ç§¯åˆ†å¸ƒå‡½æ•°(Cumulative Distribution Function)   2.2 ç»˜åˆ¶æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„pdfå’Œcdfå›¾åƒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  fig = make_subplots(rows=1, cols=2, shared_yaxes=True, horizontal_spacing=0.1) fig.add_trace(go.Scatter(x=x, y=y_pdf, name='pdf'), row=1, col=1) # éLaTeXæ˜¾ç¤ºå›¾ä¾‹ ä¸å»ºè®®ä½¿ç”¨LaTeXæ˜¾ç¤ºå›¾ä¾‹ï¼Œå¦åˆ™å¦‚æœå›¾ä¾‹è¾ƒé•¿çš„è¯ï¼Œå®¹æ˜“ä¸å›¾åƒé‡å ï¼Œé€ æˆå›¾åƒä¸ç¾è§‚ï¼Œå°¤å…¶æ˜¯ä¸‹é¢è®¾ç½®åŒYè½´æ—¶ fig.add_trace(go.Scatter(x=x, y=y_cdf, name=r'$\\text{cdf}$'), row=1, col=2) # LaTeXæ˜¾ç¤ºå›¾ä¾‹ fig.update_xaxes(title_text=r'$\\text{The values of }x$', row=1, col=1) fig.update_xaxes(title_text=r'$\\text{The values of }x$', row=1, col=2) fig.update_yaxes(title_text=r'$\\text{The values of pdf}$', row=1, col=1) fig.update_yaxes(title_text=r'$\\text{The values of cdf}$', row=1, col=2) fig.update_layout(height=500, width=800, title_text=r\"$\\text{Normal Distribution } X \\sim N(0, 1)$\", title_x=0.5) # æ˜¾ç¤ºLaTeXæ ‡é¢˜ fig.show()   \nå°†å›¾åƒç»˜åˆ¶åœ¨ä¸€å¼ å›¾ä¸Š\n1 2 3 4 5 6 7 8 9  fig = go.Figure() fig.add_trace(go.Scatter(x=x, y=y_pdf, mode='lines', name='pdf')) fig.add_trace(go.Scatter(x=x, y=y_cdf, mode='lines', name='cdf')) fig.update_layout(height=500, width=800, title_text=r\"$\\text{Normal Distribution } X \\sim N(0, 1)$\", title_x=0.5, xaxis_title = r'$\\text{The values of x}$', yaxis_title = r'$\\text{The values of pdf and cdf}$') fig.show()   \n2.3 å¯è§†åŒ–å°†æ¦‚ç‡æµ‹åº¦$\\mathbb{P}$å˜æ¢æˆ$\\widetilde{\\mathbb{P}}$ çš„$Z(\\omega)$ \\[ d \\widetilde{\\mathbb{P}} = Z(x) {d \\mathbb{P}} = Z(x) \\varphi(x) d x = Z(x) \\frac{1}{\\sqrt{2 \\pi}} e^{-\\frac{x^{2}}{2}} d x \\]\n\\[ Z(\\omega)=\\exp \\left\\{-\\theta X(\\omega)-\\frac{1}{2} \\theta^{2}\\right\\} \\text { for all } \\omega \\in \\Omega \\]\nç”Ÿæˆ$\\theta = 1 \\text{çš„} Z (\\omega)$\n1 2  theta = 1 Z_omega = np.exp(-theta * x - 0.5 * theta ** 2)   ç»˜åˆ¶$Z (\\omega)$å›¾åƒ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  # Initialize figure with subplots fig = go.Figure() # Add traces fig.add_trace(go.Scatter(x=x, y=Z_omega, mode='lines', name='Z_omega')) fig.add_hline(y=1, name = 'Z_omega = 1', line_color = \"red\", line_dash=\"dot\", line_width=2, annotation_text=\"Baseline Z = 1\", annotation_position=\"bottom right\") #æ·»åŠ æ°´å¹³çº¿Z_omega = 1ï¼Œç”¨äºç›´è§‚åˆ¤æ–­Zå¯¹åŸå§‹æ¦‚ç‡å¢å¤§å’Œå‡å°çš„åˆ†ç•Œç‚¹ fig.add_vline(x=-0.5, line_width=2, line_dash=\"dash\", line_color=\"green\") #æ·»åŠ å‚ç›´çº¿x = -0.5ï¼Œå³Zå¯¹åŸå§‹æ¦‚ç‡æ”¹å˜çš„åˆ†ç•Œç‚¹ä¸ºx=-0.5 #fig.add_trace(go.Scatter(x=x, y=base, mode='lines', name='Baseline Z = 1')) # Update xaxis properties fig.update_xaxes(title_text=r'$\\text{The values of }x$') # Update yaxis properties fig.update_yaxes(title_text=r'$\\text{The values of }Z(\\omega)$') # Update layout info fig.layout.xaxis.automargin: True fig.update_layout(height=500, width=800, showlegend=True, title_text=r\"$Z(\\omega)=\\exp \\left\\{-\\theta X(\\omega)-\\frac{1}{2}\\theta^{2}\\right\\}$\", title_x=0.5) fig.show()   \nç”Ÿæˆç»è¿‡$Z (\\omega)$å˜æ¢åçš„æ–°æ¦‚ç‡åˆ†å¸ƒ\n1 2  Z_x_pdf = stats.norm.pdf(x, -1, 1) Z_x_cdf = stats.norm.cdf(x, -1, 1)   ç»˜åˆ¶å˜æ¢å‰åçš„æ¦‚ç‡åˆ†å¸ƒå›¾è±¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  # Create figure with secondary y-axis fig = make_subplots(specs=[[{\"secondary_y\": True}]]) fig.add_trace(go.Scatter(x=x, y=y_pdf, mode='lines', name='pdf of normal distribution'), secondary_y=False) fig.add_trace(go.Scatter(x=x, y=Z_x_pdf, mode='lines', name='pdf of Z_x'), secondary_y=False) fig.add_trace(go.Scatter(x=x, y=y_cdf, mode='lines', name='cdf of normal distribution'), secondary_y=False) fig.add_trace(go.Scatter(x=x, y=Z_x_cdf, mode='lines', name='cdf of Z_x'), secondary_y=False) fig.add_trace(go.Scatter(x=x, y=Z_omega, mode='lines', name=\"The values of Z\"), secondary_y=True) fig.add_hline(y=1, name = 'Z_omega = 1', line_color = \"red\", line_dash=\"dot\", line_width=2, secondary_y=True) # annotation_text=\"Baseline Z = 1\"æ— æ³•åœ¨secondary y-axisæ˜¾ç¤º # annotation_position=\"bottom right\"æ— æ³•åœ¨secondary y-axisæ˜¾ç¤º fig.add_vline(x=-0.5, line_width=2, line_dash=\"dash\", line_color=\"green\") fig.update_xaxes(title_text = r'$\\text{The values of }x$') fig.update_yaxes(title_text = r'$\\text{The values of pdf and cdf}$', secondary_y=False) fig.update_yaxes(title_text = r'$\\text{The values of }Z$', secondary_y=True) fig.update_layout(height=500, width=800, title_text=r\"$\\text{Normal Distribution and Change of Measure } Z(\\omega) $\", title_x=0.4) fig.show()   \n2.4 æ­£æ€åˆ†å¸ƒä¸æŸ¯è¥¿åˆ†å¸ƒçš„æµ‹åº¦å˜æ¢ æŸ¯è¥¿åˆ†å¸ƒä¹Ÿå«ä½œæŸ¯è¥¿-æ´›ä¼¦å…¹åˆ†å¸ƒï¼Œå®ƒæ˜¯ä»¥å¥¥å¤æ–¯ä¸Â·è·¯æ˜“Â·æŸ¯è¥¿ä¸äº¨å¾·é‡Œå…‹Â·æ´›ä¼¦å…¹åå­—å‘½åçš„è¿ç»­æ¦‚ç‡åˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º\n\\[ \\begin{array}{l} c\\left(x ; x_{0}, \\gamma\\right)=\\frac{1}{\\pi \\gamma\\left[1+\\left(\\frac{x-x_{0}}{\\gamma}\\right)^{2}\\right]} \\\\ =\\frac{1}{\\pi}\\left[\\frac{\\gamma}{\\left(x-x_{0}\\right)^{2}+\\gamma^{2}}\\right] \\end{array} \\]\nå…¶ä¸­$x_0$æ˜¯å®šä¹‰åˆ†å¸ƒå³°å€¼ä½ç½®çš„ä½ç½®å‚æ•°ï¼Œ$\\gamma$æ˜¯æœ€å¤§å€¼ä¸€åŠå¤„çš„ä¸€åŠå®½åº¦çš„å°ºåº¦å‚æ•°ã€‚\n$x_0 = 0$ä¸”$Î³ = 1$çš„ç‰¹ä¾‹ç§°ä¸ºæ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º\n\\[ c(x ; 0,1)=\\frac{1}{\\pi\\left(1+x^{2}\\right)} \\]\nå›é¡¾ä»¥ä¸‹æ­£æ€åˆ†å¸ƒ$X$ ~ $N(\\mu ,\\sigma ^{2})$æ¦‚ç‡å¯†åº¦å‡½æ•°\n\\[ f(x ; \\mu, \\sigma)=\\frac{1}{\\sigma \\sqrt{2 \\pi}} \\exp \\left(-\\frac{(x-\\mu)^{2}}{2 \\sigma^{2}}\\right) \\]\nå¦‚æœ$\\mu = 0$å¹¶ä¸”$\\sigma = 1$ï¼Œåˆ™è¿™ä¸ªåˆ†å¸ƒç®€åŒ–ä¸º\n\\[ f(x)=\\frac{1}{\\sqrt{2 \\pi}} \\exp \\left(-\\frac{x^{2}}{2}\\right) \\]\nä»¤\n\\[ Z(x) = {\\sqrt{2 \\pi}} \\exp \\left(\\frac{x^{2}}{2}\\right) \\frac{1}{\\pi\\left(1+x^{2}\\right)} \\]\nåˆ™\n\\[ c(x ; 0,1)= Z(x) \\ast f(x) \\]\nåˆ›å»ºæ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒ\n1 2 3 4 5 6  x_0 = 0 gamma = 1 cauchy_pdf = stats.cauchy.pdf(x, loc=0, scale=1) cauchy_cdf = stats.cauchy.cdf(x, loc=0, scale=1) cn_zx = 1 / y_pdf * cauchy_pdf   ç»˜åˆ¶æ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒpdfå’Œcdf\n1 2 3 4 5 6 7 8 9 10 11  fig = go.Figure() fig.add_trace(go.Scatter(x=x, y=cauchy_pdf, mode='lines', name='pdf of Cauchy distribution')) fig.add_trace(go.Scatter(x=x, y=cauchy_cdf, mode='lines', name='cdf of Cauchy distribution')) fig.update_layout(height=500, width=800, title_text=r\"$\\text{pdf and cdf of Standard Cauchy distribution}$\", title_x=0.4, xaxis_title = r'$\\text{The values of }x$', yaxis_title = r'$\\text{The values of pdf and cdf}$') fig.show()   \nè®¡ç®—$Z (\\omega) = 1$çš„ä¸´ç•Œç‚¹\n1 2 3  critical = max(np.where(cn_zx\u003c1.00001)).max() # æ³¨æ„Z(Ï‰)ä¸ºå¯¹ç§°å‡½æ•°ï¼Œæ±‚å¾—ä¸€ä¾§ä¸´ç•Œç‚¹å³å¯åæ¨å¦ä¸€ä¾§ä¸´ç•Œç‚¹ left = -sigma_N + (len(x)-critical)*dx # Z \u003e 1çš„å·¦è¾¹ç•Œ right = -sigma_N + critical*dx # Z \u003e 1çš„å³è¾¹ç•Œ   ç»˜åˆ¶æ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å˜æ¢å›¾åƒpdf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  # Initialize figure with subplots fig = make_subplots(rows=2, cols=1, shared_xaxes=True, vertical_spacing = 0.05) # Add traces fig.add_trace(go.Scatter(x=x, y=cn_zx, mode='lines', name='The values of cn_zx'), row=1, col=1) fig.add_hline(y=1, name = 'Z_omega = 1', line_color = \"red\", line_dash=\"dot\", line_width=2) fig.add_vrect(x0=left, x1=right, row=\"all\", col=1, annotation_text=r\"$\\text{The interval where }Z\\text{ downward probability}$\", annotation_position=\"top left\", fillcolor=\"green\", opacity=0.25, line_width=0) fig.add_trace(go.Scatter(x=x, y=y_pdf, mode='lines', name='pdf of Normal'), row=2, col=1) fig.add_trace(go.Scatter(x=x, y=cauchy_pdf, mode='lines', name='pdf of Cauchy'), row=2, col=1) fig.add_trace(go.Scatter(x=x, y=cauchy_pdf-y_pdf, mode='lines', name='pdf of Cauchy - Normal'), row=2, col=1) # Update xaxis properties fig.update_xaxes(title_text='The values of x', row=2, col=1) # Update yaxis properties fig.update_yaxes(title_text='The values of cn_zx', row=1, col=1) fig.update_yaxes(title_text='The values of pdf', row=2, col=1) # Update layout info fig.update_layout(height=600, width=800, title_text=r\"$\\text{Normal Distribution and Change of Measure } Z(\\omega) $\", title_x=0.45) fig.show()   \nå°†å›¾åƒç»˜åˆ¶åœ¨ä¸€å¼ å›¾ä¸Š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  # Create figure with secondary y-axis fig = make_subplots(specs=[[{\"secondary_y\": True}]]) fig.add_trace(go.Scatter(x=x, y=y_pdf, mode='lines', name='pdf of Normal')) fig.add_trace(go.Scatter(x=x, y=cauchy_pdf, mode='lines', name='pdf of Cauchy')) fig.add_trace(go.Scatter(x=x, y=cauchy_pdf-y_pdf, mode='lines', name='pdf of Cauchy - Normal')) fig.add_trace(go.Scatter(x=x, y=cn_zx, mode='lines', name='The Values of cn_zx'), secondary_y=True) fig.add_hline(y=1, name = 'Z_omega = 1', line_color = \"red\", line_dash=\"dot\", line_width=2, secondary_y=True) # annotation_text=\"Baseline Z = 1\"æ— æ³•åœ¨secondary y-axisæ˜¾ç¤º # annotation_position=\"bottom right\"æ— æ³•åœ¨secondary y-axisæ˜¾ç¤º fig.add_vrect(x0=left, x1=right, row=\"all\", col=1, annotation_text=r\"$\\text{The interval where }Z\\text{ downward probability}$\", annotation_position=\"top left\", fillcolor=\"green\", opacity=0.25, line_width=0) fig.update_xaxes(title_text = r'$\\text{The values of }x$') fig.update_yaxes(title_text = r'$\\text{The values of pdf and cdf}$', secondary_y=False) fig.update_yaxes(title_text = r'$\\text{The values of }Z$', secondary_y=True) fig.update_layout(height=500, width=800, title_text=r\"$\\text{Normal Distribution and Change of Measure } Z(\\omega) $\", title_x=0.4) fig.show()   \nç»˜åˆ¶æ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å˜æ¢å›¾åƒcdf\n1 2 3 4 5 6 7 8 9 10 11  fig = go.Figure() fig.add_trace(go.Scatter(x=x, y=y_cdf, mode='lines', name='cdf of Normal')) fig.add_trace(go.Scatter(x=x, y=cauchy_cdf, mode='lines', name='cdf of Cauchy')) fig.add_trace(go.Scatter(x=x, y=y_cdf - cauchy_cdf, mode='lines', name='cdf of Normal - Cauchy')) fig.update_layout(height=500, width=800, title_text=\"cdf of Cauchy and Normal distribution\", title_x=0.5, xaxis_title = 'The values of x', yaxis_title = 'The values of cdf') fig.show()   \n3 æ€»ç»“ å¯¹å…·æœ‰æ¦‚ç‡å¯†åº¦å‡½æ•°å’Œæ¦‚ç‡åˆ†å¸ƒå‡½æ•°çš„è¿ç»­å˜é‡æ¥è¯´ï¼Œæµ‹åº¦å˜æ¢ç±»ä¼¼äºæ¢å…ƒç§¯åˆ†æ³•ã€‚\nå¼•ç”¨Referenceï¼š\n é‡‘èéšæœºåˆ†æ\n Stochastic Calculus for Finance Vol.2\n ç»´åŸºç™¾ç§‘\n  è‡´è°¢Credit to:\n å¦ˆå’ªå”åœ¨çº¿LaTeX\n Plotly\n  ","description":"","tags":["é‡‘èæ•°å­¦"],"title":"é‡‘èéšæœºåˆ†æç¬¬2å†Œ1.6æµ‹åº¦å˜æ¢ç¬”è®°","uri":"/posts/notes-and-visualization-of-scff/"}]
