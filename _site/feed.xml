<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Alex Blog</title>
    <description>初等数学，概率论，随机微积分，金融，历史，财务</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Sun, 08 Oct 2023 21:43:33 +0545</pubDate>
    <lastBuildDate>Sun, 08 Oct 2023 21:43:33 +0545</lastBuildDate>
    <generator>Jekyll v4.3.2</generator>
    
      <item>
        <title>地藏菩萨本愿经白话解释（一）</title>
        <description>&lt;h2 id=&quot;地藏菩萨本愿经白话解释&quot;&gt;&lt;strong&gt;地藏菩萨本愿经白话解释&lt;/strong&gt;&lt;/h2&gt;

&lt;p&gt;宅梵胡维铨演述&lt;/p&gt;

&lt;p&gt;嘉兴范古农居士校正&lt;/p&gt;

&lt;p&gt;贤首院&lt;strong&gt;弘一法师&lt;/strong&gt;鉴定&lt;/p&gt;

&lt;h3 id=&quot;白话解释序&quot;&gt;白话解释序&lt;/h3&gt;

&lt;p&gt;弘一法师&lt;/p&gt;

&lt;p&gt;己巳九月，余来峙山，居金仙寺。翌日，宅梵居士遇谈，赍彼所作五言古诗一卷。余谓其能媲美陶王，求诸当世未之有也。是岁十月，天台静权法师莅寺，讲地藏菩萨本愿经义。余以本愿章疏，惟有科注一部。渊文奥理，未契初机。乃劝宅梵撰白话解，而为钤键。逮于明年，全编成就。乞求禾中古农长者以剟正之。尔将付刊，请书序言。为述昔日斯事因缘，以示后之学者。&lt;/p&gt;

&lt;p&gt;于时后二十二年岁次癸酉二月
贤首院沙门胜臂&lt;/p&gt;

&lt;p&gt;校刊序&lt;/p&gt;

&lt;p&gt;古农&lt;/p&gt;

&lt;p&gt;释迦世尊，化道将圆，为报母恩，特往忉利说法。以是因缘，更召地藏大士，以未来众生殷勤付嘱，令其化度。良以一切众生是菩萨过去父母，世尊是已成佛之菩萨，地藏是未成佛之菩萨，同以慈悲心、孝顺心，愿令究竟度脱。而今我等亦在化度之列，奈以刚强难化之故，屡劳世尊地藏设诸方便，委曲指导，犹复旋出旋入，依然具缚凡夫，辜负宏恩，罪戾安逭。我读地藏大士本愿经而未尝不感激涕零，惭悚无地也。胡宅梵居士亦曾以是经为功课，熟读深思。欲以世尊地藏之心，掬示众生，令诸众生深解此经义趣，得以共沐宏恩。爰依弘一法师之请，为之白话解释，更以其稿寄示，嘱为校阅。复函述意趣三点：一者，欲使阅者对于经文意义得充分之明了，故不惮重复演说；二者，以警恶劝善，离苦得乐为原则；三者，用开导方法，务使阅者起信。当时思想集中于此三点，其他未及顾虑，解释混淆，或未能免，云云。农展读一过，欢喜赞叹，得未曾有。对于经题品题之解文有未妥处，辄易己意，其余但在字句间稍稍斟酌，未敢有损胡居士之意趣也。校阅既毕，将遵付上海佛学书局刊行，因弁数语以叙因缘。世之读此书而能深解义趣，则必能发忏悔心、供养心，而为诸神圣之所拥护。其于我佛大士化度之宏恩，必获同沾于无尽矣。其庶不负胡居士之一片苦心也夫。&lt;/p&gt;

&lt;p&gt;民国二十二年孟春之月范古农序于嘉兴月河之幻庐&lt;/p&gt;

&lt;h3 id=&quot;白话解自序&quot;&gt;白话解自序&lt;/h3&gt;

&lt;p&gt;这可是我的幸运么！在一个木叶黄落的残秋，与我素所恋慕的弘一大师相见在白洋湖滨金仙寺。大师是不大肯接见人的，经了亦幻上人的介绍，才得和他认识。初见他的时候，见他持戒的严律，和清臞的慈容，不禁油然兴敬之，复惜之之感。回首一想，他所以甘心行著这样的苦行，不是为的想早成佛果，普济众生吗？这样一想，自恨当时未能立刻就跪在他的跟前忏悔、赞叹、礼拜。从此以后，我曾去看他好几次。有一次，我去见他，他拿了一本弥陀经白话解赠给我。我不觉惊讶的说：啊！弥陀经白话解已经有了吗？他说：这是王涵之居士著的。很精湛。我也时常要看的。我又说：这，我本来也想要替他做白话解的，现在竟给王居士先做了，那到也好！他听我如此说，便道：这样吧！你要做就把一部地藏菩萨本愿经去解释罢！我说：恐怕很深奥的。他说：不要紧。你照字义去解释就是了，也不必用什么新文艺体裁。是预备给工商界人看的，用最浅近通俗的白话去解释吧！也不要多，越简单越好。一时我就很欢喜的答应下来，就依著大师所指示的目标开始工作了。&lt;/p&gt;

&lt;p&gt;我因为对于佛学从未研究过，所以于未著手做这部白话解以前，自不能不经过一番很辛苦的研阅和探讨。取材与参考书是科注和演孝疏二种，自庚午十月至辛未正月上浣，把最困难的第一品总算释成功了。第二品入手，忽感到世事无常，一气不回，这本经就释不成了，于是发誓奋勇从事，日不足继之以夜，至三月廿三日止，把十二品完全释成了。在这穷搜极想之间，仿佛似有悟入，然而这书是预备唤醒初机的，所以不敢把高远的理想尽量的发挥；但既依照字面解释，也仍旧都采译原注经文，又须保留原译经句的章法，所以这里文句也许有不自然的地方；然而遇到有经注秘晦不显，原译句过于不畅达之处，只好略参私意，使他明畅，好在这也是很少很少的。还有上面解过了的，下面也不再重解，阅者不明白的地方，请检前注就得。若是处处用注见前，或是见前注等字样，不但作者不便，恐怕阅者感到很惹厌的吧！&lt;/p&gt;

&lt;p&gt;这部经虽然是三根普被，然而重要一著就是改良人心。改良人心的工具是什么？那不能不说是因果报应。因为这一本经是完全著重因果报应的，所以我很希望本经能普遍流通，至于家弦户诵。假使把人人的心改良了，和平的社会、和平的世界、与平等大同主义也自然会实现了，更用不著口是心非阳奉阴违的一般人物纷纷扰扰的去口头宣传。所以述者要老实说一句，无论那一个伟大人物，要建设和平大同的社会和世界，必先切实的建设在人的良心上，才是根本的建设；否则，等于庸人自扰。为什么呢？因为世界大地是完全由于人心业报所造成的呀！还有修净土的应该注重这部经解，因为阿弥陀经上说，念佛七日一心不乱，阿弥陀佛来接引你，这是容易的事么？不要说七日，就是七小时之间要一心不乱，恐怕也办不到。倘若临终时心念一乱，神识就堕入幽冥界里，这时不仗地藏菩萨的大威神力来把你送到西方，还有什么地方去求救呢？所以念佛的人平时也不可以疏忽这部经的。&lt;/p&gt;

&lt;h3 id=&quot;地藏菩萨本愿经释题&quot;&gt;地藏菩萨本愿经释题&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这是书的题目。就是说，赞述地藏菩萨的本有愿行的一部经典。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;这部经的题目，佛自己说有三种：一个叫地藏本愿；一个叫地藏本行；一个叫地藏本誓力。现在即用他第一个为经题。地藏菩萨，是一个出世圣人的名字。菩萨是个通名，地藏是个专名。菩萨二字，梵文叫菩提萨埵，菩提是觉悟的意思，萨埵是众生的意思。合起来说，就是觉悟的众生或是觉悟众生的人，叫做菩萨。菩萨的专名，都是随菩萨的德行而题的。这位菩萨叫做地藏，也是他的德行，有合乎地藏二字的意义。今且分别说来。地就是土地，万物都依住地的上面，又地能生长草木的根芽。这位菩萨，有广大的慈悲，一切众生，都要靠他救护的；众生的善根，都要靠他生长的。好像土地一般，所以叫做地。藏就是宝藏，财宝足以救济人的贫苦，圆满人的事业。这位菩萨有无量的法财，布施一般苦恼众生，且使他们都能修行成就，好像宝藏一样，所以叫做藏。这一番的解释地藏二字，是譬喻菩萨的道德。再因这位菩萨，看见地狱众生的苦，发心学佛，已证得如来藏性──众生和佛平等的本性──所以救拔地狱众生，是他的特别本领，所以叫做地藏。再因这位菩萨，修地大圆通，证如来藏性，如持地菩萨，故菩萨来时，会中众生，都觉身重难举，因身中的地大──皮肉筋骨毛发爪牙属地大──受菩萨的影响，增强的缘故，所以叫地藏。这第二第三番的解释，地藏二字，都是表显菩萨的行为。总而言之，这位有地藏德行的菩萨，所以叫做地藏菩萨。&lt;/p&gt;

  &lt;p&gt;本愿二字，是说菩萨所发的愿，这个愿，是从他初发心来，常常所发的，直到现在，依然这样的发，并不是现在才发的，所以叫做本愿。又这个愿，是他多生的菩萨行为所依据的，有这个愿，才有他的行，愿是行的根本，所以叫做本愿。这样看来，这个本字，有本来和根本的两个解释了。经的一字，是世间圣人的训典，此书是佛菩萨的训典，佛菩萨是出世的圣人，所以也要称他为经。梵文本来叫修多罗。这梵文的意思，直译起来，就是一个线字，有贯穿文义的意思，正同我们华文的经纬的经字相仿；文译起来，那是契经两字的意思，契是契合的解释，因出世圣人的训典，是一种合乎道理、合乎人情的说话，所以叫做契经。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;唐于阗国三藏沙门实叉难陀译&quot;&gt;唐于阗国三藏沙门实叉难陀译&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这部经，是唐朝时候，从于阗国来的三藏沙门，名叫实叉难陀，到中国翻译出来的。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;唐，是李渊有天下的国号。因为李渊先在晋阳，晋阳是陶唐氏的旧都，所以封为唐王，到了受隋禅以后，统一天下，就称唐朝。其时到今，已约有一千三百年了。于阗是西域的国名，他的字义叫做地乳，因他的国祖，饮地上涌出来的乳而生长的。他的地点，在现今新疆的天山南路。三藏沙门，是译经师──翻译经典的法师──的道号。三藏是佛教经典的总称，佛教经典，共有三大集，叫做经藏、律藏、论藏。经藏是佛说法的记录；律藏是佛教的禁令规则和解释的书；论藏是佛和弟子讨论教义的记录。因这三大集的经典，形式上是包含许多的卷帙，实质上是包含许多的道理，所以叫做藏。沙门是出家修道人的通称，是勤息二字的意，因其有精勤修道，息灭烦恼的工夫。这个沙门，是通达三藏经典的，所以叫做三藏沙门。实叉难陀，是学喜二字的解释，是译经师的名字。唐朝武后圣历二年，于阗国王闻武后喜欢佛法，敬重经典，所以差沙门实叉难陀，把华严经同这部地藏经一齐送到中国来，武后受了这部经，就命这位沙门翻译成了华文，是这部地藏经出世的因缘。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;忉利天宫神通品第一&quot;&gt;忉利天宫神通品第一&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛在忉利天的天宫里，显起神通来，召集会众。这是本经的第一品。品是经文段落的名称。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;在我们的头上，第一重是四天王天，在须弥山的半腰；第二重就是忉利天，在须弥山的山巅，通俗都叫他做三十三天的。这忉利天的天王，名叫释提桓因，也叫帝释，他从前本是一个平常的女人，这时候有一尊迦叶佛寂灭了，他便发起愿心，造一座塔来供养迦叶佛；还有三十二个女人，也发起心来，大家帮助他来造成功。有了这一种善根，他得做忉利天王。那忉利天的四边，每边有八天，总共三十二天。各天的天王，就是那帮助造塔的三十二个女子做的。这也可知道造塔造庵的功德是很大的，可得著这种好报应。天宫是帝释居的地方，在忉利善见城。城的周围四万十千由旬（每由旬四十里），纯是黄金造成的。城的四面，都是千门楼。城的中央还有一重金城，有五百道城门，门都用著种种宝贝庄严的。这宝贝名目的繁多及美丽，说也说不尽的。这金城的中央，还有宝楼重阁，长五百由旬，广二百五十由旬。重阁最上的中央，还有圆室，广三十由旬，周围九十由旬，高四十由旬，就是帝释所住的地方了。并且这重阁都用琉璃众宝造成的，所以佛就在这里升了坐，替圣母说法。佛经上说，神的名称叫天心；通的名称叫慧性。佛具天心和慧性，放出各种照澈无碍的光明来，这就是神通了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;如是我闻。一时佛在忉利天，为母说法。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;像这样的话，我亲自听见佛说的。有一个时间，佛在忉利天，专为他的母亲来说佛法。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;佛就是释迦牟尼佛。把释迦牟尼四字，译作中文，即是能仁寂默。他的意义，就是说佛又能干、又慈悲、还能够寂静不动，很沉默的符合本性。从前在佛（以后佛字都指定释迦牟尼佛的）说法的时间，是没有人记录的。后来佛的堂弟名叫阿难的，恐怕日期久远了，大家都记不得，特意把佛讲过的佛法，一句句都记录起来。等到佛将要入涅槃（注见后）了，阿难问佛道：将来把你说过的佛法都编起经来，开头一句怎样的说？佛答阿难道：开头一句，就用如是我闻四字吧！那才可以证明，这种经都是你阿难亲身听见佛这样说的，不是从旁人口里听来的。所以阿难编成的经，开头一句，就用这四个字。如是，是指佛说的经。我，是阿难自己。闻，就是听见。&lt;/p&gt;

  &lt;p&gt;一时，即是有一个时候的浑语，因为时候是各方各代不同的。譬如外人用阳历，中国先前用阴历，像夏朝用夏历，周朝用周历。所以不能限定某年某月了。&lt;/p&gt;

  &lt;p&gt;为何佛专要为他的母亲说法呢？这就是这部经的根本，和别部不同的地方。因为释迦牟尼佛本来早就成佛的，为著要来劝化我们这世界上的人，所以特意来投胎做人。当时在中印度，迦毗罗卫国，那个国王，名叫净饭王，他的夫人，名叫摩耶夫人。佛就投胎到摩耶夫人肚里。在我国周朝昭王二十六年，甲寅年的四月初八日，从夫人的右边胁骨中生出来。就是一位太子。后来长大了，看见世界上的人，受种种苦恼，就看破了一切，不情愿做太子，情愿出家去修行。从十九岁起，修到三十岁，就得道成了佛，便到各处去说佛法，劝化世人，到七十九岁，就入了涅槃。&lt;/p&gt;

  &lt;p&gt;涅槃是梵语（梵语即印度话）。涅，是不生；槃，是不灭。不生不灭，就是佛证的真如实相。证是得到的意思。真如实相，就是说佛得到的真实相，不是虚假的相，能够永久不改变、不消灭，而且凡人所瞧不到的。&lt;/p&gt;

  &lt;p&gt;在我们世界上看得到的，那是叫做应身。你看上天的日月，无论什么地方，只要有水，不管你水的多少大小，他都能把影子来照应著的。我们众生根机缘分不是一样，感应了佛，佛像日月照水一样，就现出身来救度我们，这是叫做应身。&lt;/p&gt;

  &lt;p&gt;再说摩耶夫人从佛在他的胁下生出来以后，到第七日就死了，因为他是一个佛母，所以神魂就生到忉利天宫去，做了天子。等到佛将入涅槃的时候，因生身的母恩，还没有去报答，发起一片孝心，特意把肉身飞升到忉利天上，专门为他的母亲说法（法，凡是见得到、听得到、说得出的，都可以叫做法。）以报生身的大恩。那么就将这部完全演孝的地藏菩萨本愿经，也连带的传了出来。所以经里都以孝做根本，句句可寻得出孝的脉络来。现在一般无知识的僧人，一入空门，便说释子不干俗事，就不去敬重父母，这非但不孝，简直是佛的逆子了。从来佛菩萨及祖师，没有一个不孝敬父母，不孝敬师僧三宝的。所以孝是三教同尊的一件最要紧的根本大事呀！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;尔时十方无量世界，不可说不可说一切诸佛及大菩萨摩诃萨，皆来集会。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时候十方没有量数的世界，说不来的多，说不来的多，一切诸佛，以及有大多胜三种资格的大菩萨，都会集拢来，听佛讲经。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;当这个时候来的佛和菩萨，是很多很多的，所以分别不出是甚么地方，甚么刹土来的？只好统称十方无量世界。因为东方、南方、西方、北方、东南方、东北方、西南方、西北方、上方、下方这十方每方各有无量数的世界。（心量所不能知道他数目的就叫作无量数）世界既然无量，那些世界上佛菩萨，更加多了，所以称为不可说，不可说，一切（是包括全数的意思）。摩诃有大多胜三种意思。此等菩萨，心量又大、行为又大、器量又尊重，为天王等大人所尊敬的，所以叫做大。此等菩萨世世都出世间，除了佛以外没有人可同他比较的，还能够超出九十五种外道，所以叫做胜。此等菩萨都能知道世界以内、世界以外的尘沙，还能够博通正的、邪的一切经书，所以叫做多。有此三种资格，才可以称大菩萨摩诃萨。因为这各方的佛和大菩萨，知道佛要讲经，所以都来忉利天宫聚会了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;赞叹释迦牟尼佛，能于五浊恶世，现不可思议大智慧神通之力，调伏刚强众生，知苦乐法。各遣侍者，问讯世尊。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;十方诸佛，先称赞叹美道：释迦牟尼佛，能够在见浊、烦恼浊、众生浊、命浊、劫浊的五浊世界，现出想也想不到、说也说不出的，大智慧、大神通的法力，来调伏众生刚强难化的习性，要叫他分辨得出、知道苦和乐的方法，是多么辛苦了！所以再各叫他侍从的菩萨，来问讯世尊，表示慰藉。（世尊即是释迦牟尼佛。）&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;现在我先将五种浊，以及六种神通、十种神力，简单的来说一说明白。五浊：&lt;/p&gt;

  &lt;p&gt;第一是见浊。见浊有五种，其中最烈的是我见。因为人都执定了有一个我，有我的身体，就生出了这种我的见解；有了我的见解，便要分别出旁人来了；因为我同旁人有了分别，便生出种种不平等、不合理的心思来；造出杀、盗、淫、妄等种种恶业了。&lt;/p&gt;

  &lt;p&gt;第二是烦恼浊。也有五种，第一种是贪，有了贪心，就这样也要，那样也要；这也舍不得，那也舍不得，不但永远不能脱离这个世界，并且有贪心，就要造出种种恶业来了；第二种是嗔，碰到一些些不称心的事，就要发火，一些也不肯忍耐，因发了这个嗔心，又要造出许多许多的恶业；第三种是痴，一些不明白道理，假的认作真的，真的反认作假的，正路邪路都分辨不来，像这样自己不能觉悟的人，怎么可以修道呢？第四种是慢，对了随便什么人，一味的骄傲，一味的自大，没有一些虚心和恭敬心，这样人随便学什么事情，都不能上进的，何况学佛法呢？第五种是疑，无论你做什么事，一有了疑心，就没有主见，要想做，又不想做，要不做，又想做，把心思都扰乱了，生出许多烦恼来，不得一些清净，所以叫做浊。&lt;/p&gt;

  &lt;p&gt;第三是众生浊。是说众生永远在六道（天道、人道、修罗道、畜生道、饿鬼道、地狱道）里面，生生死死无了期，侥幸给你做了人，也免不了生、老、病、死等各种苦恼，若是堕到三恶道里去，那更加有说不尽的苦了，像这苦没有脱离的日期，所以叫做浊。&lt;/p&gt;

  &lt;p&gt;第四是命浊。一个人活在世上，富贵贫贱，都由命安排的，况且一年四季，寒暑风霜，无非催人老死，临终一口气呼出就了结，照此相像，人命同朝露一般，一眨眼就没有了，真是危险得很呀！所以叫做浊。&lt;/p&gt;

  &lt;p&gt;有上面四种循环的浊，才为造成最后的一个劫浊；但在这个时代，表面有成、住、坏、空四个中劫，每个中劫里各有二十个小劫，像水火、刀兵、瘟疫等等都是，到了坏劫，又会生出各种大灾来，人的寿命，忽然加多，忽然减少，有这样的坏处，所以也叫做浊。生在我们这世界上的众生，都免不了受这五浊的苦楚。&lt;/p&gt;

  &lt;p&gt;还有佛的六种神通：第一种叫天眼通。无论日间夜间，无论远到几千万亿里的路、几千万亿的世界，无论多少的大山隔著，没有一些看不见的，就是极黑暗的地方，也可以看得清清楚楚；不像我们凡夫，有了一张纸、一道墙遮阻隔，或是到了黑夜里没有光地方，就一些也看不见了。&lt;/p&gt;

  &lt;p&gt;第二种叫天耳通。无论远到几千万亿里路、几千万亿世界，很轻很低的声音，没有听不见的，连心里起的念头，也都能听见；不像我们凡夫只能听近处的高大的声音，若远一些，轻一些的，就听不出来。&lt;/p&gt;

  &lt;p&gt;三叫他心通。无论是什么人心里面的念头，没有不晓得的，无论什么书，不用读过看过，那书里所说的道理事情，都会晓得的，不识字的人也会识字了；不像我们凡夫不要说旁人的念头，就是你父子夫妻最接近最恩爱的人，他心里起的念头，也不会给你晓得一些的。&lt;/p&gt;

  &lt;p&gt;四叫宿命通。无论是自己旁人的事情，无论这一世的、前一世、前十世、前千万亿世的事情，都会明白的；不像我们凡夫自己小时候的事情也都记不得，那里还会晓得前世的事情呢？&lt;/p&gt;

  &lt;p&gt;五叫神足通，又叫如意通。只要你动一动念头，十方无穷无尽的世界，就都可以走遍，并且一些不吃力，一些不烦难，高山大海，都不会阻隔的；不像我们凡夫凭你极强健极会走路的人，也不过一天走一百里罢了，若是碰到高山大海，就过去不得，或是有了大风雨，就走不来了。&lt;/p&gt;

  &lt;p&gt;六叫漏尽通。漏字是什么意思呢？譬如一只破的瓶，把水装进去，就都要漏出来。凡夫有了贪、嗔、痴等种种烦恼，他的念头都会给烦恼牵了去，干出种种的恶业来，守不定自己的心，像这只漏瓶一样；漏尽就是这种漏的坏处，完全没有了，把贪嗔痴种种烦恼，一齐去得清清净净，一些也没有，因为这样就可得到大神通。&lt;/p&gt;

  &lt;p&gt;有了这六种神通，自然会有下面十种神力：一，知是处非处智力；二，知过去未来业报智力；三，知诸禅解脱三昧智力；四，知诸根胜劣智力；五，知种种领解智力；六，知世界智力；七，知一切至处道智力；八，知天眼无碍智力；九，知宿命无漏智力；十，知永断习气智力。须知浊世不易住、神力不易现、刚强众生不易化、苦乐法不易知，而我佛能住能现能化能知，甚为希有、甚为难行能行，所以十方诸佛既赞叹了，又遣侍者慰问世尊。所谓惟佛与佛乃能知之。这一段文，就是发起全经的张本。　&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;是时如来含笑，放百千万亿大光明云，所谓：大圆满光明云、大慈悲光明云、大智慧光明云、大般若光明云、大三昧光明云、大吉祥光明云、大福德光明云、大功德光明云、大归依光明云、大赞叹光明云，放如是等不可说光明云已。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时候，佛含著笑容，放出百千万亿很多很大很光明的云来。这等云，就叫大圆满光明云、大慈悲光明云，等等云，……把这样子说不尽好的光明云放罢了。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;前两节，都说十方佛菩萨集会来听经，虽还没有听到佛说，都先赞叹佛的希有功德，还差侍从的菩萨慰问于佛。这时候，如来一方面欢迎诸佛，一方面召集会众，觉得机缘已至，心中非常欢悦，面上现出含笑的样子来。况且佛刚要想宣扬地藏愿力的机会，佛本来以度人作事业的现在的机缘将要完毕，未来的机缘，已经有人来负担，所以他心里很快活；心里快活，自然含笑放出种种的光明来。这部经里忉利天宫神通、如来赞叹、见闻利益三品，都是放光的。这一品放光，同如来赞叹品一样，都把全身的光明放出来。如来（是佛的又一德号，依法身不变的体，起应身随缘的用，不变名如，随缘名来，故称如来。）含笑是不放唇露齿，合口悦面，喜气盈眉，笑从口出，一切毛孔皆开，所以全身放出光明来。百千万亿是说佛光的多，佛的一身能够现出十光、百光、千光，还可以现出无穷无尽的光，都应了时机来表演他佛法的。大光明云的大，是佛称心的大，这个大是无大不包的，因为佛的光明，胜过日月的光明几万万倍，他能照破幽暗，照破日月所照不到的一切地方；云是阴阳会聚而成功的，他能逶迤上去，自然成文，他的颜色有浓淡的分别，还能变化出许多形态来，还能酿出雨降下来，似表演如来现身像云一样，说法像雨一样，使众生的菩提芽，得了云雨的滋润，自然的生长起来。&lt;/p&gt;

  &lt;p&gt;所说的大圆满光明云，是称赞佛果位的功能，佛光无处不照遍的，所以叫圆；无论那一世界有缘能行孝道的众生，都使他们得到果位，所以叫满。&lt;/p&gt;

  &lt;p&gt;慈悲是佛的本意，放出这种大慈悲光明云来，照众生；众生得照，心身立时清净，非常快乐；一得著乐，便可以脱离一切的苦恼。&lt;/p&gt;

  &lt;p&gt;智慧，是众生与佛同有的，因众生受了五浊的蒙蔽，以至昏迷不现，所以佛放出大智慧光明云来，叫众生接受了，就能够心地豁然开朗，发出本来同佛一样的智慧来。&lt;/p&gt;

  &lt;p&gt;般若是学佛最要紧的一种智慧，他能够使你破除一切妄念痴迷，所以佛放出这种大光明云，叫众生接受了，也可以得到这种般若智慧。&lt;/p&gt;

  &lt;p&gt;三昧是佛的正见正定功夫，不像我们凡夫学道，往往辨不出正见，去接近外道；辨不出正定，去接近邪定，所以佛放出这种大光明云来，叫凡夫接受了，也可以得到正见正定功夫。&lt;/p&gt;

  &lt;p&gt;有大吉的事情，方能发出一种祥瑞，在佛的意思，似说你们得听到这部演孝的地藏经，将来一定可以叫你们都得到佛果，所以先放出这种大光明云来，给你们一种很吉祥的预兆。&lt;/p&gt;

  &lt;p&gt;福是众生做了善事的好报应，所以给你享福；德是众生能够宽量饶人，存心仁义，所得来的，佛能够修六度万行，所以有此福德，证到无上果位，现在放出这种大光明云来，叫众生见了这光明云，也好学起积福德的行为来。&lt;/p&gt;

  &lt;p&gt;功德是佛修了无量无数的功行，方才成功这种大德，现在放出这样的大光明云来，叫众生也好照样去修功行，自然也可以得到这种功德。&lt;/p&gt;

  &lt;p&gt;归是归顺，依是依赖，因为我们众生世世颠倒在六道受苦，其实都为这个心没有归依的地方所造成的，所以佛放出这种大归依光明云来，叫你们众生把心思打定，一心不二的来归依佛，再照地藏经修行学孝，保你这一世可以得到佛果，不再到六道里去受苦。&lt;/p&gt;

  &lt;p&gt;赞叹是云里发出来的声音，佛放出这种大光明云来，有几种意义：一是赞叹十方来集会的佛菩萨；二赞叹地藏能这样行愿，有这样大的孝誓；（地藏菩萨曾说过：六道众生里面，一切男子是我父，一切女子是我母，若不度尽地狱众生，我不成佛。所以他修到无穷无尽的劫数，仍旧在地下，有这样大的行愿孝誓，佛自然要赞叹了。每一个劫，有十三万四千四百年。）三赞叹诸佛还能差人来问讯；四赞叹自从这部地藏经出世以后，一定四方有许多孝顺父母、孝顺师僧三宝的众生出现。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;又出种种微妙之音，所谓：檀波罗蜜音、尸波罗蜜音、羼提波罗蜜音、毗离耶波罗蜜音、禅波罗蜜音、般若波罗蜜音、慈悲音、喜舍音、解脱音、无漏音、智慧音、大智慧音、师子吼音、大师子吼音、云雷音、大云雷音，出如是等不可说不可说音已。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛把上面的各种大光明云放罢了，以后又发出种种很细很和好的声音来。这声音就是所说的檀波罗密音等十六种声音。发出这样一类说不尽的声音完毕。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;佛把种种大明云放罢，还不肯说这部经，又发出种种细微和好的声音。音是各种平和优美的鸣声，调和而成功的，况且佛的音更加柔和清雅，无论怎样好听的吹弹，都没有佛那样发出来的好听。&lt;/p&gt;

  &lt;p&gt;檀那是梵文，我们叫布施，布施是把自己所有的金钱等宝贵东西都去送给一般没有的人，所以布施是万种修行的第一法，也是贪欲人的忏悔法。&lt;/p&gt;

  &lt;p&gt;梵文波罗密，我们叫登彼岸，是做事成功的意思。&lt;/p&gt;

  &lt;p&gt;梵文尸罗，我们叫止得，止住了恶的事不干，得了善事很恭敬的去做，一些不偷懒。佛发这种声音来似叫你们赶紧去行布施孝道等善事，将来成了佛，度尽生生世世父母，来干最大的孝行。&lt;/p&gt;

  &lt;p&gt;梵文羼提，我们叫忍辱，忍有生忍法忍二种，生忍是不杀生，连蚊子也不拍杀一个，人家有意来扰乱你、来打你、骂你，也能忍耐得住，可以得大福报；法忍是煆炼修持，断绝一切烦恼，可以得增长智慧的报。能够修两种忍，那是最好的，佛发出这种音来，就是要你们修两种忍的意思。&lt;/p&gt;

  &lt;p&gt;梵文毗离耶，我们叫精进，是叫众生一心上进，不肯退落，很勤力的作善事念佛拜佛，这叫外精进；心里没有妄念不起恶念，这叫内精进。众生听了这种佛音，自然不敢退落，不觉疲倦了。&lt;/p&gt;

  &lt;p&gt;梵文禅那，我们叫静虑，因为我们的心，都像猴子野马一样，一息不停的乱跳乱跑，所以佛发出这种声音来，叫你们来学禅定，把心定住了，不放他散乱，自然很安静的没有思虑，修成一种出世的根本。&lt;/p&gt;

  &lt;p&gt;梵文般若，我们叫智慧，一般凡夫的智慧，早已给五浊迷住了，佛发出这种音来，叫你们的迷梦醒醒，好现出一些本有的智慧，发生一种道心来。&lt;/p&gt;

  &lt;p&gt;慈、悲、喜、舍是说四种无量音，能够使他人快乐，叫做慈；救济他人的苦楚，叫做悲；他人得了快乐，我就欢喜，叫做喜；很平等的不起一些些憎爱执著，叫做舍。这四种心的意义是很广的，你能种种做得到，自然可以得到解脱的方便。处处能够解脱，一切妄念恶浊也自然难牵缚你的道心了，终于得到无漏。（无漏的意义同前释漏尽通一样）发现本来的智慧。去修成证到佛的圆果，那就可以得到大智慧了。佛发出这种音来，无非叫你们众生发起道心，修习各种方法。狮子生在非洲的深山大谷里面，他咆哮起来，把口扣著地上，现出大威势，百兽听了都吓得逃避绝踪。小狮子吼，比喻佛说法，一切邪道听了，都也逃避绝踪；大狮子吼，比喻佛说大乘圆教，听了可以叫人得到无畏的解行。&lt;/p&gt;

  &lt;p&gt;云雷大云雷音，是比喻佛身像云，佛说法像雨，佛的音像雷一样能够远震，使众生听了雷音，猛然警悟，生欢喜心。佛发出这十六种音，说一句总话，都为著感应众生，要用什么方法得度的，便发出什么音来，所以把这样说不尽的音，都发出完毕。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;娑婆世界，及他方国土，有无量亿天龙鬼神，亦集到忉利天宫。所谓：四天王天、忉利天、须焰摩天、兜率陀天、化乐天、他化自在天、梵众天、梵辅天、大梵天、少光天、无量光天、光音天、少净天、无量净天、遍净天、福生天、福爱天、广果天、无想天、无烦天、无热天、善见天、善现天、色究竟天、摩醯首罗天，乃至非想非非想处天，一切天众、龙众、鬼神等众，悉来集会。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;我们的娑婆世界，以及十方的各世界，各处的大国家、小邦土，有无量无数亿的天上的人民，以及龙、鬼神，都也集到忉利天宫来。所说的天，就是四天王天、忉利天、须焰摩天、兜率陀天、化乐天、他化自在天，这叫欲界六天的；梵众天、梵辅天、大梵天，这叫初禅三天的；小光天、无量光天、光音天，这叫二禅三天的；少净天、无量净天、遍净天，这叫三禅三天的；福生天、福爱天、广果天、无想天、无烦天、无热天、善见天、善现天、色究竟天，这叫四禅九天的；合并以上一二三禅天，总共十八重，都叫色界天的；从色界天上去，还有摩醯首罗天、非想非非想处天等四重都叫无色界天的。这许多天上的一切人民、一切的龙鬼神等等，都聚集了相会。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;上边说过，佛放出了种种大光明云，又发出了种种微妙之音，所以惊动了我们的世界，以及他方的各世界、各大国家、各小邦土，有无量无数亿的天上的众人，和龙，还有鬼神，都承蒙了佛的光音，也会集了到忉利天宫，来听佛说这部伟大重要的地藏经。所说的四天王天，在须弥山的半腰，一切事情和我们人间一样，须弥山的东边，有黄金埵，是持国天王住的；南边有琉璃埵，是增长天王住的；西边有白银埵，是广目天王住的；北边有水晶埵，是多闻天王住的；各一边都有十千由旬阔。凡是人间能修布施、持不杀戒、欢喜听佛法、孝顺父母、供养善人的人，死了就可以生到这重天上，他的寿命就有五百岁了，人间的五十年，只抵得他一昼夜。以后上去高一重天，寿命好处都加上一倍。忉利天（前已说过了）。&lt;/p&gt;

  &lt;p&gt;梵文须夜摩，我们叫善时分，生到这重天上去，便能叫你时时快乐，而且这天里用莲花开合以分昼夜的，赤莲开时是日间，白莲开时是夜间，这里日月已照不到了，由众人的身上，放出光明来，所以叫他做善时分的。我们能布施、不杀盗、心意柔和的去敬重父母、戒去淫欲，死了就可以生到这重天里来。&lt;/p&gt;

  &lt;p&gt;梵文兜率陀，我们叫知足，凡是生在五欲的地方，能够知足、没有口过、存心孝悌，再加清静的做功益、修福德，死了就生到这重天里。&lt;/p&gt;

  &lt;p&gt;化乐天，是说生在这重天里的人，会转变化现，忽有忽无，凭著自己的神力福力，可以现出各种随心所欲的境界；我们能孝顺父母、敬重万物、多闻佛法、领解佛学，命终便投生到这重天里。&lt;/p&gt;

  &lt;p&gt;他化自在天，是欲界六天之主，他能够将他人的快乐，来作自己的快乐，倘若他心里欲得一种境界，其余的天都会化给他的；人间一千六百年，只抵得他们的一昼夜，寿命已加到一万六千岁了。&lt;/p&gt;

  &lt;p&gt;梵众天，梵是指清净无欲的意思，众是指人民，就是说在这重天里的人民，都是很清净的，一些也没有淫欲的妄念。&lt;/p&gt;

  &lt;p&gt;梵辅天，是比喻匡助的辅臣一样。大梵天就是指天王，这天王名叫尸弃，他能够劫初先生，劫尽后灭；因为从初禅天再上去是没有言语的了，只有初禅天里心内还有观觉思念，外面也有言语号令，他有统领各天上、各世界的权衡，所以有民、臣、王三重天的分别。小光天，是说这天里的菩萨，都能修禅定，定中还能出光，还能住在云雾里面，他的光明有从身上放出来的，有从口里放出来的，光明里面还发出各种音来，心里已没有一些妄念，口中也没有一句言语，都用发出来的音，替代讲话的，所以这三天的名称都一样的。&lt;/p&gt;

  &lt;p&gt;无量光天，是说光明增加得无限量的倍数了，但是他增加光明，也有上中下三等的分别，这都是从前心爱清净，还喜布施持戒，所得来的好处，倘若还能够在黑暗地方点灯，或者在佛前、塔中、寺中，点灯供养佛、菩萨，更加可以得到增加无量光明的好报应。&lt;/p&gt;

  &lt;p&gt;光音天，是说净光能照到旁的地方去，更用著智慧的光明，来教化愚痴邪见的众生；在这重天的菩萨，身上都有赤色的光明，更有五种神通，形相也没有障碍，心中也不起观觉了，所以也叫做定心喜乐地的。&lt;/p&gt;

  &lt;p&gt;少净天，是说已经脱离了初禅天的喜心，得著静定的快乐，但是这快乐并非出于境地的，是从静性恬澹寂净之中得来的，而且都得于内心，没有一些从外境得来的，所以叫做少。&lt;/p&gt;

  &lt;p&gt;无量净天，是说在这天的菩萨，身心轻安，已经成就寂灭的快乐，净心也较胜从前了，所以身外一切，更加得著清净，无量净，就是这个意思。&lt;/p&gt;

  &lt;p&gt;遍净天，是说普遍一切，万物和我没有两样，是说前二天虽然得著清净的快乐，但是还没有周到普遍，所以还说不到遍净乐，现在他不但已达到遍净乐，而且还能够消灭一切欢喜心，纯粹的乐著清净，所以也有叫他离喜妙乐地的。&lt;/p&gt;

  &lt;p&gt;福生天，就是修胜福力的菩萨，方才可以生到这重天里，所以有这个名称。从这天以上，都居在薄云里，像星一样的散住著。&lt;/p&gt;

  &lt;p&gt;福爱天，是说喜乐都能舍去，凡有所求的，无非是修积福德，成就希上广果。&lt;/p&gt;

  &lt;p&gt;广果天，是说凡夫之果，没有比他好的，所修的功德，所得的果报，都超过以下诸天。&lt;/p&gt;

  &lt;p&gt;无想天，凡是修无想定的，都生到这重天里，寿命五百劫，除初生彼半劫，想心还在，到后来再退，灭半劫，想心又起，中间共有四百九十九劫，想心不行。无烦天，是说没有下界这样见思烦恼的杂乱。&lt;/p&gt;

  &lt;p&gt;无热天，是说在此天内心意快乐、调和、柔顺，能离去下界种种见思烦恼的执著。&lt;/p&gt;

  &lt;p&gt;善见天，是说禅的障碍已除去了，所以见识很明彻的。&lt;/p&gt;

  &lt;p&gt;善现天，是说这天里的形色，比别天更好，而且善能变现。&lt;/p&gt;

  &lt;p&gt;色究竟天，是色法最极的地方。这五重天，都是三果罗汉住的；三果，就是说初起一念无漏，次起一念无漏，后起一念无漏，由这种无漏势力所感应，生到这样清净的地方来。&lt;/p&gt;

  &lt;p&gt;梵文摩醯首罗，我们叫大自在天，在色究竟天的中央，有十住菩萨住在这地方，这菩萨也叫大自在天王的，他的形相，生著八条臂膊，三只眼睛，乘了白牛，手执了白拂，只要念头一转，就能够知道大千世界的雨滴数目，这天也是色界天的最后一重了。&lt;/p&gt;

  &lt;p&gt;乃至非想非非想处天，乃至两字，包括空无边处天、识无边处天、无所有处天，三重天的意思；合非想非非想处天共四重，总叫无色界四天的，生在这天的菩萨，连色身也看不见了，所以叫无色界。&lt;/p&gt;

  &lt;p&gt;龙是一种最长大的鳞虫，也算一种神物，他能随意变化大小长短，或隐或现的。鬼是人死后入地的魂魄所结成的。&lt;/p&gt;

  &lt;p&gt;神是一种忽隐忽现，力能拔山倒海的神道。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;复有他方国土及娑婆世界，海神、江神、河神、树神、山神、地神、川泽神、苗稼神、昼神、夜神、空神、天神、饮食神、草木神、如是等神，皆来集会。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;还有别地方的国家和佛土，以及我们世界里的，海里的神、江里的神、河里的神、树里的神、山上的神、地下的神、川泽里的神、护苗稼的神、日游神、夜游神、空中的神、天上的神、草木里的神，这样许多的神，都到这里来集会。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;上面神字虽然已经提过，但是没说明白，要你们知道神的名目和大概，所以不嫌重复的再来说一回。&lt;/p&gt;

  &lt;p&gt;海神，是专门管理海里面事情的，他名叫海若；江神，是专门管理江里面事情的，他名叫江伯；河神，是专门管理河里面的事情的，名叫宓妃；这三位总称就叫水神。&lt;/p&gt;

  &lt;p&gt;树神，是专门管理各种植物的，所以大树里往往有树神住著，人家不敢去砍斫的。&lt;/p&gt;

  &lt;p&gt;山神，是专门管理山里面事情的，所以每座名山，就有一位山神去主管的，他的名称也没有一定，跟著山叫的。&lt;/p&gt;

  &lt;p&gt;地神，是专管地底下事情的，他名叫只；管理阎浮提的地神，名叫坚牢。&lt;/p&gt;

  &lt;p&gt;川，也可以做穿字解，是说小流的水，穿地下流的意思，也有神管著。&lt;/p&gt;

  &lt;p&gt;泽，是水汇聚的地方，也有神主管的。&lt;/p&gt;

  &lt;p&gt;苗稼神，是专门管理五谷的，苗是没有长成的禾，古时有一个人，名叫后稷，专门教百姓耕种，死后就做了苗稼神。&lt;/p&gt;

  &lt;p&gt;昼神，是专管白昼人所做的善恶；&lt;/p&gt;

  &lt;p&gt;夜神，是专管黑夜里人所做的善恶。&lt;/p&gt;

  &lt;p&gt;空神，专管半空中事情的，名叫舜若多。&lt;/p&gt;

  &lt;p&gt;天神，就是大天神，他能够伸长四手，取四海的水，可以来自己灌沐；化现一切的珍宝，来供养佛。&lt;/p&gt;

  &lt;p&gt;饮食神，是专门监管天下饮食事情的，像东厨司命的灶神、庙宇里的伽蓝菩萨等就是。&lt;/p&gt;

  &lt;p&gt;草木神，是管理天下一切草木药材，这神灵是释提桓因（前面已解说过了）所化的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;复有他方国土及娑婆世界，诸大鬼王，所谓：恶目鬼王、啖血鬼王、啖精气鬼王、啖胎卵鬼王、行病鬼王、摄毒鬼王、慈心鬼王、福利鬼王、大爱敬鬼王，如是等鬼王，皆来集会。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;开头二句，同上面解法一样的。所说的恶目鬼王，是说他眼睛生得很凶恶。啖血鬼王，是专吃活人鲜血的。啖精气鬼王，是专吃人精液的。啖胎卵鬼王，是专吃胞胎的。行病鬼王，是专管人病痛的。摄毒鬼王，专管各种毒物，不使他来害人。慈心鬼王，是常使人家快乐的。福利鬼王，是专免人罪恶，加人福德的。大敬爱鬼王，是最爱惜众人、敬重善人的。像这一类的鬼王，没有一个不来集会的。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;前段鬼字虽提过了，因为没有分出鬼的名目来，所以再来说一个大略。鬼是人死后的魂魄，各处都有的。在做人的时候，若肯行善事，还能够惜福积德，那么死了，阎王就封你做山林坟冢祠庙等各地方的神，享那祭祀的飨食；在做人的时候，不肯惜福积德，而且还要干五逆、（五逆是杀父、杀母、杀阿罗汉、破坏僧侣、出佛身的血五种）十恶（一，杀生，是杀死活的东西，就是蚊子也不能拍死一个的；二，偷盗，凡是人家的东西，无论一梗草，人家没有应许你过，也不能拿的；三，邪淫，除了正式的妻妾以外，其余犯的都是恶业；四，妄语，就是说谎话；五，绮语，就是讲妇女的长短；六，恶口，就是骂人；七，两舌，就是搬弄是非；八，贪欲，就是不知足；九，嗔恚，就是不能忍耐，一些不得意就发火；十，痴愚，就是不肯相信真正的佛法，去信旁的邪道。做了上面十种坏事，就是犯十恶业，死后受无穷苦楚；不做这十种坏事，就是修十善业，死了就叫你生到上面说过的各重天上去。）的坏事情，死了就罚你到最污秽的地方去，不但得不到吃食，而且还时时的用皮鞭子抽打，打死了，把你去填河，或者去塞海，所受的苦楚，是说不尽的。不惜福修德的人，到了这时，懊悔也来不及了。&lt;/p&gt;

  &lt;p&gt;鬼是很多的，说也说不尽，所以把几位重要的鬼王来说一说。&lt;/p&gt;

  &lt;p&gt;恶目鬼王，是最凶恶的，他这种凶恶的形相，却从两只眼睛的神光里透了出来。&lt;/p&gt;

  &lt;p&gt;啖血鬼王，梵文叫诃利只南，专喜吃活人鲜血的，他住在屠杀的刑场里面，也要吃腥膻的东西。&lt;/p&gt;

  &lt;p&gt;啖精气鬼王，梵文叫毗舍阇，专喜吸活人的精液，也要吃五谷的精气。&lt;/p&gt;

  &lt;p&gt;啖胎卵鬼王，是专吃胞胎的，卵是比喻胎的意思，所以妇人临产的时候，有许多的鬼，都抢著来吃胞衣恶血。&lt;/p&gt;

  &lt;p&gt;行病鬼王，是说天将降下瘟疫的灾来，东岳府君必差了这类鬼去干的。&lt;/p&gt;

  &lt;p&gt;摄毒鬼王，他专心行仁恕的事情，所以切念著要救济世人，因世间上各种的毒物很多的，像毒蛇、毒龙、毒蛊一类都是，无论什么人，一碰到他，立刻就会伤命，这鬼王都把他们收摄了，免得来害世界上的人。&lt;/p&gt;

  &lt;p&gt;慈心鬼王，是常常为给人家快乐，念念爱护众生，心慈了，面也生得慈了；名是鬼，实在菩萨的化身呀！&lt;/p&gt;

  &lt;p&gt;福利鬼王，就是各府各县的城隍，他专做赦人罪恶、加人福德这类好事的，所以有这样好的名称。&lt;/p&gt;

  &lt;p&gt;大爱敬鬼王，他很爱惜众生、记念众生，同慈母爱念儿子一样；倘若碰到了作善事的人，他就同佛一样的来敬重你。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;尔时，释迦牟尼佛告文殊师利法王子菩萨摩诃萨：汝观是一切诸佛菩萨及天龙鬼神，此世界他世界，此国土他国土，如是今来集会到忉利天者，汝知数否？&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时候，释迦牟尼佛告诉文殊师利法王子菩萨摩诃萨说：你瞧！这一切许多的佛菩萨，以及天龙鬼神，这个世界的、那个世界的，这个国土的、那个国土的，像这样多的天龙鬼神，今朝都会集，到忉利天来的，你知道他的数目么？&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;尔时，就是各世界，各国土，以及各处的天龙鬼神齐集的时候。还有十方佛菩萨的主伴也亲自来了，诸天的民众也都来了，各色异类的种族，跟著的许多伴侣也来了。来的模样，都是争先恐后的赶著，像众鸟投林一般，又像大海的容纳百川一般，顷刻之间，圣人和凡人都浑合了。因来的人有这样涌挤，所以都起了一种想发问的疑心，这来的许多人，来闻妙法来的呢？还是来授记来的？这时佛一运智慧，已经知道众人存心的疑问了，就借了他们众人的疑问，来问文殊。佛为甚不告别的菩萨，而专告问文殊呢？因文殊为众菩萨的首领，而且也最聪明的。现在给佛诱问引弄了，也好为后科启请正宗、做伏笔。&lt;/p&gt;

  &lt;p&gt;法王子，佛是法王，菩萨可补佛位的，也叫做补处子，所以称法王子。&lt;/p&gt;

  &lt;p&gt;梵文文殊师利，我们叫妙德，因他本是古佛，有三德佛性的；这部经正要显出孝行为众善的根本来，非文殊这样智慧，不能和佛相问答的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;文殊师利白佛言：世尊，若以我神力千劫测度，不能得知。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;文殊师利回答佛说：世尊！倘若用我的神通法力，经过千劫的长久时间，思量测度起来，还不能够知道这数目。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;文殊是过去的无量阿僧祇劫以前已成佛了，过去叫龙种上尊王佛，现代叫藏摩尼宝积佛，未来叫普现佛。既然是三世古佛，难道连这一些些人数也会猜测不出的么？这是有二种妙意在里面：一是自己谦让，不像凡人一样，专喜呈自己聪明，不晓得的事情也要来说的，这样一谦让，可以显出佛的尊重；二，这许多来众，都是地藏菩萨久远劫来所化成的，也都是地藏菩萨的因地，从孝思而行愿的来源，倘若文殊认真答出了数目，那么，后文地藏久远劫来一句话，就找不到根据了。现在文殊却好说不知道法会来众数目，顺便的衬出后文，佛用五眼遍观，犹不能尽的话，而且更涵著催促佛说出地藏行孝的本愿来，一唱一和的成功一种妙曲，也是集成地藏菩萨自始至今行孝的大典呀！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;佛告文殊师利：吾以佛眼观故，犹不尽数，此皆是地藏菩萨久远劫来，已度、当度、未度，已成就、当成就、未成就。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛告诉文殊师利说：用我的佛眼，（佛眼有五种，也叫五眼的，就是，肉眼、天眼、慧眼、法眼、佛眼。）来观看的缘故，还不够瞧尽这个数目，这都是地藏菩萨从久远劫数以来，已经引度的、应当要引度的、还没有引度的，已经修成功的、应当要修成功的、还没有修成功的，所以有这样多的人。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;上段因文殊回答佛不知道，所以佛用了佛眼，遍处都瞧过，又用了文殊的意思，反转来告诉文殊说：用我的佛眼来瞧，也瞧不尽他的数目哟！佛是具五眼的，他真的为瞧不尽么？因为这许多来的大众，都是地藏菩萨久远劫来所化成的，是指明历时长久了，方显出他所化的大众多得瞧不尽了。&lt;/p&gt;

  &lt;p&gt;已度已成就的，就是现化在十方国土，坐道场度生的都是。当度当成就的，就是各佛土的各菩萨，修上求下化的都是。未度未成就的，就是浑入在天宫大会里面，没有学道的都是。但是度和成就也不得不分开来说，度是法度，也就是投机的方法，先度量了众生根器大小的分别，随后大的，投给他大方法，小的投给他小方法，方法相宜了，方才可以依了所授的方法去修持学习，这就叫引度的；成就，是凭了这种方法去修习，修习既久，因圆果满，名叫成，随后度生的事业都可以办了，各种的机缘也自然都会凑集的，这叫就。&lt;/p&gt;

  &lt;p&gt;看到这一节，一定有许多人要疑心，以为佛坐在多重阁上，周围只有九十由旬，怎样能容受得这许多的大众呢？因佛法是不可思议的，他能够把多少融会、大小相摄，不是凡心所可以胡乱来测度他的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;文殊师利白佛言：世尊，我已过去久修善根，证无碍智，闻佛所言，即当信受。小果声闻、天龙八部及未来世诸众生等，虽闻如来诚实之语，必怀疑惑，设使顶受，未免兴谤。唯愿世尊，广说地藏菩萨摩诃萨因地作何行，立何愿，而能成就不思议事？&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;文殊师利对佛说：世尊！我已经过去到了如今，是长久修善根的，故此能得到一种没有阻碍的大智慧，所以一听了佛所说的话，我当然是很相信的，像那修小果、闻小法、不闻大囧琺的大众，以及天龙等八部和未来世的众生一类，虽然听到如来诚实的言语，必定要怀著疑惑不决的心意；倘若他们外面顶戴受持了，内心仍旧不能领会，难免说出不相信的话来，反要成为一种谤毁的罪业。唯独我，很愿意世尊，立刻广大的说出地藏菩萨，在修因的地位，究竟做了怎样行为、立了怎样誓愿？而能够成就这样想不到、说不出的事情呀！&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;上节佛说过，这许多集会的大众，都是地藏菩萨所化成的。但是文殊具大智慧的，所以表明他自己很相信了，但是还有小乘小机的大众，不免要生出疑心来谤毁，所以文殊作启请正宗，要佛说出菩萨因地行愿的详情。来代表大众发问，良好的机位到了，顺便作释疑的利益，使得一般小果声闻、小机八部，都免去疑心谤毁，都成就正信顶受，岂不是自利利他的好方法么！也可以照应到上文的伏笔。小果声闻，他们是向来修小果闻小法的，还没有闻过大囧琺，要他怎样会知道不可思议的事情呢？&lt;/p&gt;

  &lt;p&gt;天龙八部，天龙是别名，八部是总称，现在我将他分开来说：第一是天上的人；第二是龙；第三是夜叉，就是在虚空中会飞行的鬼；第四是乾闼婆，是在玉帝那里管音乐的神道；第五是阿修罗；第六是迦楼罗，就是很大的金翅鸟，他两个翅膀，在两边隔开有三百三十六万里，专吃龙的；第七是紧那罗，像人一样，不过他头上生角的，也在玉帝那里管音乐；第八是摩侯罗迦，就是大蟒，也叫他地龙的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;佛告文殊师利：譬如三千大千世界，所有草木丛林，稻麻竹苇，山石微尘，一物一数，作一恒河，一恒河沙，一沙一界，一界之内，一尘一劫，一劫之内，所积尘数，尽充为劫，地藏菩萨证十地果位已来，千倍多于上喻。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛又告诉文殊师利说：譬如有三千的大千世界里，所有的草木丛林、稻麻竹苇、山石微尘，每一物、每一数目，都作一条恒河论；一恒河的沙，每一颗沙作一大千世界论；一大千世界内的一微尘，作一劫数论；每一劫所积微尘的数目，都来再充作劫数；地藏菩萨证得十地的果位已来，千倍多于上面所说的数目。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;佛欲说明地藏的因地原由，来回答文殊的请问，还可以消除将来大众的疑谤，所以详细譬喻给大众听。&lt;/p&gt;

  &lt;p&gt;什么叫三千大千世界呢？一千个的须弥日月世界，名小千世界；一千个的小千世界，名叫中千世界；一千个的中千世界，名叫大千世界，因里面有三种千数的名目，所以叫三千大千世界。这三千大千数目的地面，广大得了不得，这地上所有的各种物类，也多得没有数目的，那里还说得尽呢？只好很简单的说几种，就拿草木二种来说，你看遍地遍处都是，已经是说不尽，也不要去说许多树木结成的丛林了。其余稻麻竹苇、山石微尘，都有一样的多。现在将这许多的物，每一种物，每一个数目，来当作一条恒河，这恒河的数目已经数不尽了；再把每一条恒河里面的每一颗沙，当作一个大千世界；每一个大千世界里的一粒微尘，当作每一次的劫数；再把一次一次的大劫时间，所积聚的微尘的数目，都把他来充作劫数；地藏菩萨证得十地菩萨的果位已来，所经劫数，比上面所说的数目还要多一千倍哩！&lt;/p&gt;

  &lt;p&gt;因如来有智慧的见力，观看久远过去的事迹，同眼前一样，所以有这样明白的譬如。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;何况地藏菩萨在声闻、辟支佛地。文殊师利，此菩萨威神誓愿不可思议。若未来世，有善男子善女人闻是菩萨名字，或赞叹，或瞻礼，或称名，或供养，乃至彩画刻镂塑漆形像，是人当得百返生于三十三天，永不堕恶道。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;何况地藏菩萨，还在小乘声闻、辟支佛的地位修起来的，所以经过的时间，更要加倍的长久了。佛又叫著文殊师利说：这菩萨的威德神道，以及所发的愿力，是想不到、说不出的宏大，倘若未来的世界，有善的男子、善的女人，一听到这菩萨的名字，或者称赞叹美他、或者瞻望礼拜他、或者称念他的名号、或者用香、油、灯、幡种种东西去供养他，乃至于请丹青、用彩色去画他的形像，请会刻镂的人，去刻镂出他的形像，请会塑漆的人，去塑漆他的形像，这样子的人，应当得著生到三十三天上去受福报，而且可以生到一百次的循环往返，在往返的期内，永不堕到地狱等的三恶道里去。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;佛前面譬如给文殊以及大众听了，他的意思还没有完，所以还要说地藏菩萨没有证得十地位的以前，自从人天小乘果位修起来的一句话，叫你们都可以知道他的因地，要加倍的比别人家久远了。&lt;/p&gt;

  &lt;p&gt;声闻是听了佛说法的声音得道的，是小乘的果；修这种果，最聪敏的人也要修三世，愚钝的人，要修到六十劫，方才可以得到的。&lt;/p&gt;

  &lt;p&gt;辟支佛，梵文叫辟支迦罗，我们叫缘觉，他修道常常居在水边林岩的下面，或者独宿在孤峰的上面；春天观看百花的开放，秋日观看黄叶的凋落，将外缘的境界，收归自己的观觉里来，所以叫做缘觉。修这种缘觉，聪敏的人也要修四世，愚钝的人要修到一百劫，方才可以证到。&lt;/p&gt;

  &lt;p&gt;地藏菩萨，有威德、有神通，所以能叫一切外道畏惧折伏，还发宏誓，拔尽六道众生的苦楚，愿令一切众生先成佛道。这都是他久远劫来，积累的功德，他的力量，所以出人思议的表。因此能使未来世人对于他的福田，稍些种一下子，便有伟大福报的收成。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;文殊师利，是地藏菩萨摩诃萨于过去久远不可说不可说劫前，身为大长者子。时世有佛，号曰师子奋迅具足万行如来。时长者子见佛相好，千福庄严。因问彼佛，作何行愿，而得此相。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛又叫著文殊师利说：这地藏菩萨摩诃萨，在于已经过去久远得不可以说尽、不可以说尽的劫数以前，他的身曾经做了大长者子，这个时候的世上有一尊佛，名叫狮子奋迅具足万行如来。这时候长者子见了这尊佛的相好，是一千种福业所庄严的，因此就去问这尊佛：是做了怎样的行为、立了怎样的大愿，能够得到这种好相？&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;上面佛曾说，地藏菩萨是从小乘修起来的，但是为甚么要发起修行的心来呢？所以又叫著文殊，说出他做凡人的时间发心修行的一节原由来。不但答尽了文殊问的妙意，而且完全可叫大众消灭疑谤。&lt;/p&gt;

  &lt;p&gt;大长者子要有十种的福德：一要姓贵；（须生在皇帝大官的宗族里。）二要位高；（像宰相等一样的大官。）三要大富；（有几千几百万的家财。）四要威猛；（生得严重威肃的模样。）五要智深；（生得聪明还有很深的学识。）六要年耆；（年纪既然高了，他人又都肯佩伏他。）七要行净；（品行高洁，没有一些龌龊举动。）八要礼备；（礼貌很完全，可以给人家做模范。）九要上叹；（使得皇帝也来称赞他。）十要下归。（四海的平民，都喜欢来归顺他。）有这十种福德，方才名义相符了。长者是有德的老年人通称；子是称他作君子，也如孔子老子一样。&lt;/p&gt;

  &lt;p&gt;狮子奋迅万行具足如来，是借狮子来比喻，狮子是百兽的王，比喻佛法是修万行法中的王；奋是发怒振作，迅是进行很快，是比喻修万行具足的人，只要有奋发的慧力，那昏瘴自然消灭的，只要有进行很快的定力，至理自然不会间隔的了。&lt;/p&gt;

  &lt;p&gt;如来也是通称。看过去有分别的叫做相；越看越爱的叫做好。佛的相是随了机缘而应现的，或现三十二种相、八十种好，或现无量的庄严、无边的相好，都从外境映入心里，现出来的，所以大小好坏也不一定。现在长者子所见的佛相，是佛修得的好相，（因菩萨修十善业，每一种业，有十种心，这样拼合起来，成会一百种福，由一百种福，再互相映照起来，就变成一千种福了。）所以没有一种相不好的、没有一种不使得人爱的，长者子也知道这相，是佛修成的，所以他便请问佛：是做了怎样行愿，而能够修到这种很好看的妙相？&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;时师子奋迅具足万行如来告长者子：欲证此身，当须久远度脱一切受苦众生。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时候，师子奋迅具足万行如来，告诉长者子说：你要证得这种身体，应当要久远的度脱一切受苦的众生。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;长者子既然去请问了他，师子奋迅具足万行如来，自然也要很明白的去回答告诉长者子说：你要希望像我一样的许多好相么？那你应当永远行菩萨的道行，来度脱六道里一切受苦的众生，方才可以得到像我一样的身体，生得有一千种福业所庄严的相好哩！因为众生没有一个不受苦的，最可怜的受了许多苦，他还同做梦一般的不觉得，所以如来叫他，要引度超脱他们。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;文殊师利，时长者子因发愿言：我今尽未来际，不可计劫，为是罪苦六道众生，广设方便，尽令解脱，而我自身方成佛道。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛又叫著文殊说：这时长者子，因听到如来告诉他这种的话，他立刻就发起誓愿来说：我自今天起，尽我未来的时日，不可以计算的许多劫数，为这一般犯罪受苦的六道众生，很广大的设立种种的方便计策，统统要叫他们解脱了罪业苦恼，而后把我的自身，方才再来成佛。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;长者子听了上面师子奋迅如来的话，就立刻先发起誓愿来。因为誓愿是修行的先导，无论你修那一种，不发愿是修不成功的，所以长者子就发誓愿，先行菩萨道，来度尽六道（六道上面已注过）众生的罪苦。我们是人道，就来谈一谈人道的苦恼罢！&lt;/p&gt;

  &lt;p&gt;我们住在娑婆世界的人，种种的苦是说不尽的，现在先将八种苦来说一回，因为这八种苦是很公平的，无论你富贵贫贱，都逃不过，都要受的。&lt;/p&gt;

  &lt;p&gt;第一种叫生苦，一个人盘在娘的肚子里，气闷得了不得，若娘吃了东西下去，像山压下去一样重的难受，等到生出来的时候，就像二座山把他夹住，他硬在山缝里钻出，这痛苦更利害了，所以小孩一下地就哭，也就是这个缘故。&lt;/p&gt;

  &lt;p&gt;第二种叫老苦，要瞧东西眼已花了、要听说话耳也聋了、要吃果饼牙齿脱落了，多走腿又酸、多坐背要痛，格外怕冷、也格外怕热，你想苦不苦呢？&lt;/p&gt;

  &lt;p&gt;第三种叫病苦，一个人一生了病痛，那是更苦了，要吃吃不下、要睡睡不著，难过得求生不得、求死不得，疼痛得叫天不应、叫地不应，人家代也代不来的，这种种痛苦，正是难以形容的哟！&lt;/p&gt;

  &lt;p&gt;第四种叫死苦，临死的苦，更利害了，要说话舌根硬了、痰也涌塞了，要透气，气管闭了，浑身上下，四肢百节，处处硬生生的拆开来，俗话说，死如黄牛活搏，你想这痛苦说得出么？&lt;/p&gt;

  &lt;p&gt;第五种叫爱别离苦，就是很可亲爱的父母兄弟、妻儿子女、要好的亲戚朋友，或为了谋衣食、或为了刀兵水火等各种恶环境的逼迫，不得不各走各的路；像要死的时候，眼瞪瞪的瞧著亲爱的人、可爱的各种东西，一一分别，所以死时都要流泪，就可以看出他心里的悲苦了。&lt;/p&gt;

  &lt;p&gt;第六种叫怨憎会苦，大凡一个人总有不知己的人，或是有仇怨的人，不要他碰见，他偏会和你碰见；譬如强盗，是人人憎恶他的，有时也会碰到他，不损失金钱，就伤你性命，这是常有的事。&lt;/p&gt;

  &lt;p&gt;第七种叫求不得苦，就是要东不得东、要西不得西，譬如我要想好的物件、我要事情成功、我要交几个好朋友，偏偏都没有，也都做不到，弄出种种不称心的烦恼来。&lt;/p&gt;

  &lt;p&gt;第八种叫五阴盛炽苦，五阴：第一叫色，是把种种看得见的东西，都包括在内；第二叫受，就是所受的各种苦乐的境界；第三叫想，就是心里乱起的好坏的杂念；第四叫行，就是说心里杂乱的念头，一个才去，一个又来，接连没有停息的；第五叫识，就是分别各种东西、各种境界的好坏的心意；这五阴，把人的本来灵性，都遮盖住了，就叫人糊里糊涂、不知不觉的生出贪嗔痴三种坏心来；五阴盛炽，是说五阴像火势一样烧得猛烈，现在再把贪嗔痴三种坏心，转到五阴上去，像把干柴投进烈火里去一样，自然烈烈烘烘烧得更利害了，就会造出种种恶业来。&lt;/p&gt;

  &lt;p&gt;要晓得上面的七种苦，就是都从著末一种造出来的，若是第八种苦不除去，下一世还要就前面的七种苦报，再下一世，也是一样的，所以这八种苦，是循环的报应。我们人道居第二，已经苦得了不得了，再下去地狱、饿鬼、畜生道的苦，自然更是说不尽了，佛所以叫菩萨，来度脱这一般受苦的众生。现在我们要解脱这种种苦，也许就在这一部经内，寻一条极便当的出路，方才可以永世不受这种种苦恼。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;以是于彼佛前立斯大愿，于今百千万亿那由他不可说劫尚为菩萨。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;所以在于这尊佛的前面，立下了这个大愿，到如今已有百千万亿那由他不可说的劫数，尚不肯成佛，偏要做普度众生的菩萨哩！那由他数是几千万。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;这一节，上面两句，是结束前面的立愿，下两句是实行所立的誓愿。地藏菩萨，在沙尘比喻劫数的以前，在师子佛前，立下这个度生的大愿，一直到现在，他要度脱众生的道心，一些也不退转，同起初一样的。他的不愿成佛，仍旧努力做菩萨，也是承顺佛的教训，承顺是不逆，就是孝顺；菩萨从先前修到现在，世世双亲，都得著超升的利益，那地藏大士，也真是无可比方的大孝子了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;又于过去不可思议阿僧祇劫，时世有佛，号曰觉华定自在王如来。彼佛寿命四百千万亿阿僧祇劫。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;又于过去无量无数的劫以前，这时世上有一尊佛，佛的名号叫觉华定自在王如来，这佛寿命的长，四百万亿无量无数的劫。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;梵文阿僧祇劫，我们叫无量数；这数的大，非我们凡夫所想得出、算得出的，叫做不可思议。觉悟时心境朗开，如华开敷，故称觉华；定能生慧，慧即觉果，故定名觉华；既得觉果，于法自在，自在即王，故称自在王；如来是各尊佛的通称，像我们称先生一样的。&lt;/p&gt;

  &lt;p&gt;佛的寿命为什么有这样长呢？因为佛有三种身体，一叫法身，是佛把真实平等的性，来做他本体；二叫报身，是佛修种种功德，修得长、积得多了，就现出极庄严好相的身体来；三叫应身，这应身是凡人修道感应了佛所化的，所以多得像天上的月光印水一样，只要地下有水，月光就为印入的。现在把佛的三种的身体寿命，都合起来，你想这寿命的长还可以计算么！但是你们也不要弄错了，当做佛真个有三个身体，其实佛仍旧只有一个法身，其余二种是修功积德，自在得来的报应呀！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;像法之中，有一婆罗门女，宿福深厚，众所钦敬，行住坐卧，诸天卫护。其母信邪，常轻三宝。是时圣女广设方便，劝诱其母，令生正见。而此女母，未全生信。不久命终。魂神堕在无间地狱。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;在那位佛的像法时代中间，有一位婆罗门种族的女子，因前世的宿福，积得很深厚，所以大众都很钦佩、很敬重他。他行住坐卧的时候，也有各天的天神来保卫护持他的。但是他的母亲，相信了邪道，看轻佛法僧三宝的，是在这时候，圣女广大的说出方便法门，来劝他的母亲，叫他发生正真的见识，来信佛法。然而这位女子的母亲，还不能够生出完全相信的心来。但是没有多久，他的母亲命终了，他的魂神也就堕落在无间地狱里。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;像法，是佛的法运，不同正法时代的一样真确，不过还算像个样子；这等时间，佛早已入涅槃，但有佛像住世，所以叫像法。婆罗门是劫初梵天降下来的种族，犹如我国的道教。这个女子是精勤修行而寡欲的处女，前世也很欢喜行善事，积德很深，所以今世也生性很宽厚，人家都会钦佩他；而且他心术也是极端正，所以行住坐卧，没有不端正而威严的。他还能孝顺父母、敬重三宝，自然感应诸天鬼神来保障、来护持他；有这种种端正行为，自然可称做圣女，众人那会不来恭敬他呢！因为他很孝敬，所以见他的母亲相信邪教、看轻三宝的罪，是很重的，他就来想各种的方便法子，和顺的、慢慢的来奉劝他的母亲，来相信佛法的正道；但是他母亲外貌是像相信了，心里仍旧没有相信，这就是不完全相信，所以死了还是要堕落到地狱里去。地狱是在地下受苦的地方，犹如牢狱，在这地狱受苦，常时不休息的，叫做无间。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;时婆罗门女，知母在世，不信因果，计当随业，必生恶趣。遂卖家宅，广求香华，及诸供具。于先佛塔寺，大兴供养。见觉华定自在王如来，其形像在一寺中，塑画威容，端严毕备。时婆罗门女瞻礼尊容，倍生敬仰。私自念言：佛名大觉，具一切智，若在世时，我母死后，傥来问佛，必知处所。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;自从他母亲死过以后，在这时，婆罗门女知道他母亲活在世上的时候，是不信因果的，若应当随他所造的罪业去计算，那么我的母亲必定要生到三恶道里面，去尝恶趣味了。但是婆罗门女是一位孝女，岂有母亲堕到恶道里去，有不去救的道理么？所以他就想出救他母亲的好方法来了。遂把他家里所有的东西，以及屋宅田产都卖去了，把卖下来的钱，再去很广遍的搜求购买许多好的香、好的花，以及种种供养佛的器具，亲自拿了这一类东西，到各处先前人所造的佛像、宝塔、寺塔里，大兴起供养佛的善事来。有一天，见一尊觉华定自在王如来，他的形像在一个寺院里，无论是塑的、是画的，都是有威德的容貌，端正庄严，没有一种不齐备的。这时婆罗门女见到了，就去瞻望礼拜这尊佛的容貌，加倍的生出一种恭敬信仰的心来。他自己私下默默的想念著，在心内说：佛的名号叫做大觉，具足一切的智慧，倘若这尊佛还活在世上，我母虽然已经死过了，倘若来问这尊佛，他一定会知道我母亲神魂所在的地方。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;凡是一个人死去到幽冥界里，善恶都是根据活在世上所做事情所定的。谤毁三宝、不信因果的罪，是很重大的，所以孝女计算他母亲一定要堕入三恶道里去。家业屋宅等，都是他父母的遗产；但是置产业，即是作罪业的根源，因为悭贪心不盛，产业就置不成了，邪见也发不起了；现在孝女把他统统卖了，就是消灭他父母罪业的根源；再把卖去的钱，买种种供养具，也就是代他父母将功赎罪的一个好方法。香有潜通法界的能力；华表示以因克果的意义；所以这两种是供佛最要紧的。佛有三十二种好相，这觉华定王如来都齐全的，所以孝女一见就很感动，凭著一片孝心，至诚专意的瞻礼他。瞻是目不动睛的望著佛祈祷；礼是五体投地的膜拜；现在孝女瞻了又拜、拜了又瞻，加倍恭敬，还不动唇舌的私心默念，要求佛指示他母亲的下落。敬念的孝心既然长久了，感动也到了极巅，自然要流出悲哀的泪来了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;时婆罗门女垂泣良久，瞻恋如来。忽闻空中声曰：泣者圣女，勿至悲哀，我今示汝母之去处。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时候婆罗门女垂下头泣得很长久，心里还不住的祈祷、瞻望、依恋这尊如来，一定要求这尊如来指示他母亲所在的地方，忽然闻得空中凭空的发出说话的声音来说：悲泣的圣女呀！勿要过于悲哀了，我现今指示你母亲所在的去处吧！&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;孝女既然有这样长久恳切的情态，自然能使感应交道，动佛的慈悲，来指示他。泣是无声流泪。因眼瞻佛容、意恋如来，在这种长久的沉静中，所以能闻到佛来安慰他、指示他的说话；也就是倾家兴大供养、行孝道，感召的报应。圣女，是称他是正直贤德的女子。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;婆罗门女合掌向空，而白空曰：是何神德，宽我忧虑。我自失母已来，昼夜忆恋，无处可问知母生界。时空中有声，再报女曰：我是汝所瞻礼者，过去觉华定自在王如来，见汝忆母倍于常情众生之分，故来告示。婆罗门女闻此声已，举身自扑，支节皆损，左右扶侍，良久方苏。而白空曰：愿佛慈愍，速说我母生界。我今身心将死不久。时觉华定自在王如来告圣女曰：汝供养毕，但早返舍，端坐思惟吾之名号，即当知母所生去处。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;婆罗门女一听到这话，立时合掌向著空中，而且望空的说：这是何处来的神灵？有这样的大恩德，来宽慰我忧愁的思虑，我自从失了母亲以来，无论昼夜，终是忆记著、眷恋著我的母亲，但是无处可以去问，知道我母亲现在所生的境界。这时候，闻得空中又有声，再来告诉圣女说：我就是你所瞻礼，已经过去的觉华定自在王如来。见你忆念你的母亲，加倍的过于平常情性众生的情分，所以来告示你知道。婆罗门女闻了这佛的声音，举了全个的自己的身体，望空扑了过去，这猛力的一扑，把四支的骨节都跌损伤了。经了他左右的侍女扶持起来，已是昏晕过去，又经过了许多时候，方才苏醒转来，而且还要向空中祈祷说：愿佛发慈悲怜愍我，从速说出我母亲现在所生的境界，因为我现在身体和心，离将死已经不长久了。这时，觉华定自在王如来又告诉圣女说：你供养的事做罢，但要早些回返到家里，端正的坐定，思念我的名号，即当使你知道你母亲现在所生的去处。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;孝女本来是很记忆他母亲的，并且急于要知道他母亲，生在什么地方、什么道里的心都很切，现在一听得佛的说话，自然不顾身体的扑拜过去了；况且此身本为母亲的遗体，既然死了我的母亲，我这身体还有什么可惜呢？外身既已跌伤了，内心又是这样忧苦，自知不久将要死了；但是死是不要紧的，我母现在究竟生在什么去处？那是一定要知道的，所以忍了疼痛，依旧望空的祈祷，佛来怜愍他，从速的告诉他母亲现在所在的地方。因为他既有这样至诚的孝心，佛自然也可怜他，预备告诉他了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;时婆罗门女寻礼佛已，即归其舍。以忆母故，端坐念觉华定自在王如来。经一日一夜。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时，婆罗门女听了佛的话，赶紧把遍处的佛都瞻礼供养罢了，即刻回到他的家里。因为忆念他母亲的缘故，所以很端正的趺坐好了，专心的念觉华定自在王如来。这样念到经过一日一夜。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;孝女能专心忆念他母亲，自然依佛的教饬，也专心一意去念佛。因他具有这种至诚的专一心，所以能和佛心相契合了。所以须一日一夜的意义，古注说，日是表示孝女觉悟心的光明；夜是表示他母亲不信因果痴迷心的晦暗。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;忽见自身到一海边，其水涌沸，多诸恶兽，尽复铁身，飞走海上，东西驰逐。见诸男子女人百千万数，出没海中。被诸恶兽争取食啖。又见夜叉，其形各异，或多手多眼，多足多头，口牙外出，利刃如剑。驱诸罪人，使近恶兽。复自搏攫，头足相就，其形万类，不敢久视。时婆罗门女以念佛力故，自然无惧。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;正在念佛的时间，忽然瞧见自己的人身，到了一重海的边上。但见这海里的水，像滚汤一样的涌沸著，许多凶恶的兽，都是铁做的身子，飞一般的在海上东赶到西、西赶到东，很快的驰逐。又瞧见许多的男子和女人，有百千万数的多，一时浮出海面来，一时没入海中去，又被这许多凶恶的兽，像争夺一般的，把这些男女取来吃食。还瞧见有许多夜叉，他们的形状各各不同的，有的生了许多手许多眼，许多头许多足，口里的牙齿，都向外露出，锋利得像刀剑一般，驱逐这许多受罪的人，使他们跑近恶兽一边去，好叫兽把他们咬吃；而且自己也用手像捉虫一般，把他们搏攫过来，把攫来的人随便玩弄，或把人的头和足都团在一块儿，或把他拉长来，或把他撕了、折断了抛去。这种种玩弄的状态，是有千万种的样子，孝女也不敢久视。但这时，婆罗门女仗著念佛，得佛力保护的缘故，瞧到这种形状，自然也没有什么恐惧了。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;因孝女一心念佛，念到入定，自然使心地光明，更仗了佛力，所以可见到这种境界。夜叉，是行走很迅疾、举动很敏捷的鬼，又还能飞行空中；但是种类也很多的。搏，是用手击扑；攫，是用爪捉持的样子。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;有一鬼王，名曰无毒，稽首来迎，白圣女曰：善哉菩萨！何缘来此？&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;有一个鬼王名叫做无毒，见了圣女，对他叩了头来迎接他，而且对圣女说：善哉菩萨，为什么缘故会到此地来？&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;凡是有福德的，方才可以称王。这鬼王有什么福德呢？因这个鬼，存心肯怜愍人，不肯毒害人的，所以称王，也就叫他做无毒。但是这无毒鬼王，也是菩萨所化的，不是那有这种怜愍人的慈心呢？稽首，是把首叩到地上一刻儿。善哉，是欢喜的称赞。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;时婆罗门女问鬼王曰：此是何处？无毒答曰：此是大铁围山西面第一重海。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;这时婆罗门女，就问这鬼王说：这是什么地方？无毒回答说：这里就是大铁围山的西面第一重海。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;我们的碱水海外面，有一座山，就是大铁围山。这山没入水里有三百十二由旬，出水外也有三百十二由旬，山的四边都是水，这周回的水，有三十六亿八千四百七十五由旬，第一重海，就在这中间。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;圣女问曰：我闻铁围之内，地狱在中，是事实不？无毒答曰：实有地狱。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;圣女又问他说：我听说铁围山的里面，有地狱在这中间，这是实在的事情么？无毒回答说：实在有地狱的。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;实有地狱，这意义是地狱本来是虚设的，因为世间上的众生，身做恶事、口出恶言、意起恶念，又喜烹杀来祀鬼神，因为积成种种的恶，造成实在的地狱了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;圣女问鬼王曰：我今云何得到狱所？无毒答曰：若非威神，即须业力，非此二事，终不能到。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;圣女又问鬼王说：我现今为什么得到这地狱的地方来？无毒回答说：倘若不是有威德神通的人，也即须要有业力的人，不是有这二种事的人，终不能到这地方的。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;圣女自己想，我是敬信佛法的人，一身没有罪业，为什么也会到地狱里来呢？所以起了疑心来问鬼王。有威德神通的人，方才可以到地狱中来，或是救度人、或是来游观；犯了身口意三恶业的人，因临终时受了业力的牵缠，到这地狱里来受苦报的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;圣女又问：此水何缘，而乃涌沸，多诸罪人及以恶兽？无毒答曰：此是阎浮提造恶众生新死之者，经四十九日后，无人继嗣，为作功德，救拔苦难。生时又无善因。当据本业所感地狱，自然先渡此海。海东十万由旬，又有一海，其苦倍此。彼海之东，又有一海，其苦复倍。三业恶因之所招感，共号业海，其处是也。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;圣女又问鬼王说：这海水是为什么缘故而会涌沸的？又为什么有这许多的罪人，以及各种恶兽？无毒回答说：这都是我们的阎浮提世界，造恶作业的众生，是新死的人，经过四十九日以后，没有人继嗣，给他做功德，替他救拔应受的苦难；活的时候又没有乐善好施的因缘。应根据他在世本来所造的恶业，去受他自己所感召的地狱，自然一定要先度过这一重海；这海的东面过去十万由旬，又有一重海，他的苦楚还要比这重海加一倍；这重海的东面，还有一重海，他的苦楚又要加一倍；这三重海，都是众生三业恶因所感召成的，总共的名号，就叫业海，这地方就是。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;阎浮提，一株大树的王，周围有七由旬，高百由旬，四布的枝叶有五十由旬。我们的世界叫南赡部洲，也依这大树王立名的。凡是人死了每七日一变化，阎王定罪，虽是照活时的恶业据定，但是也要过七七日方才判实；若这七七日内，有承继的孝顺子孙，每一七替他念佛拜忏，将功补过，自然把他应受的苦难，都救拔了；若七七日内，无人承继去替他救拔，自然要受苦受难了。但是受这利害的苦难，也都是自己三业恶因所感召的。现在我把这三业恶因来说一说，使得诸君都可以改恶向善。&lt;/p&gt;

  &lt;p&gt;一是身业，身所做的恶事有三种：第一是杀生，无论最小的蚊子跳虱，也不能去弄杀他；第二是偷盗，就是人家的一梗草，你没有问人家讨过，也不可以拿的；第三是邪淫，除了正式妻妾以外，其他都不可犯的。&lt;/p&gt;

  &lt;p&gt;二是口业，口所犯的恶业有四种：一是妄语，就是说谎；二是绮语，就是谈妇女的秽亵；三是两舌，就是搬弄是非；四是恶口，就是咒骂。&lt;/p&gt;

  &lt;p&gt;第三是意业，意所犯的恶业也有三种：一是贪欲，就是贪得而不肯知足的欲望；二是嗔恚，就是怒目发火；三是愚痴，就是不信佛法，去信邪说。由这身口意三业，做出了十种恶因，再由这三业恶因，去感召成三重倍加苦的业海，以及种种的地狱，叫作恶的人，去自作自受。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;圣女又问鬼王无毒曰：地狱何在？无毒答曰：三海之内，是大地狱，其数百千，各各差别。所谓大者具有十八，次有五百，苦毒无量。次有千百，亦无量苦。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;圣女又问无毒鬼王说：你说铁围山里实有地狱的，那么现在地狱在什么地方呢？无毒回答说：三海的里面，都是大地狱，他的数目几百几千的多，这几千几百的地狱，都不相同，每一个地狱有各式各样的差别。所说大的具有十八重，次一等的有五百重，他里面所受的毒痛的苦难，和施刑狠毒，是说不尽的；再次一等的，还有千百重的小地狱，也有说不尽的痛苦。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;据经论上说，地狱可以分三类把他都收摄尽了：一是热狱；二是寒狱；三是边狱。热狱有八重，在我们阎浮海的底下重叠而居的；寒狱也有八重，在铁围山的底下，仰上居住的；边狱分山间、水间、旷野三处居住的。&lt;/p&gt;

  &lt;p&gt;十八大地狱，分八热、八寒、一正、一边，照十八泥犁经上说，第一重名光就居，他的人和人一相见，大家就互相斗杀，虽然杀伤了，也不肯死的，人又生得很长大，人间三千七百五十岁，他只有一日；（三十日为一月，十二月为一年，经过一万岁，就是人间的一百三十五亿岁。以下十七重地狱的苦，和岁数的长，倍倍加增。）第二重狱名居虚倅略，这里的一种苦，已经要当一重的二十种苦了；第三重狱，名桑居都；第四重狱，名楼；第五重狱，名房卒；第六重狱，名草鸟卑次；第七重狱，名都卢难但；第八重狱，名不卢半呼；第九重狱，名乌竟都，是寒冷冻身的；第十重狱，名泥卢都；第十一重狱，名乌略；第十二重狱，名乌满；第十三重狱，名乌藉；第十四重狱，名乌呼；第十五重狱，名须健居；第十六重狱，名末都干直呼；第十七重狱，名区逋途；第十八重狱，名陈莫。这十八重狱中，每一重分别作十八隔，从寒冰狱，到饮铜狱止，总共三百四十二隔，鬼王所说千百是总约的统计。&lt;/p&gt;

  &lt;p&gt;总之地狱都是人的恶业所感召的，人有了无穷无尽各式各样的罪恶，由自然的感召，也造成无穷无尽、各式各样的地狱了。受地狱的苦难、大小、重轻，也依他在世时，所作的恶业大小、重轻而定的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;圣女又问大鬼王曰：我母死来未久，不知魂神当至何趣？鬼王问圣女曰：菩萨之母在生习何行业？圣女答曰：我母邪见，讥毁三宝，设或暂信，旋又不敬。死虽日浅，未知生处。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;圣女又问大鬼王说：我的母死了到这里来，还没有许久，不知道他魂神应到何种恶趣里去受苦？鬼王就问圣女说：菩萨的母亲生在世间时，习何种行业的？圣女回答道：我的母亲信邪见的，并且讥诮谤毁佛、法、僧三宝，设或暂时相信佛教，旋又不相信了，现在虽是死得不多日子，也已经不知道他所在的地方了？&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;圣女既知道地狱在此处，但是仍旧见不到他母亲，所以又要问鬼王了。魂是气的神，人死了，他一个不死的神魂，就是鬼。行是叫做进趣；业是人所造的善恶。造何种善，得何种善报；造何种恶，得何种恶报；报应分明，丝毫不差的。所以鬼王先要问明白了他母亲的行业，以便查寻。三宝，佛相端严俱备为佛宝；三乘圣教为法宝；出家修持为僧宝。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;无毒问曰：菩萨之母，姓氏何等？圣女答曰：我父我母俱婆罗门种。父号尸罗善现，母号悦帝利。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;无毒又问圣女说：菩萨的母亲姓氏，以及何种等级？圣女回答说：我的父亲和我的母亲都是婆罗门的种族，父亲号叫尸罗善现，母亲号叫悦帝利。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;三代以前，姓氏分为二种的，用姓称妇人，以表其婚姻；用氏以分别贵贱，贵的有氏，贱的只有名没有氏。印土有刹帝利（五种）、婆罗门（净行）、吠奢（商贾）、戌陀罗（众庶）四姓。尸罗是梵语，我们叫性善，是说好行善道；善现是我们的华语。这名氏虽然好，但是存心不好，都是邪执谤正的。鬼王问清了行业，再问姓氏种族，那自然更容易查明白了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;无毒合掌启菩萨曰：愿圣者却返本处，无至忧忆悲恋。悦帝利罪女生天以来，经今三日。云承孝顺之子，为母设供修福，布施觉华定自在王如来塔寺。非唯菩萨之母得脱地狱，应是无间罪人，此日悉得受乐，俱同生讫。鬼王言毕，合掌而退。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;无毒合著掌，报告菩萨说：愿圣者回返到本来的地方去，不要过于忧愁记忆你的母亲，也不必过于怨哀恋念你的母亲。你的母亲悦帝利罪女，脱离地狱，生到天上去以来，已经至今有三天了。天上下示，说是承孝顺的子女，为他母亲设供修福，布施觉华定自在王如来塔寺的功德。不但菩萨的母亲得脱地狱，应该在这无间地狱受苦的罪人，这一日都得受著快乐，俱同他生讫完了。鬼王说罢，合著掌退去了。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;鬼王起先不知道是什么人，一听是悦帝利罪女，那就知道这位是大孝女，所以要合掌恭敬起来。因孝女有这样的大孝心，自然感动了佛，也自然感动天了，所以天下诏示，叫他的母亲上天去，连同地狱的罪人都上天去。你想孝的功德弘大不弘大呢？因此古人要说，百行孝为先了。凡是孝，第一要随顺父母的心意，还要好好服侍他，使父母心中快乐。现在孝女起首，劝母信正道；中间，忆母为兴供养布施；末了，救母出苦上天；像这样的大孝顺，是从古未有的呀！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;婆罗门女寻如梦归。悟此事已，便于觉华定自在王如来塔像之前，立弘誓愿：愿我尽未来劫，应有罪苦众生广设方便，使令解脱。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;婆罗门女，俄而如做梦一般的归来了。觉悟了这事情后，便于觉华定自在王如来塔像的前面，立了弘大的誓愿说：愿我尽未来的劫数，为应有罪恶苦果的众生，广遍的设立便利方法，使令他们都能解脱应受的苦趣。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;寻是俄顷。因孝女本来在家里端坐念佛入定的，俄顷像做梦醒了一般，便悟到因果报应、业海地狱的种种事情，所以顿时便发起道心来。再到觉华定自在王如来塔像的前面，立下弘誓大愿，情愿尽未来劫，设方便法门，救尽一切受苦众生，在后再来成佛，以报觉华定自在王如来救度他母亲，脱苦上天的大恩德。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;【&lt;strong&gt;佛告文殊师利：时鬼王无毒者，当今财首菩萨是。婆罗门女者，即地藏菩萨是。&lt;/strong&gt;】&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解：&lt;/strong&gt;佛告诉文殊师利说：这时候的鬼王无毒，就是现在的财首菩萨；这时候的婆罗门女呢！就是现在的地藏菩萨。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;从前因文殊师利请问地藏菩萨的因地，所以释迦牟尼佛，就说这一段地藏菩萨未成道以前，行孝的事实来，使一切众生，知道广行孝道的功德，及种种行孝道的方法。地是万物所依据的，孝是无论贵贱万民所依此受用的，能行孝道，譬如能藏财宝一样，他的福德取用无尽的。可知道地藏二字，也是依孝顺立名的。财首名义，财是人所宝贵的；首是万行以布施为首。有了财方才可以布施，比喻广行孝道，如积财宝；广度众生，如大布施。&lt;/p&gt;
&lt;/blockquote&gt;

</description>
        <pubDate>Sun, 08 Oct 2023 00:00:00 +0545</pubDate>
        <link>http://localhost:4000/2023/10/08/%E5%9C%B0%E8%97%8F%E8%8F%A9%E8%90%A8%E6%9C%AC%E6%84%BF%E7%BB%8F%E7%99%BD%E8%AF%9D%E8%A7%A3%E9%87%8A1/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/10/08/%E5%9C%B0%E8%97%8F%E8%8F%A9%E8%90%A8%E6%9C%AC%E6%84%BF%E7%BB%8F%E7%99%BD%E8%AF%9D%E8%A7%A3%E9%87%8A1/</guid>
        
        <category>佛学研究</category>
        
        <category>地藏菩萨本愿经</category>
        
        <category>孝道</category>
        
        
      </item>
    
      <item>
        <title>Black-Scholes-Merton期权定价公式推导</title>
        <description>&lt;p&gt;十几年前上大学期间，因为机缘巧合结识了期权，对期权的定价无疑充满了金融学和数学的集体智慧，初学时囿于知识所限，只知定价公式，无法从头开始进行推导，后来学习了《Stochastic Calculus for Finance》，对其大致过程有了初步了解，书中对期权定价公式导出的基本思路是基于无风险套利原则在货币市场和股票市场进行复制对冲未来行权风险，涉及具体方法主要分两种方法（i）导出BSM偏微分方程，然后直接求解析解（p153-159），比较可惜的是，导出偏微分方程后，未给出方程求解过程而是一笔带过直接给出了解析解，让人意犹未尽，（ii）借助风险中性测度进行推导（p210-220），相比于求解偏微分方程所涉及的技巧，该种方法相对简单直观。&lt;/p&gt;

&lt;p&gt;本文主要针对方法（i），先后参考了《期权定价的数学模型和方法》（第二版）第五章，给出了BSM偏微分方程的求解过程，但美中不足是对热传导方程基本解一笔带过，少了傅里叶变换求解过程（p81）。于是又参考了《数学物理方程》（第二版）季孝达等编第四章（p137-138）对热传导方程的求解方法，虽然对其中的傅里叶变换还理解不深，但完整的思路算是齐了。以下就将散落在这三本书里的知识汇总在一起，对方法（i）做一个相对完整的注记。&lt;/p&gt;

&lt;h3 id=&quot;一投资组合价值演化&quot;&gt;一、投资组合价值演化&lt;/h3&gt;

&lt;p&gt;假设投资人A在初始时刻仅靠出售欧式看涨期权，获得期权费然后在货币市场和股票市场进行组合投资以对冲未来期权行权风险，即确保该组合价值在行权日等于$(S_T - K)^+$.&lt;/p&gt;

&lt;p&gt;假设投资人A在时刻$t$的投资组合价值为$X_t$，该组合投资于固定利率为$r$的货币市场（比如银行存款等）和股票市场（简化为一只股票$S_t$），该股票由几何布朗运动驱动即：
\(d S_t = \alpha S_t dt + \sigma S_t d W_t \tag{1.1}\)
或
\(\frac{d S_t}{S_t} = \alpha dt + \sigma d W_t \tag{1.2}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;公式$\text{(1.1)}$由正收益项$\alpha S_t dt$和随机波动项$\sigma S_t dW_t$构成。可以理解为瞬时股票收益$\frac{d S_t}{S_t}$隐含一个正的收益项$\alpha dt$，同时包含一个波动项$\sigma d W_t$，两者叠加后的效果就是股票价格围绕一个向上的趋势上下波动。而且由于股票市场风险要高于货币市场，因此满足$\alpha &amp;gt; r$。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;假设在时刻$t$，投资人A持有$\Delta_t$份额的股票，$\Delta_t$可以是随机的(random)，但由布朗运动$W_t, t \geq 0$的的域流（信息流）决定，该投资组合剩余金额$X_t - \Delta_t S_t$ 投资于货币市场。&lt;/p&gt;

&lt;p&gt;该投资组合随时间的变动$d X_t$由两部分构成：&lt;/p&gt;

&lt;p&gt;（i）股票市场资本所得$\Delta_t (S_t + d S_t) - \Delta_t S_t = \Delta_t dS_t$ ,&lt;/p&gt;

&lt;p&gt;（ii）货币市场利息收益$r (X_t - \Delta_t S_t) dt$，&lt;/p&gt;

&lt;p&gt;即：
\(\begin{equation}
\begin{aligned}
d X_t &amp;amp;= \Delta_t dS_t + r (X_t - \Delta_t S_t) dt \\
&amp;amp;= \Delta_t (\alpha S_t dt + \sigma S_t dW_t) + r (X_t - \Delta_t S_t) dt \\
&amp;amp;= r X_t dt + \Delta_t (\alpha - r) S_t dt + \Delta_t \sigma S_t d W_t
\end{aligned}
\tag{1.3}
\end{equation}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;经过整理后，$d X_t$由以下三部分构成：&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;投资组合$X_t$基于利率$r$的隐含固定收益$r X_t dt$；&lt;/li&gt;
    &lt;li&gt;股票市场的风险溢价(risk premium $\alpha - r$)收益$\Delta_t (\alpha - r) S_t dt$；&lt;/li&gt;
    &lt;li&gt;$\Delta_t$份额股票的波动收益$\Delta_t \sigma S_t d W_t$；&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;下面我们考虑下按照连续复利折现后的股价$e^{-rt} S_t$和投资组合价值$e^{-rt} X_t$的微分。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;假设$f(t, x) = e^{-rt}x$，则$f_t(t, x) = -r e^{-rt} x$，$f_x(t, x) = e^{-rt}$，$f_{xx}(t, x) = 0$，&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;根据伊藤公式
\(d f(t, X_t) = f_t(t, X_t) dt + f_x(t, X_t) dX_t + \frac{1}{2} f_{xx}(t, X_t) dX_t dX_t \tag{1.4}\)&lt;/p&gt;

&lt;p&gt;可得：
\(\begin{equation}
\begin{aligned}
d (e^{-rt} S_t) &amp;amp;= d f(t, S_t) \\
&amp;amp;= f_t(t, S_t) dt + f_x(t, S_t) dS_t + \frac{1}{2}f_{xx}(t, S_t) dS_t dS_t \\
&amp;amp;= -r e^{-rt} S_t dt + e^{-rt} dS_t \\
&amp;amp;= -r e^{-rt} S_t dt + e^{-rt} \alpha S_t dt + e^{-rt} \sigma S_t dW_t \\
&amp;amp;= e^{-rt} (\alpha - r) S_t dt + e^{-rt} \sigma S_t dW_t
\end{aligned}
\tag{1.5}
\end{equation}\)&lt;/p&gt;

\[\begin{equation}
\begin{aligned}
d (e^{-rt} X_t) &amp;amp;= d f(t, X_t) \\
&amp;amp;= f_t(t, X_t) dt + f_x(t, X_t) dX_t + \frac{1}{2}f_{xx}(t, X_t) dX_t dX_t \\
&amp;amp;= -r e^{-rt} X_t dt + e^{-rt} dX_t \\
&amp;amp;= \left[-r e^{-rt} X_t dt + e^{-rt} r X_t dt\right] + e^{-rt} \Delta_t (\alpha - r) S_t dt \\
&amp;amp; \quad + e^{-rt} \Delta_t \sigma S_t d W_t \\
&amp;amp;= \Delta_t e^{-rt} (\alpha - r) S_t dt + \Delta_t e^{-rt} \sigma S_t d W_t \\
&amp;amp;= \Delta_t d(e^{-rt} S_t)
\end{aligned}
\tag{1.6}
\end{equation}\]

&lt;p&gt;由于货币市场收益也是按照连续复利进行计算，所以对其进行折现后为初始值常数，不会对折现投资组合价值变动（微分）产生影响，此即公式$\text{(1.5)}$所反映的：折现投资组合价值变动$d (e^{-rt} X_t)$仅取决于折现股票价格变动$d (e^{-rt} S_t)$。&lt;/p&gt;

&lt;h3 id=&quot;二期权价值价格演化&quot;&gt;二、期权价值（价格）演化&lt;/h3&gt;

&lt;p&gt;我们考虑在行权日期$T$支付为$(S_T - K)^+$的欧式看涨期权，假设在时刻$t$其价格由函数$c(t, S_t)$决定，下面我们分别对对$c(t, S_t)$和其折现过程$e^{-rt} c(t, S_t)$求微分：
\(\begin{equation}
\begin{aligned}
d c(t, S_t) &amp;amp;= c_t(t, S_t) dt + c_x(t, S_t) dS_t + \frac{1}{2} c_{xx}(t, S_t) dS_t dS_t \\
&amp;amp;= c_t(t, S_t) dt + c_x(t, S_t) [\alpha S_t dt + \sigma S_t dW_t] \\
&amp;amp; \quad \ + \frac{1}{2} c_{xx}(t, S_t) \sigma^2 S_t^2 dt \\
&amp;amp;= \big[c_t(t, S_t) + \alpha S_t c_x(t, S_t) + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t)\big]dt \\
&amp;amp; \quad \ + \sigma S_t c_x(t, S_t) dW_t
\end{aligned}
\tag{2.1}
\end{equation}\)&lt;/p&gt;

\[\begin{equation}
\begin{aligned}
d e^{-rt} c(t, S_t) &amp;amp;= df\big(t, c(t, S_t)\big) \\
&amp;amp;= f_t\big(t, c(t, S_t)\big) dt \\
&amp;amp; \quad \ + f_x\big(t, c(t, S_t)\big) dc(t, S_t) + \frac{1}{2} f_{xx}\big(t, c(t, S_t)\big) dc(t, S_t) dc(t, S_t) \\
&amp;amp;= -r e^{-rt} c(t, S_t) dt + e^{-rt} d c(t, S_t) \\
&amp;amp;= -r e^{-rt} c(t, S_t) dt \\
&amp;amp; \quad \ + e^{-rt} \left\{ \big[c_t(t, S_t) + \alpha S_t c_x(t, S_t) + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t)\big]dt + \sigma S_t c_x(t, S_t) dW_t \right\} \\
&amp;amp;= e^{-rt} \big[ -rc(t, S_t) + c_t(t, S_t) + \alpha S_t c_x(t, S_t) + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t) \big]dt \\
&amp;amp; \quad \ + e^{-rt} \sigma S_t c_x(t, S_t) dW_t
\end{aligned}
\tag{2.2}
\end{equation}\]

&lt;h3 id=&quot;三投资组合价值与期权价值的等价&quot;&gt;三、投资组合价值与期权价值的等价&lt;/h3&gt;

&lt;p&gt;我们的投资始于在时刻$t=0$时卖出期权（short option）获得$c(0 ,S_0)$，然后投资于货币市场和股票市场形成投资组合$X_0$，满足及时立刻行权也无套利$c(0, S_0) = X_0 = (S_0 - K)^+$，同时为了保证我们的期权买卖交易在任意时刻$t, t \in (0, T]$无套利，还需要满足：&lt;/p&gt;

&lt;p&gt;\(\begin{aligned}
&amp;amp; c(t, S_t) = X_t \\\
&amp;amp; e^{-rt}c(t, S_t) = e^{-rt} X_t
\end{aligned}  \tag{3.1}\)&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;例如我们可以假设存在一个时空穿越者B，其时间总比现实中的投资者A快$t$，也就是他总能提前准确获知未来的信息，但其投资行为也必须满足无套利原则，则他会告诉你上式必须满足，否则市场就会存在套利。比如$c(t, S_t) \geq X_t$，那么投资者B就可以告诉投资者A在时刻$t=0$卖出看涨期权，获得$e^{-rt}c(t, S_t)$，同时抽走$e^{-rt}c(t, S_t) - e^{-rt} X_t$，仅用$\left( e^{-rt}c(t, S_t) - \left[ e^{-rt}c(t, S_t) - e^{-rt} X_t \right]\right) == e^{-rt} X_t = X_0$投资于货币市场和股票市场进行对冲卖出看涨期权的交易行为，即投资者A在时刻$t=0$获得了无风险收益$e^{-rt}c(t, S_t) - e^{-rt} X_t$。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;如满足：
\(d\left(e^{-rt} X_t\right) = d \left(e^{-rt}c(t, S_t)\right) \quad t \in [0, T] \tag{3.2}\)
则上式必然成立。展开公式$\text{(3.2)}$并约减掉两边的$e^{-rt}$得到如下公式：
\(\begin{equation}
\begin{aligned}
&amp;amp; \Delta_t (\alpha - r) S_t dt + \Delta_t \sigma S_t d W_t \\
&amp;amp; = \big[ -rc(t, S_t) + c_t(t, S_t) + \alpha S_t c_x(t, S_t) + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t) \big]dt \\
&amp;amp; \quad \ + \sigma S_t c_x(t, S_t) dW_t
\end{aligned}
\tag{3.3}
\end{equation}\)&lt;/p&gt;

&lt;p&gt;首先令$dW_t$项系数相等，得到德尔塔对冲法则（&lt;strong&gt;&lt;em&gt;delta -hedging rule&lt;/em&gt;&lt;/strong&gt;）：
\(\Delta_t = c_x(t, S_t) \quad t \in [0, T]. \tag{3.4}\)
即在任意时刻$t$，持有股票份额$\Delta_t$等于期权价格对股价的偏导数$c_x(t, S_t)$。&lt;/p&gt;

&lt;p&gt;然后再令$dt$项系数相等，并将公式$\text{(3.4)}$带入其中，得到：
\(\begin{equation}
\begin{aligned}
&amp;amp; c_x(t,S_t) (\alpha - r) S_t = -rc(t, S_t) + c_t(t, S_t) + \alpha S_t c_x(t, S_t) \\
&amp;amp; + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t) \quad t \in [0, T]. 
\end{aligned}
\tag{3.5}
\end{equation}\)&lt;/p&gt;

\[-r c_x(t,S_t) S_t = -rc(t, S_t) + c_t(t, S_t) + \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t) \tag{3.6}\]

\[rc(t, S_t) = c_t(t, S_t) + r S_t c_x(t,S_t) +  \frac{1}{2} \sigma^2 S_t^2 c_{xx}(t, S_t) \\
\quad t \in [0, T]. \tag{3.7}\]

&lt;p&gt;将$S_t$用哑变量$x$代替，便得到了BSM偏微分方程;&lt;/p&gt;

\[\left\{
\begin{aligned}
&amp;amp; rc(t, x)  = c_t(t, x) + r x c_x(t,x) +  \frac{1}{2} \sigma^2 x^2 c_{xx}(t, x) \quad t \in [0, T], x \geq 0.\\\
&amp;amp; c(T, x)  = (x - K)^+.
\end{aligned}  \tag{3.8}
\right.\]

&lt;p&gt;下面我们通过适当变换将公式$\text{(3.8)}$写成常见的热传导方程形式并进行求解：
\(\left\{
\begin{aligned}
&amp;amp; \frac{\partial u}{\partial t} = a^2 \frac{\partial^2 u}{\partial x^2},   \quad t &amp;gt; 0,  -\infty &amp;lt; x &amp;lt; \infty.\\\
&amp;amp; u\vert_{t = 0} = \varphi(x).
\end{aligned}  \tag{3.9}
\right.\)&lt;/p&gt;

&lt;h3 id=&quot;四bsm偏微分方程求解&quot;&gt;四、BSM偏微分方程求解&lt;/h3&gt;

&lt;p&gt;我们先将BSM偏微分方程转换为常见的的热传导方程形式，然后借助傅里叶变换对其进行求解。&lt;/p&gt;

&lt;h4 id=&quot;bsm方程转换&quot;&gt;BSM方程转换&lt;/h4&gt;

&lt;p&gt;为方便起见，将$\text{(3.8)}$作如下替换：$c(t, x)$简写成$V(t,S_t)$，并用偏导数$\frac{\partial V}{\partial S}$形式取代$c_x(t, x)$得到：
\(\left\{
\begin{aligned}
&amp;amp; \frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + r S \frac{\partial V}{\partial S} - r V = 0 \quad 0 \leq S \leq \infty,  0 \leq t \leq T.\\\ 
&amp;amp; V\vert_{t =T} = (S_T - K)^+.
\end{aligned}  \tag{4.1}
\right.\)
对$V(t,S_t)$做如下变量替换
\(\begin{aligned}
&amp;amp; x = \ln S \\
&amp;amp; \tau = T-t
\end{aligned} \tag{4.2}\)
计算$V(\tau, x)$的各阶偏导数如下：
\(\begin{aligned}
&amp;amp; \frac{\partial V}{\partial t} = \frac{\partial V}{\partial \tau} \frac{\partial \tau}{\partial t} = -\frac{\partial V}{\partial \tau} \\
&amp;amp; \frac{\partial V}{\partial S} = \frac{\partial V}{\partial x} \frac{\partial x}{\partial S} = \frac{1}{S} \frac{\partial V}{\partial x} \\
&amp;amp; \frac{\partial^2 V}{\partial S^2} = \frac{\partial \frac{\partial V}{\partial S}}{\partial S} = -\frac{1}{S^2} \frac{\partial V}{\partial x} + \frac{1}{S}  \frac{\partial^2 V}{\partial x^2} \frac{\partial x}{\partial S} = \frac{1}{S^2} \frac{\partial^2 V}{\partial x^2} - \frac{1}{S^2} \frac{\partial V}{\partial x}
\end{aligned} \tag{4.3}\)
将上述公式带入$\text{(4.1)}$得到：
\(\left\{
\begin{aligned}
&amp;amp; \frac{\partial V}{\partial \tau} - \frac{\sigma^2}{2} \frac{\partial^2 V}{\partial x^2} - (r - \frac{\sigma^2}{2}) \frac{\partial V}{\partial x} + r V = 0 \quad 0 \leq S \leq \infty,  0 \leq t \leq T.\\\ 
&amp;amp; V\vert_{\tau = 0} = (e^x - K)^+.
\end{aligned}  \tag{4.4}
\right.\)
然后再做如下函数变化：
\(V(\tau, x) = V = u e^{\alpha \tau + \beta x} = u(\tau, x) e^{\alpha \tau + \beta x} \tag{4.5}\)&lt;/p&gt;

\[\begin{aligned}
&amp;amp; \frac{\partial V}{\partial \tau} = e^{\alpha \tau + \beta x} \frac{\partial u}{\partial \tau} + e^{\alpha \tau + \beta x} \alpha u = e^{\alpha \tau + \beta x} (\frac{\partial u}{\partial \tau} + \alpha u) \\
&amp;amp; \frac{\partial V}{\partial x} = e^{\alpha \tau + \beta x} (\frac{\partial u}{\partial x} + \beta u) \\
&amp;amp; \frac{\partial^2 V}{\partial x^2} = e^{\alpha \tau + \beta x} (\frac{\partial^2 u}{\partial x^2} + 2 \beta \frac{\partial u}{\partial x} +\beta^2 u)
\end{aligned}  \tag{4.6}\]

&lt;p&gt;将以上公式带入$\text{(4.4)}$并消去$e^{\alpha \tau + \beta x}$得到：
\(e^{\alpha \tau + \beta x} \left[ (\frac{\partial u}{\partial \tau} + \alpha u) - \frac{\sigma^2}{2}  (\frac{\partial^2 u}{\partial x^2} + 2 \beta \frac{\partial u}{\partial x} +\beta^2 u) \\ - (r - \frac{\sigma^2}{2}) (\frac{\partial u}{\partial x} + \beta u) + r u \right] = 0 \tag{4.7}\)&lt;/p&gt;

\[\frac{\partial u}{\partial \tau} - \frac{\sigma^2}{2} \frac{\partial^2 u}{\partial x^2} - (\beta \sigma^2 + r - \frac{\sigma^2}{2}) \frac{\partial u}{\partial x} \\
+ \left(r - \beta(r - \frac{\sigma^2}{2}) - \frac{\sigma^2}{2} \beta^2 + \alpha \right) u = 0
\tag{4.8}\]

&lt;p&gt;通过选取适当的$\alpha$和$\beta$的值，消去$\frac{\partial u}{\partial x}$和$u$项，即：
\(\begin{equation}
\begin{aligned}
&amp;amp; (\beta \sigma^2 + r - \frac{\sigma^2}{2}) = 0 \\
&amp;amp; \rightarrow \quad \beta = \frac{1}{2} - \frac{r}{\sigma^2} \\
\\
&amp;amp; \left(r - \beta(r - \frac{\sigma^2}{2}) - \frac{\sigma^2}{2} \beta^2 + \alpha \right) = 0 \\
&amp;amp; \rightarrow \quad \alpha = -r + \beta(r - \frac{\sigma^2}{2}) + \frac{\sigma^2}{2} \beta^2 \\
&amp;amp; \qquad \quad \ = -r - \frac{1}{2 \sigma^2}(r - \frac{\sigma^2}{2})^2
\end{aligned}
\tag{4.9}
\end{equation}\)
则$\text{(4.4)}$变换为$\text{(4.10)}$形式的的常规热传导方程：
\(\left\{
\begin{aligned}
&amp;amp; \frac{\partial u}{\partial \tau} = \frac{\sigma^2}{2} \frac{\partial^2 u}{\partial x^2},   \quad 0 \leq \tau \leq T,  0 &amp;lt; x &amp;lt; \infty.\\\
&amp;amp; u\vert_{\tau = 0} = e ^{-\beta x} V \vert_{\tau = 0} = e ^{-\beta x} (e ^x - K)
 ^+ .
 \end{aligned}  \tag{4.10}
\right.\)
接下来便是求解该方程得到$u(\tau, x)$的解析表达式，然后利用$V(\tau, x) = u(\tau, x) e^{\alpha \tau + \beta x}$求得$V(\tau, x)$。&lt;/p&gt;

&lt;h4 id=&quot;bsm方程求解&quot;&gt;BSM方程求解&lt;/h4&gt;

&lt;p&gt;在偏微分方程（或者叫数学物理方程）理论中，有成熟的傅里叶变换方法可以求解上述热传导方程，为了简化傅里叶变换公式的呈现，我们将边界条件进行简写如下：
\(\begin{equation}
\begin{aligned}
u(\tau, x)\vert_{\tau = 0} &amp;amp;= e ^{-\beta x} V \vert_{\tau = 0} \\
&amp;amp;= e ^{-\beta x} (e ^x - K)^+ \\
&amp;amp;= \varphi(x).
\end{aligned} \tag{4.11}
\end{equation}\)
记$\mathcal{F}$为傅里叶变换算符，$\mathcal{F^\text{-1}}$为傅里叶逆变换算符，$u(\tau, x)$的傅里叶变换为：
\(\widehat{u}(\tau, \lambda) = \mathcal{F}[u(\tau, x)] = \int^{+\infty}_{-\infty} u(\tau, x) e^{-i \lambda x} dx \tag{4.12}\)
对$\text{(4.10)}$方程两边进行傅里叶变换得到&lt;strong&gt;像函数&lt;/strong&gt;$\widehat u(\tau, \lambda)$满足的常微分方程初值问题：
\(\left\{
\begin{aligned}
&amp;amp; \frac{\text{d} \widehat{u}}{\text{d}\tau} = \frac{\sigma^2}{2} (i \lambda)^2 \widehat{u} = -\frac{\sigma^2}{2} \lambda^2 \widehat{u},   \quad 0 \leq \tau \leq T,  0 &amp;lt; x &amp;lt; \infty.\\\
&amp;amp; \widehat{u}\vert_{\tau = 0} = \widehat \varphi(\lambda).
\end{aligned}  \tag{4.13}
\right.\)
上述傅里叶变换将偏微分方程变成关于$\widehat u(\tau, \lambda)$的常微分方程。求解此方程可得像函数：
\(\widehat u(\tau, \lambda) = \widehat \varphi (\lambda) e ^{-\frac{\sigma^2}{2} \lambda^2 \tau} \tag{4.14}\)
对上述像函数进行傅里叶逆变换，并进行卷积运算可得：
\(\begin{equation}
\begin{aligned}
u(\tau, x) &amp;amp;= \mathcal{F^\text{-1}} [\widehat \varphi (\lambda) e^{-\frac{\sigma^2}{2} \lambda^2 \tau}] \\
&amp;amp;= \mathcal{F^\text{-1}} [\widehat \varphi (\lambda)] * \mathcal{F^\text{-1}} [e^{-\frac{\sigma^2}{2} \lambda^2 \tau}]  \\
&amp;amp;= \varphi(x) * \frac{1}{\sigma \sqrt{2 \pi \tau}} \exp(-\frac{x^2}{2 \sigma^2 \tau}) \\
&amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{-\infty} \varphi(\xi) \exp(-\frac{(x-\xi)^2}{2 \sigma^2 \tau}) d\xi
\end{aligned}
\tag{4.15}
\end{equation}\)
其中：
\(\begin{equation}
\begin{aligned}
\mathcal{F^\text{-1}} [e^{-\frac{\sigma^2}{2} \lambda^2 \tau}] &amp;amp;= \frac{1}{2 \pi} \int^{\infty}_{-\infty} e^{-\frac{\sigma^2}{2} \lambda^2 \tau} e^{i \lambda x} d\lambda \\
&amp;amp;= \frac{1}{\pi} \int^{+\infty}_{0} e^{-\frac{\sigma^2}{2} \lambda^2 \tau} \cos(\lambda x) d\lambda \\
&amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \exp(-\frac{x^2}{2 \sigma^2 \tau})
\end{aligned} \tag{4.16}
\end{equation}\)
将初值$\varphi(\xi)= e ^{-\beta \xi} (e ^\xi - K)^+$带入$\text{(4.15)}$得到：
\(\begin{equation}
\begin{aligned}
u(\tau, x) &amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{-\infty} \exp(-\frac{(x-\xi)^2}{2 \sigma^2 \tau}) \left[e ^{-\beta \xi} (e ^\xi - K)^+ \right] d\xi \\
&amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{\ln K} \exp(-\frac{(x-\xi)^2}{2 \sigma^2 \tau}) \left[e ^{(1-\beta) \xi} - K e^{-\beta \xi} \right] d\xi
\end{aligned}
\tag{4.17}
\end{equation}\)&lt;/p&gt;

&lt;p&gt;然后将$\alpha = -r - \frac{1}{2 \sigma^2}(r - \frac{\sigma^2}{2})^2$和$\beta = \frac{1}{2} - \frac{r}{\sigma^2}$带入$V(\tau, x) = u(\tau, x) e^{\alpha \tau + \beta x}$得到：
\(\begin{equation}
\begin{aligned}
V(\tau, x) &amp;amp;= \exp(-r \tau - \frac{1}{2 \sigma^2}(r - \frac{\sigma^2}{2})^2 \tau - \frac{1}{\sigma^2}(r - \frac{\sigma^2}{2}) x) u(\tau, x) \\
&amp;amp;= I_1 + I_2
\end{aligned}
\tag{4.18}
\end{equation}\)
令:
\(\begin{equation}
\begin{aligned}
I_0 &amp;amp;= \exp \left( -r \tau - \frac{(r - \frac{\sigma^2}{2})^2 }{2 \sigma^2} \tau - \frac{(r - \frac{\sigma^2}{2})}{\sigma^2} x \right) \exp \left(-\frac{(x-\xi)^2}{2 \sigma^2 \tau} \right) \exp \bigg( {(1-\beta) \xi} \bigg) \\
&amp;amp;= \exp \left(-r \tau - \frac{(r - \frac{\sigma^2}{2})^2}{2 \sigma^2} \tau - \frac{(r - \frac{\sigma^2}{2})}{\sigma^2} x \right) \exp \left(-\frac{(x-\xi)^2}{2 \sigma^2 \tau} \right) \exp \bigg \{ \left[ 1+\frac{(r - \frac{\sigma^2}{2})}{\sigma^2} \right] \xi \bigg \} \\
&amp;amp;= e^{-r \tau} \exp \bigg \{ - \frac{(r - \frac{\sigma^2}{2})^2}{2 \sigma^2}\tau - \frac{(r - \frac{\sigma^2}{2})}{\sigma^2}x -\frac{(x-\xi)^2}{2 \sigma^2 \tau} + \left[ \xi +\frac{(r - \frac{\sigma^2}{2}) \xi}{\sigma^2} \right] \bigg \} \\
&amp;amp;= e^{-r \tau} \exp \left(-\frac{(x-\xi)^2}{2 \sigma^2 \tau} - \frac{(r - \frac{\sigma^2}{2})}{\sigma^2} (x - \xi) - \frac{(r - \frac{\sigma^2}{2})^2 \tau}{2 \sigma^2} + \xi \right) \\
&amp;amp;= e^{-r \tau} \exp \bigg \{-\frac{\left[(x-\xi)^2 + 2 (r - \frac{\sigma^2}{2}) \tau (x - \xi) + (r - \frac{\sigma^2}{2})^2 \tau^2 \right]}{2 \sigma^2 \tau} + \xi \bigg \} \\
&amp;amp;= e^{-r \tau} \exp \bigg \{ -\frac{\left[(x-\xi) + (r - \frac{\sigma^2}{2}) \tau \right]^2}{2 \sigma^2 \tau} + \xi \bigg \} \\
\end{aligned}
\tag{4.19}
\end{equation}\)&lt;/p&gt;

&lt;p&gt;其中：
\(\begin{equation}
\begin{aligned}
I_1 &amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{\ln K} I_0 d\xi \\
&amp;amp;= \frac{e^{-r \tau}}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{\ln K} \exp \bigg \{ (-\frac{\left[(x-\xi) + (r - \frac{\sigma^2}{2}) \tau \right]^2}{2 \sigma^2 \tau} + \xi \bigg \} d\xi \\
\end{aligned}
\tag{4.20}
\end{equation}\)
令$\eta = x-\xi + (r - \frac{\sigma^2}{2}) \tau$并带入$\text{(4.20)}$：
\(\begin{equation}
\begin{aligned}
I_1 &amp;amp;= \frac{e^{-r \tau}}{\sigma \sqrt{2 \pi \tau}} \int^{-\infty}_{x - \ln K + (r - \frac{\sigma^2}{2}) \tau} - \exp(-\frac{\eta^2}{2 \sigma^2 \tau} + (x - \eta + (r - \frac{\sigma^2}{2}) \tau)) d\eta \\
&amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{x - \ln K + (r - \frac{\sigma^2}{2}) \tau}_{-\infty} e^x \exp(-\frac{\eta^2}{2 \sigma^2 \tau} - \eta - \frac{\sigma^2}{2} \tau) d\eta \\
&amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{x - \ln K + (r - \frac{\sigma^2}{2}) \tau}_{-\infty} e^x \exp(-\frac{\eta^2 + 2 \sigma^2 \tau \eta + (\sigma^2 \tau)^2}{2 \sigma^2 \tau}) d\eta \\
&amp;amp;= \frac{e^x}{\sigma \sqrt{2 \pi \tau}} \int^{x - \ln K + (r - \frac{\sigma^2}{2}) \tau}_{-\infty} \exp(-\frac{(\eta + \sigma^2 \tau)^2}{2 \sigma^2 \tau}) d\eta
\end{aligned}
\tag{4.21}
\end{equation}\)
令
\(\omega = \frac{\eta + \sigma^2 \tau}{\sigma \sqrt{\tau}} \tag{4.22}\\
N(x) = \frac{1}{\sqrt{2\pi}} \int^{x}_{-\infty} \exp(-\frac{\omega^2}{2}) d\omega\)
带入$\text{(4.21)}$，求得：
\(\begin{equation}
\begin{aligned}
I_1 &amp;amp;= \frac{e^x}{\sigma \sqrt{2 \pi \tau}} \int^{\frac{x - \ln K + (r + \frac{\sigma^2}{2}) \tau}{\sigma \sqrt{\tau}}}_{-\infty} \sigma \sqrt{\tau} \exp(-\frac{\omega^2}{2}) d\omega \\
&amp;amp;= e^x N(\frac{x - \ln K + (r + \frac{\sigma^2}{2}) \tau}{\sigma \sqrt{\tau}})
\end{aligned}
\tag{4.23}
\end{equation}\)
同理令
\(I&apos;_0 = - \exp \left( -r \tau - \frac{(r - \frac{\sigma^2}{2})^2}{2 \sigma^2} \tau - \frac{(r - \frac{\sigma^2}{2})}{\sigma^2} x \right) \exp(-\frac{(x-\xi)^2}{2 \sigma^2 \tau}) K e^{-\beta \xi} \tag{4.24}\)&lt;/p&gt;

&lt;p&gt;\(\begin{equation}
\begin{aligned}
I_2 &amp;amp;= \frac{1}{\sigma \sqrt{2 \pi \tau}} \int^{+\infty}_{\ln K} {I&apos;_0} d\xi \\
&amp;amp;= -\frac{e^{-r\tau} K}{\sigma \sqrt{2 \pi \tau}} \int^{x - \ln K + (r - \frac{\sigma^2}{2}) \tau}_{-\infty} \exp(-\frac{\eta^2}{2 \sigma^2 \tau}) d\eta \\
&amp;amp;= -K e^{-r \tau} N(\frac{x - \ln K + (r - \frac{\sigma^2}{2}) \tau}{\sigma \sqrt{\tau}})
\end{aligned}
\tag{4.25}
\end{equation}\)
根据$x = \ln S, \tau = T-t$，最终得到$V(t, S_t)$：
\(\begin{equation}
\begin{aligned}
V(t, S_t) &amp;amp;= S_t N(\frac{\ln \frac{S_t}{K} + (r + \frac{\sigma^2}{2}) (T-t)}{\sigma \sqrt{T-t}}) \\
 &amp;amp; \quad - K e^{-r (T-t)} N(\frac{\ln \frac{S_t}{K} + (r - \frac{\sigma^2}{2}) (T-t)}{\sigma \sqrt{(T-t)}})
 \end{aligned}
\tag{4.26}
\end{equation}\)
或者简写为：
\(\begin{equation}
\begin{aligned}
V(t, S_t) &amp;amp;= S_t N(d_1) - K e^{-r (T-t)} N(d_2) \\
\\
&amp;amp; d_1 = \frac{\ln \frac{S_t}{K} + (r + \frac{\sigma^2}{2}) (T-t)}{\sigma \sqrt{T-t}} \\
&amp;amp; d_2 = d_1 - \sigma \sqrt{T-t} \\
&amp;amp; \ \ \ \  = \frac{\ln \frac{S_t}{K} + (r - \frac{\sigma^2}{2}) (T-t)}{\sigma \sqrt{(T-t)}}
\end{aligned}
\tag{4.27}
\end{equation}\)
由此，我们便求得了BSM偏微分方程的解析解，亦即欧式看涨期权定价公式。&lt;/p&gt;

&lt;h3 id=&quot;五注记&quot;&gt;五、注记&lt;/h3&gt;

&lt;p&gt;以上便整理完了对期权定价公式的偏微分方程直接求解方法，仅做形式化推导（有些地方确实考验对常规数学分析知识的掌握及细心程度例如公式$\text{4.19-4.20}$）的推导）。对偏微分方程求解过程中所涉及的傅里叶变换的适用性不做讨论，傅里叶变换目前除了印象中可以将非病态函数分解成三角函数的叠加以外所知甚少，再者公式$\text(4.16)$第一行到第二行的转化，第二行含参变量积分的计算（曾大言不惭想直接借助分部积分推导下，后来发现没那么容易），还有就是《Stochastic Calculus for Finance》关于对伊藤积分采用黎曼分割的合理性问题等等，总之想要彻底搞清楚其中的细节，还需不忘初心，继续精进。&lt;/p&gt;

</description>
        <pubDate>Fri, 29 Sep 2023 00:00:00 +0545</pubDate>
        <link>http://localhost:4000/2023/09/29/Black-Scholes-Merton%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC2/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/09/29/Black-Scholes-Merton%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC2/</guid>
        
        <category>金融数学</category>
        
        <category>期权定价</category>
        
        
      </item>
    
      <item>
        <title>Black-Scholes-Merton期权定价公式推导</title>
        <description>&lt;p&gt;十几年前上大学期间，因为机缘巧合结识了期权，对期权的定价无疑充满了金融学和数学的集体智慧，初学时囿于知识所限，只知定价公式，无法从头开始进行推导，后来学习了《Stochastic Calculus for Finance》，对其大致过程有了初步了解，书中对期权定价公式导出的基本思路是基于无风险套利原则在货币市场和股票市场进行复制对冲未来行权风险，涉及具体方法主要分两种方法（i）导出BSM偏微分方程，然后直接求解析解（p153-159），比较可惜的是，导出偏微分方程后，未给出方程求解过程而是一笔带过直接给出了解析解，让人意犹未尽，（ii）借助风险中性测度进行推导（p210-220），相比于求解偏微分方程所涉及的技巧，该种方法相对简单直观。&lt;/p&gt;

&lt;p&gt;本文主要针对方法（ii）进行总结介绍，其核心思想是借助&lt;em&gt;Girsanov Theorem&lt;/em&gt;进行测度变换，求得风险中性测度下投资组合折现过程为鞅，然后求条件期望得到定价公式。后面C++代码抄自&lt;a href=&quot;https://nms.kcl.ac.uk/john.armstrong/cppbook/cpp-website.html&quot;&gt;C++ for Financial Mathematics&lt;/a&gt;，&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;配置可参考网文。&lt;/p&gt;

&lt;h2 id=&quot;1-风险中性测度下的股价过程&quot;&gt;1. 风险中性测度下的股价过程&lt;/h2&gt;

&lt;h3 id=&quot;11-概率测度mathbbp下的股价过程&quot;&gt;1.1 概率测度$\mathbb{P}$下的股价过程&lt;/h3&gt;

&lt;p&gt;假设 $W_t, 0 \leq t \leq T $是概率空间$(\Omega, \mathcal{F}, \mathbb{P})$上的布朗运动，$\mathcal{F}_t, 0\leq t \leq T$是该布朗运动的域流，即$W_t$是$\mathcal{F}_t$可测函数，说人话就是在时刻$t$我们获得了信息集$\mathcal{F}_t$，该信息集可以决定$W_t$的值。&lt;/p&gt;

&lt;p&gt;考虑股票市场一只股票的股价$S_t$，假设其满足几何布朗运动：
\(d S_t = \alpha_t S_t d t+\sigma_t S_t d W_t, \quad 0 \leq t \leq T.  \tag{1.1}\)&lt;/p&gt;

&lt;p&gt;其中平均回报率$\alpha_t$和股价波动率$\sigma_t$为适应性过程即$\mathcal{F}_t$可测，同时$S_t$等价于：&lt;/p&gt;

\[{S_t} = S_0 \exp \left[ \int^{t}_{0} \sigma_s dW_s + \int^{t}_{0} (\alpha_s - \frac{\sigma_s^2}{2}) ds \right] \tag{1.2}\]

&lt;p&gt;公式$(1.1)$与公式$(1.2)$等价性推导：&lt;/p&gt;

&lt;p&gt;从公式$(1.1)$得到公式$(1.2)$，我们令
\(f(t, x) = \log x \tag{1.3}\\
\frac{\partial f(t, x)}{\partial t} = 0 \\
\frac{\partial f(t, x)}{\partial x} = \frac{1}{x} \\
\frac{\partial ^2 f(t, x)}{\partial x^2} = -\frac{1}{x^2}\)
根据伊藤公式：
\(\begin{aligned}
d f(t, S_t) &amp;amp;= \frac{\partial f(t, S_t)}{\partial t} dt + \frac{\partial f(t, S_t)}{\partial S_t} dS_t + \frac{1}{2} \frac{\partial ^2 f(t, x)}{\partial {S_t}^2} dS_t dS_t \\
&amp;amp;= 0 dt + \frac{1}{S_t} (\alpha_t S_t d t+\sigma_t S_t d W_t) - \frac{1}{2 S_t^2} \sigma_t^2 S_t^2 dt \\
&amp;amp;= \alpha_t dt + \sigma dW_t - \frac{\sigma_t^2}{2} dt \\
&amp;amp;= \sigma_t dW_t + (\alpha_t - \frac{\sigma_t^2}{2}) dt
\end{aligned} \tag{1.4}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;其中$dW_t dt = 0, dtdt=0,dW_t dW_t = dt$&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;对公式$\text{1.4}$两边求积分
\(\int^{t}_{0} d \log f(s, S_s) = \int^{t}_{0} \sigma_s dW_s + \int^{t}_{0} (\alpha_s - \frac{\sigma_s^2}{2}) dt \\
\log S_t - \log S_0 = \int^{t}_{0} \sigma_s dW_s + \int^{t}_{0} (\alpha_s - \frac{\sigma_s^2}{2}) dt \\
{S_t} = S_0 \exp \left[ \int^{t}_{0} \sigma_s dW_s + \int^{t}_{0} (\alpha_s - \frac{\sigma_s^2}{2}) ds \right] \tag{1.5}\)
以上我们推导了从公式$(1.1)$得到公式$(1.2)$，反过来公式$(1.2)$得到公式$(1.1)$，可以令$f(t,x) = e^x$，利用伊藤公式对其求微分得到。$\square$&lt;/p&gt;

&lt;p&gt;假设我们有适应性利率过程$R_t$，定义其折现过程
\(D_t = e^{-\int_{0}^{t} R_s d s} \tag{1.6}\)&lt;/p&gt;

&lt;p&gt;则其微分为&lt;/p&gt;

\[d D_t = -R_t D_t d t \tag{1.7}\]

&lt;p&gt;$D_t S_t$及其微分$d (D_t S_t)$分别为：&lt;/p&gt;

\[D_t S_t = S_0 \exp \left[ \int_{0}^{t} \sigma_s d W_s+\int_{0}^{t} ( \alpha_s - R_s - \frac{1}{2} \sigma^{2}_s ) d s\right] \tag{1.8}\]

\[\begin{aligned}
d(D_t S_t) &amp;amp;=(\alpha_t - R_t) D_t S_t d t+\sigma_t D_t S_t d W_t \\
&amp;amp;= \sigma_t D_t S_t(\Theta_t d t+d W_t)
\end{aligned} \tag{1.9}\]

&lt;p&gt;其中定义风险的市场价格$\Theta_t = \frac{\alpha_t - R_t}{\sigma_t} $。&lt;/p&gt;

&lt;h3 id=&quot;12-girsanov-theorem&quot;&gt;1.2 &lt;em&gt;Girsanov Theorem&lt;/em&gt;&lt;/h3&gt;

&lt;p&gt;假设 $W_t, 0 \leq t \leq T $是概率空间$(\Omega, \mathcal{F}, \mathbb{P})$上的布朗运动，$\mathcal{F}_t, 0\leq t \leq T$是该布朗运动的域流，$\Theta_t, 0 &amp;lt; t &amp;lt; T$为$\mathcal{F}_t$适应性过程。定义&lt;/p&gt;

\[Z_t =\exp \left( -\int_{0}^{t} \Theta_s d W_s - \frac{1}{2} \int_{0}^{t} \Theta^{2}_s d s\right) \tag{1.10}\]

\[\widetilde{W}_t =W_t + \int_{0}^{t} \Theta_s d s \tag{1.11}\]

&lt;p&gt;并假设&lt;/p&gt;

\[\mathbb{E} \int_{0}^{T} \Theta^{2}_s Z^{2}_s d s &amp;lt; \infty \tag{1.12}\]

&lt;p&gt;让$Z = Z_T$。那么$\mathbb{E}Z = 1$且在由&lt;/p&gt;

\[\widetilde{\mathbb{P}}(A) = \int_{A}Z(\omega) d \mathbb{P}(\omega) \quad A \in \mathcal{F}_t. \tag{1.13}\]

&lt;p&gt;定义的概率测度$\widetilde{\mathbb{P}}$下，$\widetilde{W}_t, 0 &amp;lt; t &amp;lt; T$是布朗运动。$\Box$&lt;/p&gt;

&lt;h3 id=&quot;13-概率测度widetildemathbbp下的股价过程&quot;&gt;1.3 概率测度$\widetilde{\mathbb{P}}$下的股价过程&lt;/h3&gt;

&lt;p&gt;根据&lt;em&gt;Girsanov Theorem&lt;/em&gt;，在概率测度$\widetilde{\mathbb{P}}$下，$d \widetilde W_t = \Theta_t d t + d W_t$，因此公式$\text(1.9)$也可以写为&lt;/p&gt;

\[d(D_t S_t) = \sigma_t D_t S_t d \widetilde W_t \tag{1.14}\]

&lt;p&gt;两边同时积分&lt;/p&gt;

\[D_t S_t = S_0 + \int_{0}^{t} \sigma_s D_s S_s d \widetilde{W}_s \tag{1.15}\]

&lt;p&gt;由于在概率测度$\widetilde{\mathbb{P}}$下，$\int_{0}^{t} \sigma_s D_s S_s d \widetilde{W}_s$是伊藤过程，因此是一个鞅。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;因此我们称&lt;em&gt;Girsanov Theorem&lt;/em&gt;下的概率测度$\widetilde{\mathbb{P}}$为风险中性测度(risk-neutral measure)&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;将$d \widetilde W_t = \Theta_t d t+d W_t$带入公式$(1.1)$，可以得到在概率测度$\widetilde{\mathbb{P}}$下，公式$(1.1)$和$(1.2)$分别可以改写成公式$(1.16)$和公式$(1.17)$的形式&lt;/p&gt;

\[d S_t = R_t S_t d t+\sigma_t S_t d \widetilde {W}_t \tag{1.16}\]

\[S_t = S_0 \exp \left[ \int_{0}^{t} \sigma_s d \widetilde{W}_s + \int_{0}^{t} ( R_s - \frac{1}{2} \sigma^{2}_s ) d s\right] \tag{1.17}\]

&lt;h2 id=&quot;2-风险中性测度下投资组合的价值过程&quot;&gt;2. 风险中性测度下投资组合的价值过程&lt;/h2&gt;

&lt;p&gt;假设投资者初始资本为$X_0$，在任意时间$t, 0 &amp;lt; t &amp;lt; T $持有$\Delta_t$份股票，同时以利率$R_t$投资或借贷于货币市场，以维持自融资状态，则投资组合价值的微分为&lt;/p&gt;

\[\begin{aligned}
d X_t &amp;amp;= \Delta_t d S_t + R_t ( X_t - \Delta_t S_t ) d t \\
\\
&amp;amp;= \Delta_t (\alpha_t S_t d t+\sigma_t S_t d W_t) + R_t (X_t - \Delta_t S_t ) d t \\
\\
&amp;amp;= R_t X_t d t+\Delta_t (\alpha_t - R_t) S_t d t + \Delta_t \sigma_t S_t d W_t \\
\\
&amp;amp;= R_t X_t d t + \Delta_t \sigma_t S_t (\Theta_t d t+d W_t)
\end{aligned} \tag{2.1}\]

&lt;p&gt;根据$\text{Ito}$乘法法则
\(d(X_t Y_t) = X_t dY_t + Y_t dX_t + dX_t dY_t \tag{2.2}\)&lt;/p&gt;

&lt;p&gt;由公式$(1.7),(1.9)$和$(2.1)$可得
\(\begin{aligned}
d(D_t X_t) &amp;amp;= \Delta_t \sigma_t D_t S_t (\Theta_t d t+d W_t) \\
\\
&amp;amp;=\Delta_t d(D_t S_t) \\
\\
&amp;amp;= \Delta_t \sigma_t D_t S_t d \widetilde W_t
\end{aligned} \tag{2.3}\)&lt;/p&gt;

&lt;p&gt;由此投资者有两种选择：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;以利率$R_t$投资于货币市场；&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;在风险中性测度$\widetilde{\mathbb{P}}$下投资于平均回报率为$R_t$的股票。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;但由于在风险中性测度$\widetilde{\mathbb{P}}$下，投资组合的折现价值$D_t X_t$是鞅，因此不管投资者如何选择，其投资组合的平均回报率均为为$R_t$。&lt;/p&gt;

&lt;h2 id=&quot;3-风险中性测度下的期权定价&quot;&gt;3. 风险中性测度下的期权定价&lt;/h2&gt;

&lt;p&gt;我们令$\mathcal{F}_T$可测的随机变量$V_T$表示在时刻$T$衍生证券空头的潜在支付(&lt;em&gt;payoff&lt;/em&gt;) $(S_T-K)^+$，投资者为了对冲看涨期权空头即未来所面临的潜在支出$V_T$，那么其持有的投资组合$X_t$需要使以下等式几乎必然成立(&lt;em&gt;almost surely&lt;/em&gt;)&lt;/p&gt;

\[X_T = V_T \tag{3.1}\]

&lt;p&gt;由$D_t X_t$在测度$\widetilde{\mathbb{P}}$是鞅的事实我们有&lt;/p&gt;

\[D_t X_t = \widetilde{\mathbb{E}}(D_T X_T \vert \mathcal{F}_t) = \widetilde{\mathbb{E}} (D_T V_T \vert  \mathcal{F}_t) \tag{3.2}\]

&lt;p&gt;$X_t$表示在时刻$t$为完全对冲衍生证券支付$V_T$所持有的投资组合价值，我们将其称之为衍生证券在时刻 $t$ 的价格并用$V_t$表示，那么公式$(3.2)$可以写成&lt;/p&gt;

\[D_t V_t = \widetilde{\mathbb{E}}(D_T V_T \vert \mathcal{F}_t), \quad 0 \leq t \leq T \tag{3.3}\]

&lt;p&gt;由于$D_t$是$\mathcal{F}_t$可测的，因此我们可以将其移到公式右侧，得到&lt;/p&gt;

\[V_t = \widetilde{\mathbb{E}} \left(e^{-\int_{t}^{T} R_s d s} V_T \vert \mathcal{F}_t \right), \quad 0 \leq t \leq T \tag{3.4}\]

&lt;p&gt;我们将公式$(3.3)$和$(3.4)$称为连续时间下风险中性定价公式(&lt;em&gt;risk-neutral pricing formula&lt;/em&gt;)。&lt;/p&gt;

&lt;h2 id=&quot;4-推导textblack-scholes-merton公式&quot;&gt;4. 推导$\text{Black-Scholes-Merton}$公式&lt;/h2&gt;

&lt;p&gt;为简单起见，我们假设$\sigma _t$和$R_t$分别为常数 $\sigma$ 和 $r$，则公式$(3.4)$简化为&lt;/p&gt;

\[\widetilde{\mathbb{E}}\left[e^{-r(T-t)} (S_T - K)^{+} \vert \mathcal{F}_t \right] \tag{4.1}\]

&lt;p&gt;公式$(4.1)$仅依赖于时刻$t$和股价$S_t$，由于几何布朗运动是马尔可夫过程，因此存在$c(t, S_t)$满足&lt;/p&gt;

\[c(t, S_t) = \widetilde{\mathbb{E}}\left[e^{-r(T-t)}(S_T-K)^{+} \mid \mathcal{F}_t\right] \tag{4.2}\]

&lt;p&gt;公式$(1.17)$简化为&lt;/p&gt;

\[S_t = S_0 \exp \left[ \sigma \widetilde{W}_t+\left(r-\frac{1}{2} \sigma^{2}\right) t\right] \tag{4.3}\]

&lt;p&gt;则$S_T$等于&lt;/p&gt;

\[\begin{aligned}
S_T &amp;amp;= S_t \exp \left[ \sigma(\widetilde{W}_T - \widetilde{W}_t) + \left(r-\frac{1}{2} \sigma^{2}\right) \tau \right] \\
\\
&amp;amp;= S_t \exp \left[ -\sigma \sqrt{\tau} Y+\left(r-\frac{1}{2} \sigma^{2}\right) \tau \right]
\end{aligned} \tag{4.4}\]

&lt;p&gt;其中$\tau = T - t$，$Y$是标准正态随机变量&lt;/p&gt;

\[Y = - \frac{\widetilde{W}_T - \widetilde{W}_t} {\sqrt{T-t}} \tag{4.5}\]

&lt;p&gt;公式$(4.2)$可以写成如下形式&lt;/p&gt;

\[\begin{aligned}
c(t, x) &amp;amp;= \widetilde{\mathbb{E}}\left [ e^{-r \tau}\left(x \exp \left [ -\sigma \sqrt{\tau} Y+\left(r-\frac{1}{2} \sigma^{2}\right) \tau \right] -K \right)^{+} \right ] \\
\\
&amp;amp;= \frac{e^{-r \tau}}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} \left\{ x \exp \left[ -\sigma \sqrt{\tau} y+\left(r-\frac{\sigma^{2}}{2} \right) \tau \right] - K \right\}^{+} e^{-\frac{1}{2} y^{2}} d y
\end{aligned} \tag{4.6}\]

&lt;p&gt;其中被积函数&lt;/p&gt;

\[\left\{ x \exp \left[ -\sigma \sqrt{\tau} y+\left(r-\frac{\sigma^{2}}{2} \right) \tau \right] - K \right\}^{+}\tag{4.7}\]

&lt;p&gt;为正，当且仅当&lt;/p&gt;

\[y &amp;lt; d_{-}(\tau, x)=\frac{1}{\sigma \sqrt{\tau}}\left[\log \frac{x}{K}+\left(r-\frac{\sigma^{2}}{2} \right) \tau\right] \tag{4.8}\]

&lt;p&gt;由此&lt;/p&gt;

\[\begin{aligned}
c(t, x) &amp;amp;= \frac{e^{-r \tau}}{\sqrt{2 \pi}} \int_{-\infty}^{d_{-}(\tau, x)} \left(x \exp \left\{-\sigma \sqrt{\tau} y+\left(r-\frac{\sigma^{2}}{2} \right) \tau\right\}-K\right) e^{-\frac{1}{2} y^{2}} d y \\
\\
&amp;amp;=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{d_{-}(\tau, x)} x \exp \left\{-\frac{y^{2}}{2}-\sigma \sqrt{\tau} y-\frac{\sigma^{2} \tau}{2}\right\} d y \\
\\
&amp;amp; \quad \ - \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{d_{-}(\tau, x)} e^{-r \tau} K e^{-\frac{1}{2} y^{2}} d y \\
\\
&amp;amp;=\frac{x}{\sqrt{2 \pi}} \int_{-\infty}^{d_{-}(\tau, x)} \exp \left\{-\frac{1}{2}(y+\sigma \sqrt{\tau})^{2}\right\} d y-e^{-r \tau} K N\left(d_{-}(\tau, x)\right) \\
\\
&amp;amp;=\frac{x}{\sqrt{2 \pi}} \int_{-\infty}^{d_{-}(\tau, x)+\sigma \sqrt{\tau}} \exp \left\{-\frac{z^{2}}{2}\right\} d z-e^{-r \tau} K N\left(d_{-}(\tau, x)\right) \\
\\
&amp;amp;=x N\left(d_{+}(\tau, x)\right)-e^{-r \tau} K N\left(d_{-}(\tau, x)\right)
\end{aligned} \tag{4.9}\]

&lt;p&gt;其中&lt;/p&gt;

\[N(x) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x} e^ {-\frac{t^2}{2}} d t \tag{4.10}\]

\[d_+(\tau, x) = \frac{1}{\sigma \sqrt{\tau}}\left[\log \frac{x}{K}+\left(r+\frac{1}{2} \sigma^{2}\right) \tau\right] \tag{4.11}\]

\[d_-(\tau, x) = d_+(\tau, x) - \sigma \sqrt{\tau} \tag{4.12}\]

&lt;p&gt;由此我们得到了欧式看涨期权定价公式&lt;/p&gt;

\[\text{BSM}(\tau, x, K, r, \sigma) = x N\left(d_{+}(\tau, x)\right) - K e^{-r \tau} N\left(d_{-}(\tau, x)\right) \tag{4.13}\]

&lt;h2 id=&quot;5-期权定价的c实现&quot;&gt;5. 期权定价的C++实现&lt;/h2&gt;

&lt;h3 id=&quot;51-实现nx函数---from-scratch-to-boost-library&quot;&gt;5.1 实现$N(x)$函数 - &lt;em&gt;From Scratch to Boost Library&lt;/em&gt;&lt;/h3&gt;

&lt;p&gt;定价公式$(4.13)$中涉及$N(x)$、$\exp(x)$和$\log(x)$等3个函数，其中$\exp(x)$和$\log(x)$已在标准库&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/code&gt;中实现，可以直接使用。因此只剩$N(x)$需要我们在标准库外自己实现或寻求其他库的支持。我们按照如下三种方式分别进行实现：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;多项式逼近法&lt;/li&gt;
  &lt;li&gt;数值积分法&lt;/li&gt;
  &lt;li&gt;调用&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Boost&lt;/code&gt;库&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;511-多项式逼近法&quot;&gt;5.1.1 多项式逼近法&lt;/h4&gt;

&lt;p&gt;如$x &amp;gt; 0$，定义$k = 1/(1 + 0.2316419x)$，则$N(x)$可用如下关于$k$多项式进行逼近
\(\small 1 − \frac{1}{\sqrt{2 \pi}} \exp(-\frac{x^2} {2}) k(0.319381530 + k(−0.356563782 + k(1.781477937 + k(−1.821255978 + 1.330274429k)))) \tag{5.1}\)&lt;/p&gt;

&lt;p&gt;借助$N(x) + N(-x) = 1$可以求得$N(-x)$即$x &amp;lt; 0$时$N(x)$的值。&lt;/p&gt;

&lt;p&gt;C++实现如下：&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.141592653589793&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root2Pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_ploy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2316419&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poly&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.319381530&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.356563782&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.781477937&lt;/span&gt; 
                  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.821255978&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.330274429&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root2Pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;512-数值积分法&quot;&gt;5.1.2 数值积分法&lt;/h4&gt;

&lt;p&gt;对于实数域上$\mathbb R \to \mathbb R$的黎曼积分&lt;/p&gt;

\[F(b) - F(a) = \int_{a}^{b} f(x) d x \tag{5.2}\]

&lt;p&gt;令$\Delta x = \frac{(b-a)}{N}$，根据黎曼积分定义，我们可以用以下矩形的面积和逼近$\int_{a}^{b} f(x) d x$：&lt;/p&gt;

\[\lim_{N \to \infty} \sum_{i=0}^{N-1} f\left(a+(i+\frac{1}{2}) \Delta x\right) \Delta x \tag{5.3}\]

&lt;p&gt;只要$N$取值足够大即可很好的逼近积分值，可以通过定义$f(x) = x ^ 2 + 1$进行简单验证，C++实现如下：&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrate_fx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;integrate_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate_fx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//返回10+2/3(约等于10.666667)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;下面我们考虑如何用数值积分法逼近&lt;/p&gt;

\[N(x)=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x} \exp \left(-\frac{t^{2}}{2}\right) d t\]

&lt;p&gt;由于积分下限为$- \infty$，我们需要考虑进行变量替换，定义$t = x + 1 - \frac{1} {s}$，则$N(x)$等价于如下积分：&lt;/p&gt;

\[\frac{1} {\sqrt {2 \pi}} \int_{0}^{1} \frac{1}{s^{2}} \exp \left(-\frac{\left(x+1-\frac{1}{s}\right)^{2}}{2}\right) \mathrm{d} s \tag{5.4}\]

&lt;p&gt;C++实现如下：&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normcdf_integrate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;513-调用boost库&quot;&gt;5.1.3 调用&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;库&lt;/h4&gt;

&lt;p&gt;我们可以通过如下方式调用&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;库中的累积分布函数（&lt;strong&gt;C&lt;/strong&gt;umulative &lt;strong&gt;D&lt;/strong&gt;istribution &lt;strong&gt;F&lt;/strong&gt;unction，简称$\mathrm{cdf}$)的实现&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&quot;boost\math\distributions\normal.hpp&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;random&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normcdf_boost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	
	&lt;span class=&quot;n&quot;&gt;boost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal_distribution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//生成标准正态分布&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//计算N(x)值&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;52-期权费计算的c实现&quot;&gt;5.2 期权费计算的C++实现&lt;/h3&gt;

&lt;p&gt;实现$N(x)$后，计算公式$(1)$中欧式看涨期权$c(S_0, K, T, r, \sigma)$的障碍就清除了。下面我们分别定义&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blackScholesCallPrice&lt;/code&gt;和&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blackScholesPutPrice&lt;/code&gt;函数完成计算$c(S_0, K, T, r, \sigma)$和$p(S_0, K, T, r, \sigma)$。&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//以下normcdf(x)函数3选1，默认选normcdf_poly(x)，使用normcdf_boost(x)时请自行配置boost库&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;//double callPrice = normcdf_integrate(d1) * S_t - normcdf_integrate(d2) * K * exp(-r * T);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double callPrice = normcdf_boost(d1) * S_t - normcdf_boost(d2) * K * exp(-r * T);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//以下normcdf(x)函数3选1，默认选normcdf_poly(x)，使用normcdf_boost(x)时请自行配置boost库&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double putPrice = normcdf_integrate(-d2) * K * exp(-r * T) - normcdf_integrate(-d1) * S_t;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double putPrice = normcdf_boost(-d2) * K * exp(-r * T) - normcdf_boost(-d1) * S_t;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;53-完整工程文件及测试&quot;&gt;5.3 完整工程文件及测试&lt;/h3&gt;

&lt;p&gt;头文件&lt;em&gt;stdafx.h&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;#pragma once
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//请在Visual Studio中自行配置好boost库后取消注释&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//#include &quot;boost\math\distributions\normal.hpp&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//#include &amp;lt;random&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;头文件&lt;em&gt;OptionPricing.h&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;#pragma once
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.14159265358979&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//定义Pi值&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//S_t: spotPrice&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//T: maturity&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//K: strikePrice&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//vol: volatility&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//r: riskFreeInterestRate&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//声明看涨期权定价公式&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//声明看跌期权定价公式&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;源文件&lt;em&gt;OptionPricing.cpp&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;
&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&quot;OptionPricing.h&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&quot;stdafx.h&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root2Pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2316419&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poly&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.319381530&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.356563782&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.781477937&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.821255978&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.330274429&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root2Pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normcdf_integrate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//请在Visual Studio中自行配置好boost库后取消注释&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*
static inline double normcdf_boost(double x)
{
    double cdf = 0.0;

    boost::math::normal_distribution&amp;lt;&amp;gt; norm(0, 1); //生成标准正态分布
    cdf = boost::math::cdf(norm, x); //计算N(x)值
    return cdf;
}
*/&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//S_t: spotPrice&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//T: maturity&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//K: strikePrice&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//vol: volatility&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//r: riskFreeInterestRate&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//以下normcdf(x)函数3选1，默认选normcdf_poly(x)，使用normcdf_boost(x)时请自行配置boost库&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;//double callPrice = normcdf_integrate(d1) * S_t - normcdf_integrate(d2) * K * exp(-r * T);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double callPrice = normcdf_boost(d1) * S_t - normcdf_boost(d2) * K * exp(-r * T);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//以下normcdf(x)函数3选1，默认选normcdf_poly(x)，使用normcdf_boost(x)时请自行配置boost库&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normcdf_poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double putPrice = normcdf_integrate(-d2) * K * exp(-r * T) - normcdf_integrate(-d1) * S_t;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//double putPrice = normcdf_boost(-d2) * K * exp(-r * T) - normcdf_boost(-d1) * S_t;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;测试文件&lt;em&gt;main.cpp&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&quot;OptionPricing.h&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putCallParity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;The call option price is: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//11.6725&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;put&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;The put option price is: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//0.183688&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;Put-Call-Parity = Call Price - Put Price&amp;gt; Testing&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;Call Price - Put Price&amp;gt; is: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;putCallParity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;Put-Call-Parity&amp;gt; is: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putCallParity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Wonderful! It&apos;s correct.&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;其中看涨-看跌期权平价公式为&lt;/p&gt;

\[S_0 - \exp(-rT)K = c(S_0, K, T, r, \sigma) - p(S_0, K, T, r, \sigma) \tag{5.5}\]

&lt;h2 id=&quot;6-期权定价的python实现&quot;&gt;6. 期权定价的Python实现&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;定义以下简写变量&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strikePrice&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maturity&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spotPrice&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;volatility&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;riskFreeRate&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;定义d1和d2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; \
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;定义看涨&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;看跌期权计算公式&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callPrice&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;d2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putPrice&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;定义看涨&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;看跌期权平价测试公式&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;callPutParity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;对给定变量进行测试&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.03&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesCallPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;put&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blackScholesPutPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;callPutParity_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;callPutParity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;The call option price is: {0}&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;The put option price is: {0}&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Call price - put price is: {0}&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;The Call-Put-Parity is: {0}&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callPutParity_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;完结&lt;/p&gt;

</description>
        <pubDate>Fri, 11 Jun 2021 00:00:00 +0545</pubDate>
        <link>http://localhost:4000/2021/06/11/Black-Scholes-Merton%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC1/</link>
        <guid isPermaLink="true">http://localhost:4000/2021/06/11/Black-Scholes-Merton%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC1/</guid>
        
        <category>金融数学</category>
        
        <category>期权定价</category>
        
        <category>C++</category>
        
        <category>Python</category>
        
        
      </item>
    
  </channel>
</rss>
